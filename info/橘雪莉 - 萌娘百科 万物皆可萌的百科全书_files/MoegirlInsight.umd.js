(function(Se,ct){typeof exports=="object"&&typeof module<"u"?ct(exports):typeof define=="function"&&define.amd?define(["exports"],ct):(Se=typeof globalThis<"u"?globalThis:Se||self,ct(Se.MoegirlInsight={}))})(this,function(Se){"use strict";var ct=Object.defineProperty,P=(n,e)=>ct(n,"name",{value:e,configurable:!0});function gi(){}P(gi,"noop");function Ne(n){return n==null}P(Ne,"isNullable");function yi(n){return n&&typeof n=="object"&&!Array.isArray(n)}P(yi,"isPlainObject");function bi(n,e){return Object.fromEntries(Object.entries(n).filter(([t,r])=>e(t,r)))}P(bi,"filterKeys");function Qn(n,e){return Object.fromEntries(Object.entries(n).map(([t,r])=>[t,e(r,t)]))}P(Qn,"mapValues");function wi(n,e,t){if(!e)return{...n};const r={};for(const i of e)(t||n[i]!==void 0)&&(r[i]=n[i]);return r}P(wi,"pick");function ki(n,e){if(!e)return{...n};const t={...n};for(const r of e)Reflect.deleteProperty(t,r);return t}P(ki,"omit");function Z(n,e,t){return Object.defineProperty(n,e,{writable:!0,value:t,enumerable:!1})}P(Z,"defineProperty");function Ni(n,e){return e.every(t=>n.includes(t))}P(Ni,"contain");function Ei(n,e){return n.filter(t=>e.includes(t))}P(Ei,"intersection");function _i(n,e){return n.filter(t=>!e.includes(t))}P(_i,"difference");function vi(n,e){return Array.from(new Set([...n,...e]))}P(vi,"union");function Si(n){return[...new Set(n)]}P(Si,"deduplicate");function ye(n,e){const t=n.indexOf(e);return t>=0?(n.splice(t,1),!0):!1}P(ye,"remove");function Ii(n){return Array.isArray(n)?n:Ne(n)?[]:[n]}P(Ii,"makeArray");function Ie(n,e){return arguments.length===1?t=>Ie(n,t):n in globalThis&&e instanceof globalThis[n]||Object.prototype.toString.call(e).slice(8,-1)===n}P(Ie,"is");function ut(n){return Ie("ArrayBuffer",n)||Ie("SharedArrayBuffer",n)}P(ut,"isArrayBufferLike");function er(n){return ut(n)||ArrayBuffer.isView(n)}P(er,"isArrayBufferSource");var Ke;(n=>{n.is=ut,n.isSource=er;function e(o){return ArrayBuffer.isView(o)?o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength):o}n.fromSource=e,P(e,"fromSource");function t(o){if(typeof Buffer<"u")return Buffer.from(o).toString("base64");let a="";const l=new Uint8Array(o);for(let c=0;c<l.byteLength;c++)a+=String.fromCharCode(l[c]);return btoa(a)}n.toBase64=t,P(t,"toBase64");function r(o){return typeof Buffer<"u"?e(Buffer.from(o,"base64")):Uint8Array.from(atob(o),a=>a.charCodeAt(0))}n.fromBase64=r,P(r,"fromBase64");function i(o){return typeof Buffer<"u"?Buffer.from(o).toString("hex"):Array.from(new Uint8Array(o),a=>a.toString(16).padStart(2,"0")).join("")}n.toHex=i,P(i,"toHex");function s(o){if(typeof Buffer<"u")return e(Buffer.from(o,"hex"));const a=o.length%2===0?o:o.slice(0,o.length-1),l=[];for(let c=0;c<a.length;c+=2)l.push(parseInt(`${a[c]}${a[c+1]}`,16));return Uint8Array.from(l).buffer}n.fromHex=s,P(s,"fromHex")})(Ke||(Ke={})),Ke.fromBase64,Ke.toBase64,Ke.fromHex,Ke.toHex;function on(n){return!n||typeof n!="object"?n:Array.isArray(n)?n.map(on):Ie("Date",n)?new Date(n.valueOf()):Ie("RegExp",n)?new RegExp(n.source,n.flags):ut(n)?n.slice(0):ArrayBuffer.isView(n)?n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength):Qn(n,on)}P(on,"clone");function St(n,e,t){if(n===e||!t&&Ne(n)&&Ne(e))return!0;if(typeof n!=typeof e||typeof n!="object"||!n||!e)return!1;function r(i,s){return i(n)?i(e)?s(n,e):!1:i(e)?!1:void 0}return P(r,"check"),r(Array.isArray,(i,s)=>i.length===s.length&&i.every((o,a)=>St(o,s[a])))??r(Ie("Date"),(i,s)=>i.valueOf()===s.valueOf())??r(Ie("RegExp"),(i,s)=>i.source===s.source&&i.flags===s.flags)??r(ut,(i,s)=>{if(i.byteLength!==s.byteLength)return!1;const o=new Uint8Array(i),a=new Uint8Array(s);for(let l=0;l<o.length;l++)if(o[l]!==a[l])return!1;return!0})??Object.keys({...n,...e}).every(i=>St(n[i],e[i],t))}P(St,"deepEqual");function Ti(n){return n.charAt(0).toUpperCase()+n.slice(1)}P(Ti,"capitalize");function an(n){return n.charAt(0).toLowerCase()+n.slice(1)}P(an,"uncapitalize");function Oi(n){return n.replace(/[_-][a-z]/g,e=>e.slice(1).toUpperCase())}P(Oi,"camelCase");function Ai(n){return an(n).replace(/_/g,"-").replace(/.[A-Z]+/g,e=>e[0]+"-"+e.slice(1).toLowerCase())}P(Ai,"paramCase");function Ri(n){return an(n).replace(/-/g,"_").replace(/.[A-Z]+/g,e=>e[0]+"_"+e.slice(1).toLowerCase())}P(Ri,"snakeCase");function tr(n){return n.replace(/\/$/,"")}P(tr,"trimSlash");function xi(n){return n.startsWith("/")||(n="/"+n),tr(n)}P(xi,"sanitize");var It;(n=>{n.millisecond=1,n.second=1e3,n.minute=n.second*60,n.hour=n.minute*60,n.day=n.hour*24,n.week=n.day*7;let e=new Date().getTimezoneOffset();function t(g){e=g}n.setTimezoneOffset=t,P(t,"setTimezoneOffset");function r(){return e}n.getTimezoneOffset=r,P(r,"getTimezoneOffset");function i(g=new Date,f){return typeof g=="number"&&(g=new Date(g)),f===void 0&&(f=e),Math.floor((g.valueOf()/n.minute-f)/1440)}n.getDateNumber=i,P(i,"getDateNumber");function s(g,f){const N=new Date(g*n.day);return f===void 0&&(f=e),new Date(+N+f*n.minute)}n.fromDateNumber=s,P(s,"fromDateNumber");const o=/\d+(?:\.\d+)?/.source,a=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(g=>`(${o}${g})?`).join("")}$`);function l(g){const f=a.exec(g);return f?(parseFloat(f[1])*n.week||0)+(parseFloat(f[2])*n.day||0)+(parseFloat(f[3])*n.hour||0)+(parseFloat(f[4])*n.minute||0)+(parseFloat(f[5])*n.second||0):0}n.parseTime=l,P(l,"parseTime");function c(g){const f=l(g);return f?g=Date.now()+f:/^\d{1,2}(:\d{1,2}){1,2}$/.test(g)?g=`${new Date().toLocaleDateString()}-${g}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(g)&&(g=`${new Date().getFullYear()}-${g}`),g?new Date(g):new Date}n.parseDate=c,P(c,"parseDate");function h(g){const f=Math.abs(g);return f>=n.day-n.hour/2?Math.round(g/n.day)+"d":f>=n.hour-n.minute/2?Math.round(g/n.hour)+"h":f>=n.minute-n.second/2?Math.round(g/n.minute)+"m":f>=n.second?Math.round(g/n.second)+"s":g+"ms"}n.format=h,P(h,"format");function w(g,f=2){return g.toString().padStart(f,"0")}n.toDigits=w,P(w,"toDigits");function p(g,f=new Date){return g.replace("yyyy",f.getFullYear().toString()).replace("yy",f.getFullYear().toString().slice(2)).replace("MM",w(f.getMonth()+1)).replace("dd",w(f.getDate())).replace("hh",w(f.getHours())).replace("mm",w(f.getMinutes())).replace("ss",w(f.getSeconds())).replace("SSS",w(f.getMilliseconds(),3))}n.template=p,P(p,"template")})(It||(It={}));var Ui=Object.defineProperty,D=(n,e)=>Ui(n,"name",{value:e,configurable:!0}),A={shadow:Symbol.for("cordis.shadow"),receiver:Symbol.for("cordis.receiver"),original:Symbol.for("cordis.original"),store:Symbol.for("cordis.store"),events:Symbol.for("cordis.events"),static:Symbol.for("cordis.static"),filter:Symbol.for("cordis.filter"),expose:Symbol.for("cordis.expose"),isolate:Symbol.for("cordis.isolate"),internal:Symbol.for("cordis.internal"),intercept:Symbol.for("cordis.intercept"),setup:Symbol.for("cordis.setup"),invoke:Symbol.for("cordis.invoke"),extend:Symbol.for("cordis.extend"),tracker:Symbol.for("cordis.tracker"),provide:Symbol.for("cordis.provide"),immediate:Symbol.for("cordis.immediate")},Bi=function*(){}.constructor,nr=async function*(){}.constructor;function ln(n){return!(!n.prototype||n instanceof Bi||nr!==Function&&n instanceof nr)}D(ln,"isConstructor");function ft(n,e){const t=n.Config||n.schema;return t&&n.schema!==!1&&(e=t(e)),e??{}}D(ft,"resolveConfig");function rr(n){return[Map,Set,Date,Promise].some(e=>n instanceof e)}D(rr,"isUnproxyable");function cn(n,e){if(n===Object.prototype)return e;const t=Object.create(cn(Object.getPrototypeOf(n),e));for(const r of Reflect.ownKeys(n))Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r));return t}D(cn,"joinPrototype");function un(n){return n&&(typeof n=="object"||typeof n=="function")}D(un,"isObject");function be(n,e,t){if(!un(e))return e;if(Object.hasOwn(e,A.shadow))return Object.getPrototypeOf(e);const r=e[A.tracker];return r?Ot(n,e,r,t):e}D(be,"getTraceable");function ht(n,e){return e?new Proxy(n,{get:D((t,r,i)=>r in e&&r!=="constructor"?Reflect.get(e,r,i):Reflect.get(t,r,i),"get"),set:D((t,r,i,s)=>r in e&&r!=="constructor"?Reflect.set(e,r,i,s):Reflect.set(t,r,i,s),"set")}):n}D(ht,"withProps");function Tt(n,e,t){return ht(n,Object.defineProperty(Object.create(null),e,{value:t,writable:!1}))}D(Tt,"withProp");function fn(n,e,t,r){if(!t)return r;const i=Reflect.getOwnPropertyDescriptor(e,t)?.value;return i?Tt(r,t,n.extend({[A.shadow]:i})):r}D(fn,"createShadow");function ir(n,e,t,r){return new Proxy(e,{apply:D((i,s,o)=>(s===t&&(s=r),o=o.map(a=>typeof a!="function"||a[A.original]?a:new Proxy(a,{get:D((l,c,h)=>{if(c===A.original)return l;const w=Reflect.get(l,c,h);return c==="toString"&&w===Function.prototype.toString?function(...p){return Reflect.apply(w,this===h?l:this,p)}:w},"get"),apply:D((l,c,h)=>Reflect.apply(l,be(n,c),h.map(w=>be(n,w))),"apply"),construct:D((l,c,h)=>Reflect.construct(l,c.map(w=>be(n,w)),h),"construct")})),be(n,Reflect.apply(i,s,o))),"apply")})}D(ir,"createShadowMethod");function Ot(n,e,t,r){n[A.shadow]&&(n=Object.getPrototypeOf(n));const i=new Proxy(e,{get:D((s,o,a)=>{if(o===A.original)return s;if(o===t.property)return n;if(typeof o=="symbol")return Reflect.get(s,o,a);if(t.associate&&n[A.internal][`${t.associate}.${o}`])return Reflect.get(n,`${t.associate}.${o}`,Tt(n,A.receiver,a));const l=fn(n,s,t.property,a),c=Reflect.get(s,o,l),h=c?.[A.tracker];return h?Ot(n,c,h):!r&&typeof c=="function"?ir(n,c,a,l):c},"get"),set:D((s,o,a,l)=>{if(o===A.original||o===t.property)return!1;if(typeof o=="symbol")return Reflect.set(s,o,a,l);if(t.associate&&n[A.internal][`${t.associate}.${o}`])return Reflect.set(n,`${t.associate}.${o}`,a,Tt(n,A.receiver,l));const c=fn(n,s,t.property,l);return Reflect.set(s,o,a,c)},"set"),apply:D((s,o,a)=>hn(i,s,o,a),"apply")});return i}D(Ot,"createTraceable");function hn(n,e,t,r){return e[A.invoke]?e[A.invoke].apply(n,r):Reflect.apply(e,t,r)}D(hn,"applyTraceable");function dn(n,e,t){const r=D(function(...i){const s=Ot(r.ctx,r,t);return hn(s,r,this,i)},"self");return Z(r,"name",n),Object.setPrototypeOf(r,e)}D(dn,"createCallable");var Mi=class lt{constructor(e){this.ctx=e,Z(this,A.tracker,{associate:"reflect",property:"ctx"}),this._mixin("reflect",["get","set","provide","accessor","mixin","alias"]),this._mixin("scope",["config","runtime","effect","collect","accept","decline"]),this._mixin("registry",["using","inject","plugin"]),this._mixin("lifecycle",["on","once","parallel","emit","serial","bail","start","stop"])}static{D(this,"ReflectService")}static resolveInject(e,t){let r=e[A.internal][t];for(;r?.type==="alias";)t=r.name,r=e[A.internal][t];return[t,r]}static checkInject(e,t,r){if(e=e[A.shadow]??e,["prototype","then","registry","lifecycle"].includes(t)||t[0]==="$"||t[0]==="_"||!e.runtime.plugin||e.bail(e,"internal/inject",t))return;const i=r.stack.split(`
`);i.splice(1,1),r.stack=i.join(`
`),e.emit(e,"internal/warning",r)}static handler={get:D((e,t,r)=>{if(typeof t!="string")return Reflect.get(e,t,r);if(Reflect.has(e,t))return be(r,Reflect.get(e,t,r),!0);const[i,s]=lt.resolveInject(e,t),o=new Error(`property ${i} is not registered, declare it as \`inject\` to suppress this warning`);return s?s.type==="accessor"?s.get.call(r,r[A.receiver]):(s.builtin||lt.checkInject(r,i,o),r.reflect.get(i)):(lt.checkInject(r,i,o),Reflect.get(e,i,r))},"get"),set:D((e,t,r,i)=>{if(typeof t!="string")return Reflect.set(e,t,r,i);const[s,o]=lt.resolveInject(e,t);return o?o.type==="accessor"?o.set?o.set.call(i,r,i[A.receiver]):!1:(i.reflect.set(s,r),!0):Reflect.set(e,s,r,i)},"set"),has:D((e,t)=>{if(typeof t!="string")return Reflect.has(e,t);if(Reflect.has(e,t))return!0;const[,r]=lt.resolveInject(e,t);return!!r},"has")};get(e){if(this.ctx[A.internal][e]?.type!=="service")return;const r=this.ctx[A.isolate][e],i=this.ctx[A.store][r]?.value;return be(this.ctx,i)}set(e,t){this.provide(e);const r=this.ctx[A.isolate][e],i=this.ctx[A.store][r]?.value;t??=void 0;let s=D(()=>{},"dispose");if(i===t)return s;if(!Ne(t)&&!Ne(i))throw new Error(`service ${e} has been registered`);const o=this.ctx;Ne(t)||(s=o.effect(()=>()=>{o.set(e,void 0)})),rr(t)&&o.emit(o,"internal/warning",new Error(`service ${e} is an unproxyable object, which may lead to unexpected behavior`));const a=Object.create(o);return a[A.filter]=l=>o[A.isolate][e]===l[A.isolate][e],o.emit(a,"internal/before-service",e,t),o[A.store][r]={value:t,source:o},o.emit(a,"internal/service",e,i),s}provide(e,t,r){const i=this.ctx.root[A.internal];if(e in i)return;const s=Symbol(e);i[e]={type:"service",builtin:r},this.ctx.root[A.isolate][e]=s,un(t)&&(this.ctx[A.store][s]={value:t,source:null},Z(t,A.tracker,{associate:e,property:"ctx"}))}_accessor(e,t){const r=this.ctx.root[A.internal];return e in r?()=>{}:(r[e]={type:"accessor",...t},()=>delete this.ctx.root[A.isolate][e])}accessor(e,t){this.ctx.scope.effect(()=>this._accessor(e,t))}alias(e,t){const r=this.ctx.root[A.internal];if(!(e in r))for(const i of t)r[i]||={type:"alias",name:e}}_mixin(e,t){const r=Array.isArray(t)?t.map(o=>[o,o]):Object.entries(t),i=typeof e=="string"?o=>o[e]:()=>e,s=r.map(([o,a])=>this._accessor(a,{get(l){const c=i(this);if(Ne(c))return c;const h=l?ht(l,c):c,w=Reflect.get(c,o,h);return typeof w!="function"?w:w.bind(h??c)},set(l,c){const h=i(this),w=c?ht(c,h):h;return Reflect.set(h,o,l,w)}}));return()=>s.forEach(o=>o())}mixin(e,t){this.ctx.scope.effect(()=>this._mixin(e,t))}trace(e){return be(this.ctx,e)}bind(e){return new Proxy(e,{apply:D((t,r,i)=>t.apply(this.trace(r),i.map(s=>this.trace(s))),"apply")})}},pn=Mi;function mn(n){return n!==null&&n!==!1&&n!==void 0}D(mn,"isBailed");var Di=class{constructor(n){this.ctx=n,Z(this,A.tracker,{associate:"lifecycle",property:"ctx"}),Z(this.on("internal/listener",function(t,r,i){const s=i.prepend?"unshift":"push";if(t==="ready")return this.lifecycle.isActive?(this.scope.ensure(async()=>r()),()=>!1):void 0;if(t==="dispose")return this.scope.disposables[s](r),Z(r,"name","event <dispose>"),()=>ye(this.scope.disposables,r);if(t==="fork")return this.scope.runtime.forkables[s](r),this.scope.collect("event <fork>",()=>ye(this.scope.runtime.forkables,r))}),Q.static,n.scope);for(const t of["info","error","warning"])Z(this.on(`internal/${t}`,(r,...i)=>{this._hooks[`internal/${t}`].length>1}),Q.static,n.scope);Z(this.on("internal/before-service",function(t){for(const r of this.registry.values()){if(!r.inject[t]?.required)continue;const i=r.isReusable?r.children:[r];for(const s of i)this[A.filter](s.ctx)&&(s.updateStatus(),s.reset())}},{global:!0}),Q.static,n.scope),Z(this.on("internal/service",function(t){for(const r of this.registry.values()){if(!r.inject[t]?.required)continue;const i=r.isReusable?r.children:[r];for(const s of i)this[A.filter](s.ctx)&&s.start()}},{global:!0}),Q.static,n.scope);const e=D((t,r)=>{if(!t.runtime.plugin)return!1;for(const i in t.runtime.inject)if(r===pn.resolveInject(t.ctx,i)[0])return!0;return e(t.parent.scope,r)},"checkInject");Z(this.on("internal/inject",function(t){return e(this.scope,t)},{global:!0}),Q.static,n.scope)}static{D(this,"Lifecycle")}isActive=!1;_tasks=new Set;_hooks={};async flush(){for(;this._tasks.size;)await Promise.all(Array.from(this._tasks))}filterHooks(n,e){return e=be(this.ctx,e),n.slice().filter(t=>{const r=e?.[Q.filter];return t.global||!r||r.call(e,t.ctx)})}*dispatch(n,e){const t=typeof e[0]=="object"||typeof e[0]=="function"?e.shift():null,r=e.shift();r!=="internal/event"&&this.emit("internal/event",n,r,e,t);for(const i of this.filterHooks(this._hooks[r]||[],t))yield i.callback.apply(t,e)}async parallel(...n){await Promise.all(this.dispatch("emit",n))}emit(...n){Array.from(this.dispatch("emit",n))}async serial(...n){for await(const e of this.dispatch("serial",n))if(mn(e))return e}bail(...n){for(const e of this.dispatch("bail",n))if(mn(e))return e}register(n,e,t,r){const i=r.prepend?"unshift":"push";return e[i]({ctx:this.ctx,callback:t,...r}),this.ctx.state.collect(n,()=>this.unregister(e,t))}unregister(n,e){const t=n.findIndex(r=>r.callback===e);if(t>=0)return n.splice(t,1),!0}on(n,e,t){typeof t!="object"&&(t={prepend:t}),this.ctx.scope.assertActive(),e=this.ctx.reflect.bind(e);const r=this.bail(this.ctx,"internal/listener",n,e,t);if(r)return r;const i=this._hooks[n]||=[],s=typeof n=="string"?`event <${n}>`:"event (Symbol)";return this.register(s,i,e,t)}once(n,e,t){const r=this.on(n,function(...i){return r(),e.apply(this,i)},t);return r}async start(){this.isActive=!0;const n=this._hooks.ready||[];for(;n.length;){const{ctx:e,callback:t}=n.shift();e.scope.ensure(async()=>t())}await this.flush()}async stop(){this.isActive=!1,this.ctx.scope.reset()}},$i=Di,gn=class di extends Error{constructor(e,t){super(t??di.Code[e]),this.code=e}static{D(this,"CordisError")}};(n=>{n.Code={INACTIVE_EFFECT:"cannot create effect on inactive context"}})(gn||(gn={}));var sr=class{constructor(n,e){this.parent=n,this.config=e,this.uid=n.registry?n.registry.counter:0,this.ctx=this.context=n.extend({scope:this}),this.proxy=new Proxy({},{get:D((t,r)=>Reflect.get(this.config,r),"get")})}static{D(this,"EffectScope")}uid;ctx;disposables=[];error;status=0;isActive=!1;context;proxy;acceptors=[];tasks=new Set;hasError=!1;get _config(){return this.runtime.isReactive?this.proxy:this.config}assertActive(){if(!(this.uid!==null||this.isActive))throw new gn("INACTIVE_EFFECT")}effect(n,e){this.assertActive();const t=ln(n)?new n(this.ctx,e):n(this.ctx,e);let r=!1;const i=typeof t=="function"?t:t.dispose.bind(t),s=D((...o)=>{if(!r)return r=!0,ye(this.disposables,s),i(...o)},"wrapped");return this.disposables.push(s),typeof t=="function"?s:(t.dispose=s,t)}collect(n,e){const t=Z(()=>(ye(this.disposables,t),e()),"name",n);return this.disposables.push(t),t}restart(){this.reset(),this.error=null,this.hasError=!1,this.status=0,this.start()}_getStatus(){return this.uid===null?4:this.hasError?3:this.tasks.size?1:this.ready?2:0}updateStatus(n){const e=this.status;n?.(),this.status=this._getStatus(),e!==this.status&&this.context.emit("internal/status",this,e)}ensure(n){const e=n().catch(t=>{this.context.emit(this.ctx,"internal/error",t),this.cancel(t)}).finally(()=>{this.updateStatus(()=>this.tasks.delete(e)),this.context.events._tasks.delete(e)});this.updateStatus(()=>this.tasks.add(e)),this.context.events._tasks.add(e)}cancel(n){this.error=n,this.updateStatus(()=>this.hasError=!0),this.reset()}get ready(){return Object.entries(this.runtime.inject).every(([n,e])=>!e.required||!Ne(this.ctx.get(n)))}reset(){this.isActive=!1,this.disposables=this.disposables.splice(0).filter(n=>{if(this.uid!==null&&n[Q.static]===this)return!0;(async()=>n())().catch(e=>{this.context.emit(this.ctx,"internal/error",e)})})}init(n){this.config?this.start():this.cancel(n)}start(){if(!this.ready||this.isActive||this.uid===null)return!0;this.isActive=!0,this.updateStatus(()=>this.hasError=!1)}accept(...n){const t={keys:Array.isArray(n[0])?n.shift():null,callback:n[0],...n[1]};return this.effect(()=>(this.acceptors.push(t),t.immediate&&t.callback?.(this.config),()=>ye(this.acceptors,t)))}decline(n){return this.accept(n,()=>!0)}checkUpdate(n,e){if(e||!this.config)return[!0,!0];if(e===!1)return[!1,!1];const t=Object.create(null),r=D(l=>{const c=t[l]??=!St(this.config[l],n[l]);return s||=c,c},"checkPropertyUpdate"),i=new Set;let s=!1,o=!1,a=this.runtime.isReactive||null;for(const{keys:l,callback:c,passive:h}of this.acceptors){if(!l)a||=!h;else if(h)l?.forEach(p=>i.add(p));else{let p=!1;for(const g of l)p||=r(g);if(!p)continue}c?.(n)&&(o=!0)}for(const l in{...this.config,...n})if(a!==!1&&!(l in t)&&!i.has(l)){const c=r(l);a===null&&(o||=c)}return[s,o]}},Pi=class extends sr{constructor(n,e,t,r){super(n,t),this.runtime=e,this.dispose=Z(n.scope.collect(`fork <${n.runtime.name}>`,()=>{this.uid=null,this.reset(),this.context.emit("internal/fork",this);const i=ye(e.disposables,this.dispose);return ye(e.children,this)&&!e.children.length&&n.registry.delete(e.plugin),i}),Q.static,e),e.children.push(this),e.disposables.push(this.dispose),this.context.emit("internal/fork",this),this.init(r)}static{D(this,"ForkScope")}dispose;start(){if(super.start())return!0;for(const n of this.runtime.forkables)this.ensure(async()=>n(this.context,this._config))}update(n,e){const t=this.config,r=this.runtime.isForkable?this:this.runtime;if(r.config!==t)return;let i;try{i=ft(this.runtime.plugin,n)}catch(a){return this.context.emit("internal/error",a),this.cancel(a)}const[s,o]=r.checkUpdate(i,e);this.context.emit("internal/before-update",this,n),this.config=i,r.config=i,s&&this.context.emit("internal/update",this,t),o&&r.restart()}},or=class extends sr{constructor(n,e,t,r){super(n,t),this.plugin=e,e?(this.setup(),this.init(r)):(this.name="root",this.isActive=!0)}static{D(this,"MainScope")}value;runtime=this;schema;name;inject=Object.create(null);forkables=[];children=[];isReusable=!1;isReactive=!1;get isForkable(){return this.forkables.length>0}fork(n,e,t){return new Pi(n,this,e,t)}dispose(){return this.uid=null,this.reset(),this.context.emit("internal/runtime",this),!0}setup(){const{name:n}=this.plugin;n&&n!=="apply"&&(this.name=n),this.schema=this.plugin.Config||this.plugin.schema,this.inject=At.resolve(this.plugin.using||this.plugin.inject),this.isReusable=this.plugin.reusable,this.isReactive=this.plugin.reactive,this.context.emit("internal/runtime",this),this.isReusable&&this.forkables.push(this.apply)}apply=D((n,e)=>{if(typeof this.plugin!="function")return this.plugin.apply(n,e);if(ln(this.plugin)){const t=new this.plugin(n,e),r=t[Q.expose];return r&&n.set(r,t),t.fork&&this.forkables.push(t.fork.bind(t)),t}else return this.plugin(n,e)},"apply");reset(){super.reset();for(const n of this.children)n.reset()}start(){if(super.start())return!0;!this.isReusable&&this.plugin&&this.ensure(async()=>this.value=this.apply(this.ctx,this._config));for(const n of this.children)n.start()}update(n,e){if(this.isForkable){const a=new Error(`attempting to update forkable plugin "${this.plugin.name}", which may lead to unexpected behavior`);this.context.emit(this.ctx,"internal/warning",a)}const t=this.config;let r;try{r=ft(this.runtime.plugin||this.context.constructor,n)}catch(a){return this.context.emit("internal/error",a),this.cancel(a)}const[i,s]=this.checkUpdate(r,e),o=this.children.find(a=>a.config===t);this.config=r,o&&(this.context.emit("internal/before-update",o,n),o.config=r,i&&this.context.emit("internal/update",o,t)),s&&this.restart()}};function ar(n){return n&&typeof n=="object"&&typeof n.apply=="function"}D(ar,"isApplicable");function At(n){return function(e,t){if(t.kind==="class")e.inject=n;else if(t.kind==="method")t.addInitializer(function(){const r=this[A.tracker]?.property;if(!r)throw new Error("missing context tracker");this[r].inject(n,i=>{e.call(ht(this,{[r]:i}))})});else throw new Error("@Inject can only be used on class or class methods")}}D(At,"Inject"),(n=>{function e(t){if(!t)return{};if(Array.isArray(t))return Object.fromEntries(t.map(o=>[o,{required:!0}]));const{required:r,optional:i,...s}=t;return Array.isArray(r)&&Object.assign(s,Object.fromEntries(r.map(o=>[o,{required:!0}]))),Array.isArray(i)&&Object.assign(s,Object.fromEntries(i.map(o=>[o,{required:!1}]))),s}n.resolve=e,D(e,"resolve")})(At||(At={}));var Li=class{constructor(n,e){this.ctx=n,Z(this,A.tracker,{associate:"registry",property:"ctx"}),this.context=n;const t=new or(n,null,e);n.scope=t,t.ctx=n,this.set(null,t)}static{D(this,"Registry")}_counter=0;_internal=new Map;context;get counter(){return++this._counter}get size(){return this._internal.size}resolve(n,e=!1){if(n===null||typeof n=="function")return n;if(ar(n))return n.apply;if(e)throw new Error('invalid plugin, expect function or object with an "apply" method, received '+typeof n)}get(n){const e=this.resolve(n);return e&&this._internal.get(e)}has(n){const e=this.resolve(n);return!!e&&this._internal.has(e)}set(n,e){const t=this.resolve(n);this._internal.set(t,e)}delete(n){const e=this.resolve(n),t=e&&this._internal.get(e);if(t)return this._internal.delete(e),t.dispose(),t}keys(){return this._internal.keys()}values(){return this._internal.values()}entries(){return this._internal.entries()}forEach(n){return this._internal.forEach(n)}using(n,e){return this.inject(n,e)}inject(n,e){return this.plugin({inject:n,apply:e,name:e.name})}plugin(n,e,t){if(this.resolve(n,!0),this.ctx.scope.assertActive(),!t)try{e=ft(n,e)}catch(i){this.context.emit(this.ctx,"internal/error",i),t=i,e=null}let r=this.get(n);return r?(r.isForkable||this.context.emit(this.ctx,"internal/warning",new Error(`duplicate plugin detected: ${n.name}`)),r.fork(this.ctx,e,t)):(r=new or(this.ctx,n,e,t),this.set(n,r),r.fork(this.ctx,e,t))}},Fi=Li,Q=class vt{static{D(this,"Context")}static store=A.store;static events=A.events;static static=A.static;static filter=A.filter;static expose=A.expose;static isolate=A.isolate;static internal=A.internal;static intercept=A.intercept;static origin="ctx";static current="ctx";static is(e){return!!e?.[vt.is]}static{vt.is[Symbol.toPrimitive]=()=>Symbol.for("cordis.is"),vt.prototype[vt.is]=!0}static associate(e,t){return e}constructor(e){e=ft(this.constructor,e),this[A.store]=Object.create(null),this[A.isolate]=Object.create(null),this[A.internal]=Object.create(null),this[A.intercept]=Object.create(null);const t=new Proxy(this,pn.handler);t.root=t,t.reflect=new pn(t),t.registry=new Fi(t,e),t.lifecycle=new $i(t);const r=D(i=>{if(i){r(Object.getPrototypeOf(i));for(const s of Object.getOwnPropertyNames(i)){const o=i[s].prototype?.constructor;o&&(t[i[s].key]=new o(t,e),Z(t[i[s].key],"ctx",t))}}},"attach");return r(this[A.internal]),t}[Symbol.for("nodejs.util.inspect.custom")](){return`Context <${this.name}>`}get name(){let e=this.runtime;for(;e&&!e.name;)e=e.parent.runtime;return e?.name}get events(){return this.lifecycle}get state(){return this.scope}extend(e={}){const t=Reflect.getOwnPropertyDescriptor(this,A.shadow)?.value,r=Object.assign(Object.create(be(this,this)),e);return t?Object.assign(Object.create(r),{[A.shadow]:t}):r}isolate(e,t){const r=Object.create(this[A.isolate]);return r[e]=t??Symbol(e),this.extend({[A.isolate]:r})}intercept(e,t){const r=Object.create(this[A.intercept]);return r[e]=t,this.extend({[A.intercept]:r})}};Q.prototype[Q.internal]=Object.create(null);var ze=class pi{static{D(this,"Service")}static setup=A.setup;static invoke=A.invoke;static extend=A.extend;static tracker=A.tracker;static provide=A.provide;static immediate=A.immediate;start(){}stop(){}ctx;name;config;constructor(...e){let t,r,i,s;Q.is(e[0])?(t=e[0],typeof e[1]=="string"?(r=e[1],i=e[2]):s=e[1]):s=e[0],r??=this.constructor[A.provide],i??=this.constructor[A.immediate];let o=this;const a={associate:r,property:"ctx"};return o[A.invoke]&&(o=dn(r,cn(Object.getPrototypeOf(this),Function.prototype),a)),t?o.ctx=t:o[A.setup](),o.name=r,o.config=s,Z(o,A.tracker,a),o.ctx.provide(r),o.ctx.runtime.name=r,i&&(t?o[A.expose]=r:o.ctx.set(r,o)),o.ctx.on("ready",async()=>{await Promise.resolve(),await o.start(),i||o.ctx.set(r,o)}),o.ctx.on("dispose",()=>o.stop()),o}[A.filter](e){return e[A.isolate][this.name]===this.ctx[A.isolate][this.name]}[A.setup](){this.ctx=new Q}[A.extend](e){let t;return this[pi.invoke]?t=dn(this.name,this,this[A.tracker]):t=Object.create(this),Object.assign(t,e)}static[Symbol.hasInstance](e){let t=e.constructor;for(;t;){if(t=t.prototype?.constructor,t===this)return!0;t=Object.getPrototypeOf(t)}return!1}},Ci=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ji(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var yn,cr;function Wi(){if(cr)return yn;cr=1;function n(){const t=/(Chrome|Chromium)\/(?<chromeVersion>\d+)\./.exec(navigator.userAgent);if(t)return Number.parseInt(t.groups.chromeVersion,10)}const e=n()>=69?{level:1,hasBasic:!0,has256:!1,has16m:!1}:!1;return yn={stdout:e,stderr:e},yn}var ur=Wi();const Vi=ji(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var bn,fr;function Gi(){if(fr)return bn;fr=1;var n=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=n&&e&&typeof e.get=="function"?e.get:null,r=n&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=i&&s&&typeof s.get=="function"?s.get:null,a=i&&Set.prototype.forEach,l=typeof WeakMap=="function"&&WeakMap.prototype,c=l?WeakMap.prototype.has:null,h=typeof WeakSet=="function"&&WeakSet.prototype,w=h?WeakSet.prototype.has:null,p=typeof WeakRef=="function"&&WeakRef.prototype,g=p?WeakRef.prototype.deref:null,f=Boolean.prototype.valueOf,N=Object.prototype.toString,S=Function.prototype.toString,M=String.prototype.match,m=String.prototype.slice,u=String.prototype.replace,d=String.prototype.toUpperCase,k=String.prototype.toLowerCase,E=RegExp.prototype.test,_=Array.prototype.concat,I=Array.prototype.join,B=Array.prototype.slice,X=Math.floor,Ze=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Qe=Object.getOwnPropertySymbols,Re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,he=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ee=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===he||!0)?Symbol.toStringTag:null,Fe=Object.prototype.propertyIsEnumerable,Ce=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(y){return y.__proto__}:null);function bt(y,b){if(y===1/0||y===-1/0||y!==y||y&&y>-1e3&&y<1e3||E.call(/e/,b))return b;var L=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof y=="number"){var j=y<0?-X(-y):X(y);if(j!==y){var U=String(j),T=m.call(b,U.length+1);return u.call(U,L,"$&_")+"."+u.call(u.call(T,/([0-9]{3})/g,"$&_"),/_$/,"")}}return u.call(b,L,"$&_")}var et=Vi,Xt=et.custom,je=nt(Xt)?Xt:null;bn=function y(b,L,j,U){var T=L||{};if(de(T,"quoteStyle")&&T.quoteStyle!=="single"&&T.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(de(T,"maxStringLength")&&(typeof T.maxStringLength=="number"?T.maxStringLength<0&&T.maxStringLength!==1/0:T.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Y=de(T,"customInspect")?T.customInspect:!0;if(typeof Y!="boolean"&&Y!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(de(T,"indent")&&T.indent!==null&&T.indent!=="	"&&!(parseInt(T.indent,10)===T.indent&&T.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(de(T,"numericSeparator")&&typeof T.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var me=T.numericSeparator;if(typeof b>"u")return"undefined";if(b===null)return"null";if(typeof b=="boolean")return b?"true":"false";if(typeof b=="string")return Ue(b,T);if(typeof b=="number"){if(b===0)return 1/0/b>0?"0":"-0";var ie=String(b);return me?bt(b,ie):ie}if(typeof b=="bigint"){var De=String(b)+"n";return me?bt(b,De):De}var Hn=typeof T.depth>"u"?5:T.depth;if(typeof j>"u"&&(j=0),j>=Hn&&Hn>0&&typeof b=="object")return We(b)?"[Array]":"[Object]";var ot=st(T,j);if(typeof U>"u")U=[];else if(tn(U,b)>=0)return"[Circular]";function ge(at,sn,hl){if(sn&&(U=B.call(U),U.push(sn)),hl){var hi={depth:T.depth};return de(T,"quoteStyle")&&(hi.quoteStyle=T.quoteStyle),y(at,hi,j+1,U)}return y(at,T,j+1,U)}if(typeof b=="function"&&!xe(b)){var si=en(b),oi=G(b,ge);return"[Function"+(si?": "+si:" (anonymous)")+"]"+(oi.length>0?" { "+I.call(oi,", ")+" }":"")}if(nt(b)){var ai=he?u.call(String(b),/^(Symbol\(.*\))_[^)]*$/,"$1"):Re.call(b);return typeof b=="object"&&!he?Be(ai):ai}if(He(b)){for(var _t="<"+k.call(String(b.nodeName)),Kn=b.attributes||[],rn=0;rn<Kn.length;rn++)_t+=" "+Kn[rn].name+"="+tt(wt(Kn[rn].value),"double",T);return _t+=">",b.childNodes&&b.childNodes.length&&(_t+="..."),_t+="</"+k.call(String(b.nodeName))+">",_t}if(We(b)){if(b.length===0)return"[]";var zn=G(b,ge);return ot&&!Me(zn)?"["+F(zn,ot)+"]":"[ "+I.call(zn,", ")+" ]"}if(kt(b)){var Jn=G(b,ge);return!("cause"in Error.prototype)&&"cause"in b&&!Fe.call(b,"cause")?"{ ["+String(b)+"] "+I.call(_.call("[cause]: "+ge(b.cause),Jn),", ")+" }":Jn.length===0?"["+String(b)+"]":"{ ["+String(b)+"] "+I.call(Jn,", ")+" }"}if(typeof b=="object"&&Y){if(je&&typeof b[je]=="function"&&et)return et(b,{depth:Hn-j});if(Y!=="symbol"&&typeof b.inspect=="function")return b.inspect()}if(rt(b)){var li=[];return r&&r.call(b,function(at,sn){li.push(ge(sn,b,!0)+" => "+ge(at,b))}),oe("Map",t.call(b),li,ot)}if(Gn(b)){var ci=[];return a&&a.call(b,function(at){ci.push(ge(at,b))}),oe("Set",o.call(b),ci,ot)}if(nn(b))return it("WeakMap");if(Et(b))return it("WeakSet");if(qe(b))return it("WeakRef");if(Zt(b))return Be(ge(Number(b)));if(Nt(b))return Be(ge(Ze.call(b)));if(Ge(b))return Be(f.call(b));if(Ve(b))return Be(ge(String(b)));if(typeof window<"u"&&b===window)return"{ [object Window] }";if(b===Ci)return"{ [object globalThis] }";if(!Yt(b)&&!xe(b)){var Xn=G(b,ge),ui=Ce?Ce(b)===Object.prototype:b instanceof Object||b.constructor===Object,Yn=b instanceof Object?"":"null prototype",fi=!ui&&ee&&Object(b)===b&&ee in b?m.call(pe(b),8,-1):Yn?"Object":"",fl=ui||typeof b.constructor!="function"?"":b.constructor.name?b.constructor.name+" ":"",Zn=fl+(fi||Yn?"["+I.call(_.call([],fi||[],Yn||[]),": ")+"] ":"");return Xn.length===0?Zn+"{}":ot?Zn+"{"+F(Xn,ot)+"}":Zn+"{ "+I.call(Xn,", ")+" }"}return String(b)};function tt(y,b,L){var j=(L.quoteStyle||b)==="double"?'"':"'";return j+y+j}function wt(y){return u.call(String(y),/"/g,"&quot;")}function We(y){return pe(y)==="[object Array]"&&(!ee||!(typeof y=="object"&&ee in y))}function Yt(y){return pe(y)==="[object Date]"&&(!ee||!(typeof y=="object"&&ee in y))}function xe(y){return pe(y)==="[object RegExp]"&&(!ee||!(typeof y=="object"&&ee in y))}function kt(y){return pe(y)==="[object Error]"&&(!ee||!(typeof y=="object"&&ee in y))}function Ve(y){return pe(y)==="[object String]"&&(!ee||!(typeof y=="object"&&ee in y))}function Zt(y){return pe(y)==="[object Number]"&&(!ee||!(typeof y=="object"&&ee in y))}function Ge(y){return pe(y)==="[object Boolean]"&&(!ee||!(typeof y=="object"&&ee in y))}function nt(y){if(he)return y&&typeof y=="object"&&y instanceof Symbol;if(typeof y=="symbol")return!0;if(!y||typeof y!="object"||!Re)return!1;try{return Re.call(y),!0}catch{}return!1}function Nt(y){if(!y||typeof y!="object"||!Ze)return!1;try{return Ze.call(y),!0}catch{}return!1}var Qt=Object.prototype.hasOwnProperty||function(y){return y in this};function de(y,b){return Qt.call(y,b)}function pe(y){return N.call(y)}function en(y){if(y.name)return y.name;var b=M.call(S.call(y),/^function\s*([\w$]+)/);return b?b[1]:null}function tn(y,b){if(y.indexOf)return y.indexOf(b);for(var L=0,j=y.length;L<j;L++)if(y[L]===b)return L;return-1}function rt(y){if(!t||!y||typeof y!="object")return!1;try{t.call(y);try{o.call(y)}catch{return!0}return y instanceof Map}catch{}return!1}function nn(y){if(!c||!y||typeof y!="object")return!1;try{c.call(y,c);try{w.call(y,w)}catch{return!0}return y instanceof WeakMap}catch{}return!1}function qe(y){if(!g||!y||typeof y!="object")return!1;try{return g.call(y),!0}catch{}return!1}function Gn(y){if(!o||!y||typeof y!="object")return!1;try{o.call(y);try{t.call(y)}catch{return!0}return y instanceof Set}catch{}return!1}function Et(y){if(!w||!y||typeof y!="object")return!1;try{w.call(y,w);try{c.call(y,c)}catch{return!0}return y instanceof WeakSet}catch{}return!1}function He(y){return!y||typeof y!="object"?!1:typeof HTMLElement<"u"&&y instanceof HTMLElement?!0:typeof y.nodeName=="string"&&typeof y.getAttribute=="function"}function Ue(y,b){if(y.length>b.maxStringLength){var L=y.length-b.maxStringLength,j="... "+L+" more character"+(L>1?"s":"");return Ue(m.call(y,0,b.maxStringLength),b)+j}var U=u.call(u.call(y,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,qn);return tt(U,"single",b)}function qn(y){var b=y.charCodeAt(0),L={8:"b",9:"t",10:"n",12:"f",13:"r"}[b];return L?"\\"+L:"\\x"+(b<16?"0":"")+d.call(b.toString(16))}function Be(y){return"Object("+y+")"}function it(y){return y+" { ? }"}function oe(y,b,L,j){var U=j?F(L,j):I.call(L,", ");return y+" ("+b+") {"+U+"}"}function Me(y){for(var b=0;b<y.length;b++)if(tn(y[b],`
`)>=0)return!1;return!0}function st(y,b){var L;if(y.indent==="	")L="	";else if(typeof y.indent=="number"&&y.indent>0)L=I.call(Array(y.indent+1)," ");else return null;return{base:L,prev:I.call(Array(b+1),L)}}function F(y,b){if(y.length===0)return"";var L=`
`+b.prev+b.base;return L+I.call(y,","+L)+`
`+b.prev}function G(y,b){var L=We(y),j=[];if(L){j.length=y.length;for(var U=0;U<y.length;U++)j[U]=de(y,U)?b(y[U],y):""}var T=typeof Qe=="function"?Qe(y):[],Y;if(he){Y={};for(var me=0;me<T.length;me++)Y["$"+T[me]]=T[me]}for(var ie in y)de(y,ie)&&(L&&String(Number(ie))===ie&&ie<y.length||he&&Y["$"+ie]instanceof Symbol||(E.call(/[^\w$]/,ie)?j.push(b(ie,y)+": "+b(y[ie],y)):j.push(ie+": "+b(y[ie],y))));if(typeof Qe=="function")for(var De=0;De<T.length;De++)Fe.call(y,T[De])&&j.push("["+b(T[De])+"]: "+b(y[T[De]],y));return j}return bn}var qi=Gi();const Hi=lr(qi);var Ki=Object.create,wn=Object.defineProperty,zi=Object.getOwnPropertyDescriptor,hr=Object.getOwnPropertyNames,Ji=Object.getPrototypeOf,Xi=Object.prototype.hasOwnProperty,dr=(n,e)=>wn(n,"name",{value:e,configurable:!0}),pr=(n,e)=>function(){return e||(0,n[hr(n)[0]])((e={exports:{}}).exports,e),e.exports},Yi=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of hr(e))!Xi.call(n,i)&&i!==t&&wn(n,i,{get:()=>e[i],enumerable:!(r=zi(e,i))||r.enumerable});return n},Zi=(n,e,t)=>(t=n!=null?Ki(Ji(n)):{},Yi(!n||!n.__esModule?wn(t,"default",{value:n,enumerable:!0}):t,n)),Qi=pr({"src/shared.ts"(n,e){var t=[6,2,3,4,5,1],r=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221];function i(o){return o instanceof Error&&Array.isArray(o.errors)}dr(i,"isAggregateError");var s=class te{constructor(a,l){this.name=a,this.meta=l,this.createMethod("success",te.SUCCESS),this.createMethod("error",te.ERROR),this.createMethod("info",te.INFO),this.createMethod("warn",te.WARN),this.createMethod("debug",te.DEBUG)}static{dr(this,"Logger")}static SILENT=0;static SUCCESS=1;static ERROR=1;static INFO=2;static WARN=2;static DEBUG=3;static id=0;static targets=[{colors:ur.stdout&&ur.stdout.level,print(a){}}];static formatters=Object.create(null);static format(a,l){this.formatters[a]=l}static levels={base:2};static color(a,l,c,h=""){return a.colors?`\x1B[3${l<8?l:"8;5;"+l}${a.colors>=2?h:""}m${c}\x1B[0m`:""+c}static code(a,l){let c=0;for(let w=0;w<a.length;w++)c=(c<<3)-c+a.charCodeAt(w)+13,c|=0;const h=l.colors?l.colors>=2?r:t:[];return h[Math.abs(c)%h.length]}static render(a,l){const c=`[${l.type[0].toUpperCase()}]`,h=" ".repeat(a.label?.margin??1);let w=3+h.length,p="";a.showTime&&(w+=a.showTime.length+h.length,p+=te.color(a,8,It.template(a.showTime))+h);const g=te.code(l.name,a),f=te.color(a,g,l.name,";1"),N=(a.label?.width??0)+f.length-l.name.length;if(a.label?.align==="right"?(p+=f.padStart(N)+h+c+h,w+=(a.label.width??0)+h.length):p+=c+h+f.padEnd(N)+h,p+=l.content.replace(/\n/g,`
`+" ".repeat(w)),a.showDiff&&a.timestamp){const S=l.timestamp-a.timestamp;p+=te.color(a,g," +"+It.format(S))}return p}extend=a=>new te(`${this.name}:${a}`,this.meta);warning=(a,...l)=>{this.warn(a,...l)};createMethod(a,l){this[a]=(...c)=>{if(c.length===1&&c[0]instanceof Error){if(c[0].cause)this[a](c[0].cause);else if(i(c[0])){c[0].errors.forEach(p=>this[a](p));return}}const h=++te.id,w=Date.now();for(const p of te.targets){if(this.getLevel(p)<l)continue;const g=this.format(p,...c),f={id:h,type:a,level:l,name:this.name,meta:this.meta,content:g,timestamp:w};if(p.record)p.record(f);else{const{print:N=console.log}=p;N(te.render(p,f))}p.timestamp=w}}}format(a,...l){l[0]instanceof Error?(l[0]=l[0].stack||l[0].message,l.unshift("%s")):typeof l[0]!="string"&&l.unshift("%o");let c=l.shift();c=c.replace(/%([a-zA-Z%])/g,(w,p)=>{if(w==="%%")return"%";const g=te.formatters[p];if(typeof g=="function"){const f=l.shift();return g(f,a,this)}return w});for(let w of l)typeof w=="object"&&w&&(w=te.formatters.o(w,a,this)),c+=" "+w;const{maxLength:h=10240}=a;return c.split(/\r?\n/g).map(w=>w.slice(0,h)+(w.length>h?"...":"")).join(`
`)}getLevel(a){const l=this.name.split(":");let c=a?.levels||te.levels;do c=c[l.shift()]??c.base;while(l.length&&typeof c=="object");return c}get level(){return this.getLevel()}set level(a){const l=this.name.split(":");let c=te.levels;for(;l.length>1;){const h=l.shift(),w=c[h];typeof w=="object"?c=w:c=c[h]={base:w??c.base}}c[l[0]]=a}};s.format("s",o=>o),s.format("d",o=>+o),s.format("j",o=>JSON.stringify(o)),s.format("c",(o,a,l)=>s.color(a,s.code(l.name,a),o)),s.format("C",(o,a)=>s.color(a,15,o,";1")),e.exports=s}}),es=pr({"src/browser.ts"(n,e){var t=Zi(Qi());t.default.format("o",(r,i)=>Hi(r,{depth:1/0}).replace(/\s*\n\s*/g," ")),e.exports=t.default}});const ts=es();var ns=Object.defineProperty,rs=(n,e)=>ns(n,"name",{value:e,configurable:!0}),is=class mi extends ze{static{rs(this,"LoggerService")}constructor(e){super(e,"logger",!0),e.on("internal/info",function(t,...r){this.logger("app").info(t,...r)}),e.on("internal/error",function(t,...r){this.logger("app").error(t,...r)}),e.on("internal/warning",function(t,...r){this.logger("app").warn(t,...r)})}[ze.invoke](e){return new ts(e,Z({},"ctx",this.ctx))}static{for(const e of["success","error","info","warn","debug","extend"])mi.prototype[e]=function(...t){return this(this.ctx.name)[e](...t)}}},ss=Object.defineProperty,$=(n,e)=>ss(n,"name",{value:e,configurable:!0});function os(){}$(os,"noop");function ne(n){return n==null}$(ne,"isNullable");function as(n){return!ne(n)}$(as,"isNonNullable");function Rt(n){return n&&typeof n=="object"&&!Array.isArray(n)}$(Rt,"isPlainObject");function mr(n,e){return Object.fromEntries(Object.entries(n).filter(([t,r])=>e(t,r)))}$(mr,"filterKeys");function Ee(n,e){return Object.fromEntries(Object.entries(n).map(([t,r])=>[t,e(r,t)]))}$(Ee,"mapValues");function gr(n,e,t){if(!e)return{...n};const r={};for(const i of e)(t||n[i]!==void 0)&&(r[i]=n[i]);return r}$(gr,"pick");function ls(n,e){if(!e)return{...n};const t={...n};for(const r of e)Reflect.deleteProperty(t,r);return t}$(ls,"omit");function cs(n,e,t){return Object.defineProperty(n,e,{writable:!0,value:t,enumerable:!1})}$(cs,"defineProperty");function us(n,e){return e.every(t=>n.includes(t))}$(us,"contain");function fs(n,e){return n.filter(t=>e.includes(t))}$(fs,"intersection");function hs(n,e){return n.filter(t=>!e.includes(t))}$(hs,"difference");function ds(n,e){return Array.from(new Set([...n,...e]))}$(ds,"union");function ps(n){return[...new Set(n)]}$(ps,"deduplicate");function ms(n,e){const t=n?.indexOf(e);return t>=0?(n.splice(t,1),!0):!1}$(ms,"remove");function gs(n){return Array.isArray(n)?n:ne(n)?[]:[n]}$(gs,"makeArray");function Te(n,e){return arguments.length===1?t=>Te(n,t):n in globalThis&&e instanceof globalThis[n]||Object.prototype.toString.call(e).slice(8,-1)===n}$(Te,"is");function dt(n){return Te("ArrayBuffer",n)||Te("SharedArrayBuffer",n)}$(dt,"isArrayBufferLike");function yr(n){return dt(n)||ArrayBuffer.isView(n)}$(yr,"isArrayBufferSource");var we;(n=>{n.is=dt,n.isSource=yr;function e(o){return ArrayBuffer.isView(o)?o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength):o}n.fromSource=e,$(e,"fromSource");function t(o){if(typeof Buffer<"u")return Buffer.from(o).toString("base64");let a="";const l=new Uint8Array(o);for(let c=0;c<l.byteLength;c++)a+=String.fromCharCode(l[c]);return btoa(a)}n.toBase64=t,$(t,"toBase64");function r(o){return typeof Buffer<"u"?e(Buffer.from(o,"base64")):Uint8Array.from(atob(o),a=>a.charCodeAt(0))}n.fromBase64=r,$(r,"fromBase64");function i(o){return typeof Buffer<"u"?Buffer.from(o).toString("hex"):Array.from(new Uint8Array(o),a=>a.toString(16).padStart(2,"0")).join("")}n.toHex=i,$(i,"toHex");function s(o){if(typeof Buffer<"u")return e(Buffer.from(o,"hex"));const a=o.length%2===0?o:o.slice(0,o.length-1),l=[];for(let c=0;c<a.length;c+=2)l.push(parseInt(`${a[c]}${a[c+1]}`,16));return Uint8Array.from(l).buffer}n.fromHex=s,$(s,"fromHex")})(we||(we={})),we.fromBase64,we.toBase64,we.fromHex,we.toHex;function xt(n,e=new Map){if(!n||typeof n!="object")return n;if(Te("Date",n))return new Date(n.valueOf());if(Te("RegExp",n))return new RegExp(n.source,n.flags);if(dt(n))return n.slice(0);if(ArrayBuffer.isView(n))return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);const t=e.get(n);if(t)return t;if(Array.isArray(n)){const i=[];return e.set(n,i),n.forEach((s,o)=>{i[o]=Reflect.apply(xt,null,[s,e])}),i}const r=Object.create(Object.getPrototypeOf(n));e.set(n,r);for(const i of Reflect.ownKeys(n)){const s={...Reflect.getOwnPropertyDescriptor(n,i)};"value"in s&&(s.value=Reflect.apply(xt,null,[s.value,e])),Reflect.defineProperty(r,i,s)}return r}$(xt,"clone");function Je(n,e,t){if(n===e||!t&&ne(n)&&ne(e))return!0;if(typeof n!=typeof e||typeof n!="object"||!n||!e)return!1;function r(i,s){return i(n)?i(e)?s(n,e):!1:i(e)?!1:void 0}return $(r,"check"),r(Array.isArray,(i,s)=>i.length===s.length&&i.every((o,a)=>Je(o,s[a])))??r(Te("Date"),(i,s)=>i.valueOf()===s.valueOf())??r(Te("RegExp"),(i,s)=>i.source===s.source&&i.flags===s.flags)??r(dt,(i,s)=>{if(i.byteLength!==s.byteLength)return!1;const o=new Uint8Array(i),a=new Uint8Array(s);for(let l=0;l<o.length;l++)if(o[l]!==a[l])return!1;return!0})??Object.keys({...n,...e}).every(i=>Je(n[i],e[i],t))}$(Je,"deepEqual");function ys(n){return n.charAt(0).toUpperCase()+n.slice(1)}$(ys,"capitalize");function bs(n){return n.charAt(0).toLowerCase()+n.slice(1)}$(bs,"uncapitalize");function ws(n){return n.replace(/[_-][a-z]/g,e=>e.slice(1).toUpperCase())}$(ws,"camelCase");function kn(n,e,t){const r=[];let i=0;for(let s=0;s<n.length;s++){const o=n.charCodeAt(s);if(o>=65&&o<=90){if(i===1){const a=n.charCodeAt(s+1);a>=97&&a<=122&&r.push(t),r.push(o+32)}else i!==0&&r.push(t),r.push(o+32);i=1}else o>=97&&o<=122?(r.push(o),i=2):e.includes(o)?(i!==0&&r.push(t),i=0):r.push(o)}return String.fromCharCode(...r)}$(kn,"tokenize");function ks(n){return kn(n,[45,95],45)}$(ks,"paramCase");function Ns(n){return kn(n,[45,95],95)}$(Ns,"snakeCase");function Es(n){return typeof n!="string"?`[${n.toString()}]`:/^[a-z_$][\w$]*$/i.test(n)?`.${n}`:`[${JSON.stringify(n)}]`}$(Es,"formatProperty");function br(n){return n.replace(/\/$/,"")}$(br,"trimSlash");function _s(n){return n.startsWith("/")||(n="/"+n),br(n)}$(_s,"sanitize");var wr;(n=>{n.millisecond=1,n.second=1e3,n.minute=n.second*60,n.hour=n.minute*60,n.day=n.hour*24,n.week=n.day*7;let e=new Date().getTimezoneOffset();function t(g){e=g}n.setTimezoneOffset=t,$(t,"setTimezoneOffset");function r(){return e}n.getTimezoneOffset=r,$(r,"getTimezoneOffset");function i(g=new Date,f){return typeof g=="number"&&(g=new Date(g)),f===void 0&&(f=e),Math.floor((g.valueOf()/n.minute-f)/1440)}n.getDateNumber=i,$(i,"getDateNumber");function s(g,f){const N=new Date(g*n.day);return f===void 0&&(f=e),new Date(+N+f*n.minute)}n.fromDateNumber=s,$(s,"fromDateNumber");const o=/\d+(?:\.\d+)?/.source,a=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(g=>`(${o}${g})?`).join("")}$`);function l(g){const f=a.exec(g);return f?(parseFloat(f[1])*n.week||0)+(parseFloat(f[2])*n.day||0)+(parseFloat(f[3])*n.hour||0)+(parseFloat(f[4])*n.minute||0)+(parseFloat(f[5])*n.second||0):0}n.parseTime=l,$(l,"parseTime");function c(g){const f=l(g);return f?g=Date.now()+f:/^\d{1,2}(:\d{1,2}){1,2}$/.test(g)?g=`${new Date().toLocaleDateString()}-${g}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(g)&&(g=`${new Date().getFullYear()}-${g}`),g?new Date(g):new Date}n.parseDate=c,$(c,"parseDate");function h(g){const f=Math.abs(g);return f>=n.day-n.hour/2?Math.round(g/n.day)+"d":f>=n.hour-n.minute/2?Math.round(g/n.hour)+"h":f>=n.minute-n.second/2?Math.round(g/n.minute)+"m":f>=n.second?Math.round(g/n.second)+"s":g+"ms"}n.format=h,$(h,"format");function w(g,f=2){return g.toString().padStart(f,"0")}n.toDigits=w,$(w,"toDigits");function p(g,f=new Date){return g.replace("yyyy",f.getFullYear().toString()).replace("yy",f.getFullYear().toString().slice(2)).replace("MM",w(f.getMonth()+1)).replace("dd",w(f.getDate())).replace("hh",w(f.getHours())).replace("mm",w(f.getMinutes())).replace("ss",w(f.getSeconds())).replace("SSS",w(f.getMilliseconds(),3))}n.template=p,$(p,"template")})(wr||(wr={}));var vs=Object.defineProperty,Ss=Object.getOwnPropertyNames,H=(n,e)=>vs(n,"name",{value:e,configurable:!0}),Is=(n,e)=>function(){return e||(0,n[Ss(n)[0]])((e={exports:{}}).exports,e),e.exports},Ts=Is({"src/index.ts"(n,e){var t=Symbol.for("schemastery"),r=Symbol.for("ValidationError");globalThis.__schemastery_index__??=0;var i=class extends TypeError{constructor(m,u){let d="$";for(const k of u.path||[])typeof k=="string"?d+="."+k:typeof k=="number"?d+="["+k+"]":typeof k=="symbol"&&(d+=`[Symbol(${k.toString()})]`);d.startsWith(".")&&(d=d.slice(1)),super((d==="$"?"":`${d} `)+m),this.options=u}static{H(this,"ValidationError")}name="ValidationError";static is(m){return!!m?.[r]}};Object.defineProperty(i.prototype,r,{value:!0});var s=H(function(m){const u=H(function(d,k={}){return s.resolve(d,u,k)[0]},"schema");if(m.refs){const d=Ee(m.refs,E=>new s(E)),k=H(E=>d[E],"getRef");for(const E in d){const _=d[E];_.sKey=k(_.sKey),_.inner=k(_.inner),_.list=_.list&&_.list.map(k),_.dict=_.dict&&Ee(_.dict,k)}return d[m.uid]}if(Object.assign(u,m),typeof u.callback=="string")try{u.callback=new Function("return "+u.callback)()}catch{}return Object.defineProperty(u,"uid",{value:globalThis.__schemastery_index__++}),Object.setPrototypeOf(u,s.prototype),u.meta||={},u.toString=u.toString.bind(u),u},"Schema");s.prototype=Object.create(Function.prototype),s.prototype[t]=!0,s.ValidationError=i;var o;s.prototype.toJSON=H(function(){if(o)return o[this.uid]??=JSON.parse(JSON.stringify({...this})),this.uid;o={[this.uid]:{...this}},o[this.uid]=JSON.parse(JSON.stringify({...this}));const u={uid:this.uid,refs:o};return o=void 0,u},"toJSON"),s.prototype.set=H(function(u,d){return this.dict[u]=d,this},"set"),s.prototype.push=H(function(u){return this.list.push(u),this},"push");function a(m,u){const d=typeof m=="string"?{"":m}:{...m};for(const k in u){const E=u[k];E?.$description||E?.$desc?d[k]=E.$description||E.$desc:typeof E=="string"&&(d[k]=E)}return d}H(a,"mergeDesc");function l(m){return m?.$value??m?.$inner}H(l,"getInner");function c(m){return mr(m??{},u=>!u.startsWith("$"))}H(c,"extractKeys"),s.prototype.i18n=H(function(u){const d=s(this),k=a(d.meta.description,u);return Object.keys(k).length&&(d.meta.description=k),d.dict&&(d.dict=Ee(d.dict,(E,_)=>E.i18n(Ee(u,I=>l(I)?.[_]??I?.[_])))),d.list&&(d.list=d.list.map((E,_)=>E.i18n(Ee(u,(I={})=>Array.isArray(l(I))?l(I)[_]:Array.isArray(I)?I[_]:c(I))))),d.inner&&(d.inner=d.inner.i18n(Ee(u,E=>l(E)?l(E):c(E)))),d.sKey&&(d.sKey=d.sKey.i18n(Ee(u,E=>E?.$key))),d},"i18n"),s.prototype.extra=H(function(u,d){const k=s(this);return k.meta={...k.meta,[u]:d},k},"extra");for(const m of["required","disabled","collapse","hidden","loose"])Object.assign(s.prototype,{[m](u=!0){const d=s(this);return d.meta={...d.meta,[m]:u},d}});s.prototype.deprecated=H(function(){const u=s(this);return u.meta.badges||=[],u.meta.badges.push({text:"deprecated",type:"danger"}),u},"deprecated"),s.prototype.experimental=H(function(){const u=s(this);return u.meta.badges||=[],u.meta.badges.push({text:"experimental",type:"warning"}),u},"experimental"),s.prototype.pattern=H(function(u){const d=s(this),k=gr(u,["source","flags"]);return d.meta={...d.meta,pattern:k},d},"pattern"),s.prototype.simplify=H(function(u){if(Je(u,this.meta.default,this.type==="dict"))return null;if(ne(u))return u;if(this.type==="object"||this.type==="dict"){const d={};for(const k in u){const _=(this.type==="object"?this.dict[k]:this.inner)?.simplify(u[k]);(this.type==="dict"||!ne(_))&&(d[k]=_)}return Je(d,this.meta.default,this.type==="dict")?null:d}else if(this.type==="array"||this.type==="tuple"){const d=[];return u.forEach((k,E)=>{const _=this.type==="array"?this.inner:this.list[E],I=_?_.simplify(k):k;d.push(I)}),d}else if(this.type==="intersect"){const d={};for(const k of this.list)Object.assign(d,k.simplify(u));return d}else if(this.type==="union")for(const d of this.list)try{return s.resolve(u,d,{}),d.simplify(u)}catch{}return u},"simplify"),s.prototype.toString=H(function(u){return S[this.type]?.(this,u)??`Schema<${this.type}>`},"toString"),s.prototype.role=H(function(m,u){const d=s(this);return d.meta={...d.meta,role:m,extra:u},d},"role");for(const m of["default","link","comment","description","max","min","step"])Object.assign(s.prototype,{[m](u){const d=s(this);return d.meta={...d.meta,[m]:u},d}});var h={};s.extend=H(function(u,d){h[u]=d},"extend"),s.resolve=H(function(u,d,k={},E=!1){if(!d)return[u];if(k.ignore?.(u,d))return[u];if(ne(u)&&d.type!=="lazy"){if(d.meta.required)throw new i("missing required value",k);let I=d,B=d.meta.default;for(;I?.type==="intersect"&&ne(B);)I=I.list[0],B=I?.meta.default;if(ne(B))return[u];u=xt(B)}const _=h[d.type];if(!_)throw new i(`unsupported type "${d.type}"`,k);try{return _(u,d,k,E)}catch(I){if(!d.meta.loose)throw I;return[d.meta.default]}},"resolve"),s.from=H(function(u){if(ne(u))return s.any();if(["string","number","boolean"].includes(typeof u))return s.const(u).required();if(u[t])return u;if(typeof u=="function")switch(u){case String:return s.string().required();case Number:return s.number().required();case Boolean:return s.boolean().required();case Function:return s.function().required();default:return s.is(u).required()}else throw new TypeError(`cannot infer schema from ${u}`)},"from"),s.lazy=H(function(u){const d=H(()=>(k.inner[t]||(k.inner=k.builder(),k.inner.meta={...k.meta,...k.inner.meta}),k.inner.toJSON()),"toJSON"),k=new s({type:"lazy",builder:u,inner:{toJSON:d}});return k},"lazy"),s.natural=H(function(){return s.number().step(1).min(0)},"natural"),s.percent=H(function(){return s.number().step(.01).min(0).max(1).role("slider")},"percent"),s.date=H(function(){return s.union([s.is(Date),s.transform(s.string().role("datetime"),(u,d)=>{const k=new Date(u);if(isNaN(+k))throw new i(`invalid date "${u}"`,d);return k},!0)])},"date"),s.regExp=H(function(u=""){return s.union([s.is(RegExp),s.transform(s.string().role("regexp",{flag:u}),(d,k)=>{try{return new RegExp(d,u)}catch(E){throw new i(E.message,k)}},!0)])},"regExp"),s.arrayBuffer=H(function(u){return s.union([s.is(ArrayBuffer),s.is(SharedArrayBuffer),s.transform(s.any(),(d,k)=>{if(we.isSource(d))return we.fromSource(d);throw new i(`expected ArrayBufferSource but got ${d}`,k)},!0),...u?[s.transform(s.string(),(d,k)=>{try{return u==="base64"?we.fromBase64(d):we.fromHex(d)}catch(E){throw new i(E.message,k)}},!0)]:[]])},"arrayBuffer"),s.extend("lazy",(m,u,d,k)=>(u.inner[t]||(u.inner=u.builder(),u.inner.meta={...u.meta,...u.inner.meta}),s.resolve(m,u.inner,d,k))),s.extend("any",m=>[m]),s.extend("never",(m,u,d)=>{throw new i(`expected nullable but got ${m}`,d)}),s.extend("const",(m,{value:u},d)=>{if(Je(m,u))return[u];throw new i(`expected ${u} but got ${m}`,d)});function w(m,u,d,k,E=!1){const{max:_=1/0,min:I=-1/0}=u;if(m>_)throw new i(`expected ${d} <= ${_} but got ${m}`,k);if(m<I&&!E)throw new i(`expected ${d} >= ${I} but got ${m}`,k)}H(w,"checkWithinRange"),s.extend("string",(m,{meta:u},d)=>{if(typeof m!="string")throw new i(`expected string but got ${m}`,d);if(u.pattern){const k=new RegExp(u.pattern.source,u.pattern.flags);if(!k.test(m))throw new i(`expect string to match regexp ${k}`,d)}return w(m.length,u,"string length",d),[m]});function p(m,u){const d=m.toString();if(d.includes("e"))return m*Math.pow(10,u);const k=d.indexOf(".");if(k===-1)return m*Math.pow(10,u);const E=d.slice(k+1),_=d.slice(0,k);return E.length<=u?+(_+E.padEnd(u,"0")):+(_+E.slice(0,u)+"."+E.slice(u))}H(p,"decimalShift");function g(m,u,d){if(d=Math.abs(d),!/^\d+\.\d+$/.test(d.toString()))return(m-u)%d===0;const k=d.toString().indexOf("."),E=d.toString().slice(k+1).length;return Math.abs(p(m,E)-p(u,E))%p(d,E)===0}H(g,"isMultipleOf"),s.extend("number",(m,{meta:u},d)=>{if(typeof m!="number")throw new i(`expected number but got ${m}`,d);w(m,u,"number",d);const{step:k}=u;if(k&&!g(m,u.min??0,k))throw new i(`expected number multiple of ${k} but got ${m}`,d);return[m]}),s.extend("boolean",(m,u,d)=>{if(typeof m=="boolean")return[m];throw new i(`expected boolean but got ${m}`,d)}),s.extend("bitset",(m,{bits:u,meta:d},k)=>{let E=0,_=[];if(typeof m=="number"){E=m;for(const I in u)m&u[I]&&_.push(I)}else if(Array.isArray(m)){_=m;for(const I of _){if(typeof I!="string")throw new i(`expected string but got ${I}`,k);I in u&&(E|=u[I])}}else throw new i(`expected number or array but got ${m}`,k);return E===d.default?[E]:[E,_]}),s.extend("function",(m,u,d)=>{if(typeof m=="function")return[m];throw new i(`expected function but got ${m}`,d)}),s.extend("is",(m,{constructor:u},d)=>{if(typeof u=="function"){if(m instanceof u)return[m];throw new i(`expected ${u.name} but got ${m}`,d)}else{if(ne(m))throw new i(`expected ${u} but got ${m}`,d);let k=Object.getPrototypeOf(m);for(;k;){if(k.constructor?.name===u)return[m];k=Object.getPrototypeOf(k)}throw new i(`expected ${u} but got ${m}`,d)}});function f(m,u,d,k){try{const[E,_]=s.resolve(m[u],d,{...k,path:[...k.path||[],u]});return _!==void 0&&(m[u]=_),E}catch(E){if(!k?.autofix)throw E;return delete m[u],d.meta.default}}H(f,"property"),s.extend("array",(m,{inner:u,meta:d},k)=>{if(!Array.isArray(m))throw new i(`expected array but got ${m}`,k);return w(m.length,d,"array length",k,!ne(u.meta.default)),[m.map((E,_)=>f(m,_,u,k))]}),s.extend("dict",(m,{inner:u,sKey:d},k,E)=>{if(!Rt(m))throw new i(`expected object but got ${m}`,k);const _={};for(const I in m){let B;try{B=s.resolve(I,d,k)[0]}catch(X){if(E)continue;throw X}_[B]=f(m,I,u,k),m[B]=m[I],I!==B&&delete m[I]}return[_]}),s.extend("tuple",(m,{list:u},d,k)=>{if(!Array.isArray(m))throw new i(`expected array but got ${m}`,d);const E=u.map((_,I)=>f(m,I,_,d));return k?[E]:(E.push(...m.slice(u.length)),[E])});function N(m,u){for(const d in u)d in m||(m[d]=u[d])}H(N,"merge"),s.extend("object",(m,{dict:u},d,k)=>{if(!Rt(m))throw new i(`expected object but got ${m}`,d);const E={};for(const _ in u){const I=f(m,_,u[_],d);(!ne(I)||_ in m)&&(E[_]=I)}return k||N(E,m),[E]}),s.extend("union",(m,{list:u,toString:d},k,E)=>{for(const _ of u)try{return s.resolve(m,_,k,E)}catch{}throw new i(`expected ${d()} but got ${JSON.stringify(m)}`,k)}),s.extend("intersect",(m,{list:u,toString:d},k,E)=>{if(!u.length)return[m];let _;for(const I of u){const B=s.resolve(m,I,k,!0)[0];if(!ne(B))if(ne(_))_=B;else{if(typeof _!=typeof B)throw new i(`expected ${d()} but got ${JSON.stringify(m)}`,k);if(typeof B=="object")N(_??={},B);else if(_!==B)throw new i(`expected ${d()} but got ${JSON.stringify(m)}`,k)}}return!E&&Rt(m)&&N(_,m),[_]}),s.extend("transform",(m,{inner:u,callback:d,preserve:k},E)=>{const[_,I=m]=s.resolve(m,u,E,!0);return k?[d(_)]:[d(_),d(I)]});var S={};function M(m,u,d){S[m]=d,Object.assign(s,{[m](...k){const E=new s({type:m});return u.forEach((_,I)=>{switch(_){case"sKey":E.sKey=k[I]??s.string();break;case"inner":E.inner=s.from(k[I]);break;case"list":E.list=k[I].map(s.from);break;case"dict":E.dict=Ee(k[I],s.from);break;case"bits":{E.bits={};for(const B in k[I])typeof k[I][B]=="number"&&(E.bits[B]=k[I][B]);break}case"callback":{const B=E.callback=k[I];B.toJSON||=()=>B.toString();break}case"constructor":{const B=E.constructor=k[I];typeof B=="function"&&(B.toJSON||=()=>B.name);break}default:E[_]=k[I]}}),m==="object"||m==="dict"?E.meta.default={}:m==="array"||m==="tuple"?E.meta.default=[]:m==="bitset"&&(E.meta.default=0),E}})}H(M,"defineMethod"),M("is",["constructor"],({constructor:m})=>typeof m=="function"?m.name:m),M("any",[],()=>"any"),M("never",[],()=>"never"),M("const",["value"],({value:m})=>typeof m=="string"?JSON.stringify(m):m),M("string",[],()=>"string"),M("number",[],()=>"number"),M("boolean",[],()=>"boolean"),M("bitset",["bits"],()=>"bitset"),M("function",[],()=>"function"),M("array",["inner"],({inner:m})=>`${m.toString(!0)}[]`),M("dict",["inner","sKey"],({inner:m,sKey:u})=>`{ [key: ${u.toString()}]: ${m.toString()} }`),M("tuple",["list"],({list:m})=>`[${m.map(u=>u.toString()).join(", ")}]`),M("object",["dict"],({dict:m})=>Object.keys(m).length===0?"{}":`{ ${Object.entries(m).map(([u,d])=>`${u}${d.meta.required?"":"?"}: ${d.toString()}`).join(", ")} }`),M("union",["list"],({list:m},u)=>{const d=m.map(({toString:k})=>k()).join(" | ");return u?`(${d})`:d}),M("intersect",["list"],({list:m})=>`${m.map(u=>u.toString(!0)).join(" & ")}`),M("transform",["inner","callback","preserve"],({inner:m},u)=>m.toString(u)),e.exports=s}});const Os=Ts();var As=Object.defineProperty,Rs=(n,e)=>As(n,"name",{value:e,configurable:!0}),kr=Symbol("cordis.schema.order"),xs=class{constructor(n){this.ctx=n,Z(this,ze.tracker,{property:"ctx"})}static{Rs(this,"SchemaService")}_data=Os.intersect([]);extend(n,e=0){const t=this._data.list.findIndex(r=>r[kr]<e);return n[kr]=e,this.ctx.effect(()=>(t>=0?this._data.list.splice(t,0,n):this._data.list.push(n),this.ctx.emit("internal/service-schema"),()=>{ye(this._data.list,n),this.ctx.emit("internal/service-schema")}))}toJSON(){return this._data.toJSON()}},Us=Object.defineProperty,Ut=(n,e)=>Us(n,"name",{value:e,configurable:!0}),Bs=class extends ze{static{Ut(this,"TimerService")}constructor(n){super(n,"timer",!0),n.mixin("timer",["setTimeout","setInterval","sleep","throttle","debounce"])}setTimeout(n,e){const t=this[Q.current].effect(()=>{const r=setTimeout(()=>{t(),n()},e);return()=>clearTimeout(r)});return t}setInterval(n,e){return this[Q.current].effect(()=>{const t=setInterval(n,e);return()=>clearInterval(t)})}sleep(n){const e=this[Q.current];return new Promise((t,r)=>{const i=this.setTimeout(()=>{i(),s(),t()},n),s=e.on("dispose",()=>{i(),s(),r(new Error("Context has been disposed"))})})}createWrapper(n,e=!1){const t=this[Q.current];t.scope.assertActive();let r;const i=Ut(()=>{e=!0,ye(t.scope.disposables,i),clearTimeout(r)},"dispose"),s=Ut((...o)=>{clearTimeout(r),r=n(o,()=>!e&&t.scope.isActive)},"wrapper");return s.dispose=i,t.scope.disposables.push(i),s}throttle(n,e,t){let r=-1/0;const i=Ut((...s)=>{r=Date.now(),n(...s)},"execute");return this.createWrapper((s,o)=>{const a=Date.now(),l=e-(a-r);if(l<=0)i(...s);else if(o())return setTimeout(i,l,...s)},t)}debounce(n,e){return this.createWrapper((t,r)=>{if(r())return setTimeout(n,e,...t)})}},Ms=Object.defineProperty,Nn=(n,e)=>Ms(n,"name",{value:e,configurable:!0}),En=class extends Q{static{Nn(this,"Context")}baseDir;constructor(n){super(n),this.baseDir=globalThis.process?.cwd?.()||"",this.provide("logger",void 0,!0),this.provide("timer",void 0,!0),this.plugin(is),this.plugin(Bs)}},Bt=class extends ze{static{Nn(this,"Service")}logger;schema;constructor(...n){super(...n),this.logger=this.ctx.logger(this.name),this.schema=new xs(this.ctx)}[ze.setup](){this.ctx=new En}};function Ds(){}Nn(Ds,"default");var pt={exports:{}},$s=pt.exports,Nr;function Ps(){return Nr||(Nr=1,function(n,e){(function(t,r){var i="1.0.41",s="",o="?",a="function",l="undefined",c="object",h="string",w="major",p="model",g="name",f="type",N="vendor",S="version",M="architecture",m="console",u="mobile",d="tablet",k="smarttv",E="wearable",_="embedded",I=500,B="Amazon",X="Apple",Ze="ASUS",Qe="BlackBerry",Re="Browser",he="Chrome",ee="Edge",Fe="Firefox",Ce="Google",bt="Honor",et="Huawei",Xt="Lenovo",je="LG",tt="Microsoft",wt="Motorola",We="Nvidia",Yt="OnePlus",xe="Opera",kt="OPPO",Ve="Samsung",Zt="Sharp",Ge="Sony",nt="Xiaomi",Nt="Zebra",Qt="Facebook",de="Chromium OS",pe="Mac OS",en=" Browser",tn=function(F,G){var y={};for(var b in F)G[b]&&G[b].length%2===0?y[b]=G[b].concat(F[b]):y[b]=F[b];return y},rt=function(F){for(var G={},y=0;y<F.length;y++)G[F[y].toUpperCase()]=F[y];return G},nn=function(F,G){return typeof F===h?qe(G).indexOf(qe(F))!==-1:!1},qe=function(F){return F.toLowerCase()},Gn=function(F){return typeof F===h?F.replace(/[^\d\.]/g,s).split(".")[0]:r},Et=function(F,G){if(typeof F===h)return F=F.replace(/^\s\s*/,s),typeof G===l?F:F.substring(0,I)},He=function(F,G){for(var y=0,b,L,j,U,T,Y;y<G.length&&!T;){var me=G[y],ie=G[y+1];for(b=L=0;b<me.length&&!T&&me[b];)if(T=me[b++].exec(F),T)for(j=0;j<ie.length;j++)Y=T[++L],U=ie[j],typeof U===c&&U.length>0?U.length===2?typeof U[1]==a?this[U[0]]=U[1].call(this,Y):this[U[0]]=U[1]:U.length===3?typeof U[1]===a&&!(U[1].exec&&U[1].test)?this[U[0]]=Y?U[1].call(this,Y,U[2]):r:this[U[0]]=Y?Y.replace(U[1],U[2]):r:U.length===4&&(this[U[0]]=Y?U[3].call(this,Y.replace(U[1],U[2])):r):this[U]=Y||r;y+=2}},Ue=function(F,G){for(var y in G)if(typeof G[y]===c&&G[y].length>0){for(var b=0;b<G[y].length;b++)if(nn(G[y][b],F))return y===o?r:y}else if(nn(G[y],F))return y===o?r:y;return G.hasOwnProperty("*")?G["*"]:F},qn={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Be={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},it={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[S,[g,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[S,[g,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[g,S],[/opios[\/ ]+([\w\.]+)/i],[S,[g,xe+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[S,[g,xe+" GX"]],[/\bopr\/([\w\.]+)/i],[S,[g,xe]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[S,[g,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[S,[g,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[g,S],[/quark(?:pc)?\/([-\w\.]+)/i],[S,[g,"Quark"]],[/\bddg\/([\w\.]+)/i],[S,[g,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[S,[g,"UC"+Re]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[S,[g,"WeChat"]],[/konqueror\/([\w\.]+)/i],[S,[g,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[S,[g,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[S,[g,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[S,[g,"Smart Lenovo "+Re]],[/(avast|avg)\/([\w\.]+)/i],[[g,/(.+)/,"$1 Secure "+Re],S],[/\bfocus\/([\w\.]+)/i],[S,[g,Fe+" Focus"]],[/\bopt\/([\w\.]+)/i],[S,[g,xe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[S,[g,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[S,[g,"Dolphin"]],[/coast\/([\w\.]+)/i],[S,[g,xe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[S,[g,"MIUI"+en]],[/fxios\/([\w\.-]+)/i],[S,[g,Fe]],[/\bqihoobrowser\/?([\w\.]*)/i],[S,[g,"360"]],[/\b(qq)\/([\w\.]+)/i],[[g,/(.+)/,"$1Browser"],S],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[g,/(.+)/,"$1"+en],S],[/samsungbrowser\/([\w\.]+)/i],[S,[g,Ve+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[S,[g,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[g,"Sogou Mobile"],S],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[g,S],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[g],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[S,g],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[g,Qt],S],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[g,S],[/\bgsa\/([\w\.]+) .*safari\//i],[S,[g,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[S,[g,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[S,[g,he+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[g,he+" WebView"],S],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[S,[g,"Android "+Re]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[g,S],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[S,[g,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[S,g],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[g,[S,Ue,qn]],[/(webkit|khtml)\/([\w\.]+)/i],[g,S],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[g,"Netscape"],S],[/(wolvic|librewolf)\/([\w\.]+)/i],[g,S],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[S,[g,Fe+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[g,[S,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[g,[S,/master.|lts./,""]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[M,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[M,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[M,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[M,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[M,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[M,/ower/,s,qe]],[/ sun4\w[;\)]/i],[[M,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[M,qe]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[N,Ve],[f,d]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[p,[N,Ve],[f,u]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[N,X],[f,u]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[N,X],[f,d]],[/(macintosh);/i],[p,[N,X]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[N,Zt],[f,u]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[p,[N,bt],[f,d]],[/honor([-\w ]+)[;\)]/i],[p,[N,bt],[f,u]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[p,[N,et],[f,d]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[N,et],[f,u]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[p,/_/g," "],[N,nt],[f,d]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[p,/_/g," "],[N,nt],[f,u]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[N,kt],[f,u]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[p,[N,Ue,{OnePlus:["304","403","203"],"*":kt}],[f,d]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[N,"Vivo"],[f,u]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[p,[N,"Realme"],[f,u]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[N,wt],[f,u]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[N,wt],[f,d]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[N,je],[f,d]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv|watch)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[N,je],[f,u]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[p,[N,Xt],[f,d]],[/(nokia) (t[12][01])/i],[N,p,[f,d]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[p,/_/g," "],[f,u],[N,"Nokia"]],[/(pixel (c|tablet))\b/i],[p,[N,Ce],[f,d]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[N,Ce],[f,u]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[N,Ge],[f,u]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[N,Ge],[f,d]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[N,Yt],[f,u]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[N,B],[f,d]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[N,B],[f,u]],[/(playbook);[-\w\),; ]+(rim)/i],[p,N,[f,d]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[N,Qe],[f,u]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[N,Ze],[f,d]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[N,Ze],[f,u]],[/(nexus 9)/i],[p,[N,"HTC"],[f,d]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[N,[p,/_/g," "],[f,u]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[p,[N,"TCL"],[f,d]],[/(itel) ((\w+))/i],[[N,qe],p,[f,Ue,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[N,"Acer"],[f,d]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[N,"Meizu"],[f,u]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[p,[N,"Ulefone"],[f,u]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[p,[N,"Energizer"],[f,u]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[p,[N,"Cat"],[f,u]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[p,[N,"Smartfren"],[f,u]],[/droid.+; (a(?:015|06[35]|142p?))/i],[p,[N,"Nothing"],[f,u]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[p,[N,"Archos"],[f,d]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[p,[N,"Archos"],[f,u]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[N,p,[f,d]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (hmd|imo) ([\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[N,p,[f,u]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[N,p,[f,d]],[/(surface duo)/i],[p,[N,tt],[f,d]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[N,"Fairphone"],[f,u]],[/(u304aa)/i],[p,[N,"AT&T"],[f,u]],[/\bsie-(\w*)/i],[p,[N,"Siemens"],[f,u]],[/\b(rct\w+) b/i],[p,[N,"RCA"],[f,d]],[/\b(venue[\d ]{2,7}) b/i],[p,[N,"Dell"],[f,d]],[/\b(q(?:mv|ta)\w+) b/i],[p,[N,"Verizon"],[f,d]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[N,"Barnes & Noble"],[f,d]],[/\b(tm\d{3}\w+) b/i],[p,[N,"NuVision"],[f,d]],[/\b(k88) b/i],[p,[N,"ZTE"],[f,d]],[/\b(nx\d{3}j) b/i],[p,[N,"ZTE"],[f,u]],[/\b(gen\d{3}) b.+49h/i],[p,[N,"Swiss"],[f,u]],[/\b(zur\d{3}) b/i],[p,[N,"Swiss"],[f,d]],[/\b((zeki)?tb.*\b) b/i],[p,[N,"Zeki"],[f,d]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[N,"Dragon Touch"],p,[f,d]],[/\b(ns-?\w{0,9}) b/i],[p,[N,"Insignia"],[f,d]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[N,"NextBook"],[f,d]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[N,"Voice"],p,[f,u]],[/\b(lvtel\-)?(v1[12]) b/i],[[N,"LvTel"],p,[f,u]],[/\b(ph-1) /i],[p,[N,"Essential"],[f,u]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[N,"Envizen"],[f,d]],[/\b(trio[-\w\. ]+) b/i],[p,[N,"MachSpeed"],[f,d]],[/\btu_(1491) b/i],[p,[N,"Rotor"],[f,d]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[p,[N,We],[f,d]],[/(sprint) (\w+)/i],[N,p,[f,u]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[N,tt],[f,u]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[N,Nt],[f,d]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[N,Nt],[f,u]],[/smart-tv.+(samsung)/i],[N,[f,k]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[N,Ve],[f,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[N,je],[f,k]],[/(apple) ?tv/i],[N,[p,X+" TV"],[f,k]],[/crkey/i],[[p,he+"cast"],[N,Ce],[f,k]],[/droid.+aft(\w+)( bui|\))/i],[p,[N,B],[f,k]],[/(shield \w+ tv)/i],[p,[N,We],[f,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[N,Zt],[f,k]],[/(bravia[\w ]+)( bui|\))/i],[p,[N,Ge],[f,k]],[/(mi(tv|box)-?\w+) bui/i],[p,[N,nt],[f,k]],[/Hbbtv.*(technisat) (.*);/i],[N,p,[f,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[N,Et],[p,Et],[f,k]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[p,[f,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[N,p,[f,m]],[/droid.+; (shield)( bui|\))/i],[p,[N,We],[f,m]],[/(playstation \w+)/i],[p,[N,Ge],[f,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[N,tt],[f,m]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[p,[N,Ve],[f,E]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[N,p,[f,E]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[p,[N,kt],[f,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[N,X],[f,E]],[/(opwwe\d{3})/i],[p,[N,Yt],[f,E]],[/(moto 360)/i],[p,[N,wt],[f,E]],[/(smartwatch 3)/i],[p,[N,Ge],[f,E]],[/(g watch r)/i],[p,[N,je],[f,E]],[/droid.+; (wt63?0{2,3})\)/i],[p,[N,Nt],[f,E]],[/droid.+; (glass) \d/i],[p,[N,Ce],[f,E]],[/(pico) (4|neo3(?: link|pro)?)/i],[N,p,[f,E]],[/; (quest( \d| pro)?)/i],[p,[N,Qt],[f,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[N,[f,_]],[/(aeobc)\b/i],[p,[N,B],[f,_]],[/(homepod).+mac os/i],[p,[N,X],[f,_]],[/windows iot/i],[[f,_]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[p,[f,u]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[f,d]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,d]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,u]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[p,[N,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[S,[g,ee+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[g,S],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[S,[g,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[g,S],[/ladybird\//i],[[g,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[S,g]],os:[[/microsoft (windows) (vista|xp)/i],[g,S],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[g,[S,Ue,Be]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[S,Ue,Be],[g,"Windows"]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[S,/_/g,"."],[g,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[g,pe],[S,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[S,g],[/(ubuntu) ([\w\.]+) like android/i],[[g,/(.+)/,"$1 Touch"],S],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/; ]?([\d\.]*)/i],[g,S],[/\(bb(10);/i],[S,[g,Qe]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[S,[g,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[S,[g,Fe+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[S,[g,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[S,[g,"watchOS"]],[/crkey\/([\d\.]+)/i],[S,[g,he+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[g,de],S],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[g,S],[/(sunos) ?([\w\.\d]*)/i],[[g,"Solaris"],S],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[g,S]]},oe=function(F,G){if(typeof F===c&&(G=F,F=r),!(this instanceof oe))return new oe(F,G).getResult();var y=typeof t!==l&&t.navigator?t.navigator:r,b=F||(y&&y.userAgent?y.userAgent:s),L=y&&y.userAgentData?y.userAgentData:r,j=G?tn(it,G):it,U=y&&y.userAgent==b;return this.getBrowser=function(){var T={};return T[g]=r,T[S]=r,He.call(T,b,j.browser),T[w]=Gn(T[S]),U&&y&&y.brave&&typeof y.brave.isBrave==a&&(T[g]="Brave"),T},this.getCPU=function(){var T={};return T[M]=r,He.call(T,b,j.cpu),T},this.getDevice=function(){var T={};return T[N]=r,T[p]=r,T[f]=r,He.call(T,b,j.device),U&&!T[f]&&L&&L.mobile&&(T[f]=u),U&&T[p]=="Macintosh"&&y&&typeof y.standalone!==l&&y.maxTouchPoints&&y.maxTouchPoints>2&&(T[p]="iPad",T[f]=d),T},this.getEngine=function(){var T={};return T[g]=r,T[S]=r,He.call(T,b,j.engine),T},this.getOS=function(){var T={};return T[g]=r,T[S]=r,He.call(T,b,j.os),U&&!T[g]&&L&&L.platform&&L.platform!="Unknown"&&(T[g]=L.platform.replace(/chrome os/i,de).replace(/macos/i,pe)),T},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return b},this.setUA=function(T){return b=typeof T===h&&T.length>I?Et(T,I):T,this},this.setUA(b),this};oe.VERSION=i,oe.BROWSER=rt([g,S,w]),oe.CPU=rt([M]),oe.DEVICE=rt([p,N,f,m,u,k,d,E,_]),oe.ENGINE=oe.OS=rt([g,S]),n.exports&&(e=n.exports=oe),e.UAParser=oe;var Me=typeof t!==l&&(t.jQuery||t.Zepto);if(Me&&!Me.ua){var st=new oe;Me.ua=st.getResult(),Me.ua.get=function(){return st.getUA()},Me.ua.set=function(F){st.setUA(F);var G=st.getResult();for(var y in G)Me.ua[y]=G[y]}}})(typeof window=="object"?window:$s)}(pt,pt.exports)),pt.exports}var Ls=Ps();const Fs=lr(Ls);class Cs extends Bt{uaInfo=new Fs(navigator.userAgent).getResult();hasTouchPoints="ontouchstart"in document&&(navigator.maxTouchPoints||0)>0;constructor(e){super(e,"device")}get isPhone(){return this.uaInfo.device.type==="mobile"||this.uaInfo.device.type==="wearable"}get isTablet(){return this.uaInfo.device.type==="tablet"||this.uaInfo.device.type==="console"}get isMobile(){return this.isPhone||this.isTablet||this.hasTouchPoints}get isMobileStricted(){return this.isMobile&&navigator.platform!=="Win32"}get isIOS(){return this.uaInfo.os.name==="iOS"||this.uaInfo.device.vendor==="Apple"&&this.hasTouchPoints||["iPhone","iPod","iPad"].includes(navigator.platform)||navigator.platform==="MacIntel"&&this.hasTouchPoints}get isAndroid(){return["Android","HarmonyOS"].includes(this.uaInfo.os.name||"__UNKNOWN__")}currentDeviceTypes(){const e=[];return this.isMobile&&e.push("mobile"),this.isPhone&&e.push("phone"),this.isTablet&&e.push("tablet"),this.isIOS&&e.push("ios"),this.isAndroid&&e.push("android"),e.length||e.push("desktop"),e.push("all"),e}matchDevice(e){return e.device==="all"?!0:this.currentDeviceTypes().includes(e.device)}}var _n=(n=>(n.all="all",n.mainland="mainland",n.oversea="oversea",n))(_n||{});function js(n=1500){return Promise.race([fetch("https://discovery.googleapis.com/discovery/v1/apis?name=0").then(()=>!1).catch(()=>!0),new Promise(e=>setTimeout(()=>{e(!0)},n))])}class Ws extends Bt{constructor(e){super(e,"region",!1),this.ctx=e}_region;_regionWorker;async start(){await this.init()}async init(){if(this._region)return this._region;this._regionWorker||(this._regionWorker=js());const e=await this._regionWorker;return this._region=e?_n.mainland:_n.oversea,this._region}regionName(){const e=this._region;if(!e)throw new TypeError("[RegionService] the region has not been initialized");return e}checkRegion(e){return[null,void 0,"","*","all"].includes(e.region)?!0:e.region===this.regionName()}}function vn(n){let e=typeof n;if(e=="object"){if(Array.isArray(n))return"array";if(n===null)return"null"}return e}function Vs(n){return n!==null&&typeof n=="object"&&!Array.isArray(n)}let _e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Mt=[];for(let n=0;n<_e.length;n++)Mt[_e[n].charCodeAt(0)]=n;Mt[45]=_e.indexOf("+"),Mt[95]=_e.indexOf("/");function Er(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),r=0,i=0,s,o=0;for(let a=0;a<n.length;a++){if(s=Mt[n.charCodeAt(a)],s===void 0)switch(n[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=s,i=1;break;case 1:t[r++]=o<<2|(s&48)>>4,o=s,i=2;break;case 2:t[r++]=(o&15)<<4|(s&60)>>2,o=s,i=3;break;case 3:t[r++]=(o&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return t.subarray(0,r)}function _r(n){let e="",t=0,r,i=0;for(let s=0;s<n.length;s++)switch(r=n[s],t){case 0:e+=_e[r>>2],i=(r&3)<<4,t=1;break;case 1:e+=_e[i|r>>4],i=(r&15)<<2,t=2;break;case 2:e+=_e[i|r>>6],e+=_e[r&63],t=0;break}return t&&(e+=_e[i],e+="=",t==1&&(e+="=")),e}var x;(function(n){n.symbol=Symbol.for("protobuf-ts/unknown"),n.onRead=(t,r,i,s,o)=>{(e(r)?r[n.symbol]:r[n.symbol]=[]).push({no:i,wireType:s,data:o})},n.onWrite=(t,r,i)=>{for(let{no:s,wireType:o,data:a}of n.list(r))i.tag(s,o).raw(a)},n.list=(t,r)=>{if(e(t)){let i=t[n.symbol];return r?i.filter(s=>s.no==r):i}return[]},n.last=(t,r)=>n.list(t,r).slice(-1)[0];const e=t=>t&&Array.isArray(t[n.symbol])})(x||(x={}));function Gs(n,e){return Object.assign(Object.assign({},n),e)}var O;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(O||(O={}));function qs(){let n=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(n|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,(t&128)==0)return this.assertBounds(),[n,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,(i&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function Sn(n,e,t){for(let s=0;s<28;s=s+7){const o=n>>>s,a=!(!(o>>>7)&&e==0),l=(a?o|128:o)&255;if(t.push(l),!a)return}const r=n>>>28&15|(e&7)<<4,i=e>>3!=0;if(t.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const o=e>>>s,a=!!(o>>>7),l=(a?o|128:o)&255;if(t.push(l),!a)return}t.push(e>>>31&1)}}const Dt=65536*65536;function vr(n){let e=n[0]=="-";e&&(n=n.slice(1));const t=1e6;let r=0,i=0;function s(o,a){const l=Number(n.slice(o,a));i*=t,r=r*t+l,r>=Dt&&(i=i+(r/Dt|0),r=r%Dt)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),[e,r,i]}function In(n,e){if(e>>>0<=2097151)return""+(Dt*e+(n>>>0));let t=n&16777215,r=(n>>>24|e<<8)>>>0&16777215,i=e>>16&65535,s=t+r*6777216+i*6710656,o=r+i*8147497,a=i*2,l=1e7;s>=l&&(o+=Math.floor(s/l),s%=l),o>=l&&(a+=Math.floor(o/l),o%=l);function c(h,w){let p=h?String(h):"";return w?"0000000".slice(p.length)+p:p}return c(a,0)+c(o,a)+c(s,1)}function Sr(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function Hs(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;(n&128)!==0&&t<10;t++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}let K;function Ks(){const n=new DataView(new ArrayBuffer(8));K=globalThis.BigInt!==void 0&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:n}:void 0}Ks();function Ir(n){if(!n)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}const Tr=/^-?[0-9]+$/,$t=4294967296,Pt=2147483648;class Or{constructor(e,t){this.lo=e|0,this.hi=t|0}isZero(){return this.lo==0&&this.hi==0}toNumber(){let e=this.hi*$t+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class re extends Or{static from(e){if(K)switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=="")throw new Error("string is no integer");e=K.C(e);case"number":if(e===0)return this.ZERO;e=K.C(e);case"bigint":if(!e)return this.ZERO;if(e<K.UMIN)throw new Error("signed value for ulong");if(e>K.UMAX)throw new Error("ulong too large");return K.V.setBigUint64(0,e,!0),new re(K.V.getInt32(0,!0),K.V.getInt32(4,!0))}else switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=e.trim(),!Tr.test(e))throw new Error("string is no integer");let[t,r,i]=vr(e);if(t)throw new Error("signed value for ulong");return new re(r,i);case"number":if(e==0)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new re(e,e/$t)}throw new Error("unknown value "+typeof e)}toString(){return K?this.toBigInt().toString():In(this.lo,this.hi)}toBigInt(){return Ir(K),K.V.setInt32(0,this.lo,!0),K.V.setInt32(4,this.hi,!0),K.V.getBigUint64(0,!0)}}re.ZERO=new re(0,0);class J extends Or{static from(e){if(K)switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=="")throw new Error("string is no integer");e=K.C(e);case"number":if(e===0)return this.ZERO;e=K.C(e);case"bigint":if(!e)return this.ZERO;if(e<K.MIN)throw new Error("signed long too small");if(e>K.MAX)throw new Error("signed long too large");return K.V.setBigInt64(0,e,!0),new J(K.V.getInt32(0,!0),K.V.getInt32(4,!0))}else switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=e.trim(),!Tr.test(e))throw new Error("string is no integer");let[t,r,i]=vr(e);if(t){if(i>Pt||i==Pt&&r!=0)throw new Error("signed long too small")}else if(i>=Pt)throw new Error("signed long too large");let s=new J(r,i);return t?s.negate():s;case"number":if(e==0)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new J(e,e/$t):new J(-e,-e/$t).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return(this.hi&Pt)!==0}negate(){let e=~this.hi,t=this.lo;return t?t=~t+1:e+=1,new J(t,e)}toString(){if(K)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+In(e.lo,e.hi)}return In(this.lo,this.hi)}toBigInt(){return Ir(K),K.V.setInt32(0,this.lo,!0),K.V.setInt32(4,this.hi,!0),K.V.getBigInt64(0,!0)}}J.ZERO=new J(0,0);const Ar={readUnknownField:!0,readerFactory:n=>new Js(n)};function zs(n){return n?Object.assign(Object.assign({},Ar),n):Ar}class Js{constructor(e,t){this.varint64=qs,this.uint32=Hs,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),t=e>>>3,r=e&7;if(t<=0||r<0||r>5)throw new Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e){let t=this.pos;switch(e){case O.Varint:for(;this.buf[this.pos++]&128;);break;case O.Bit64:this.pos+=4;case O.Bit32:this.pos+=4;break;case O.LengthDelimited:let r=this.uint32();this.pos+=r;break;case O.StartGroup:let i;for(;(i=this.tag()[1])!==O.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return new J(...this.varint64())}uint64(){return new re(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(e&1);return e=(e>>>1|(t&1)<<31)^r,t=t>>>1^r,new J(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new re(this.sfixed32(),this.sfixed32())}sfixed64(){return new J(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function C(n,e){if(!n)throw new Error(e)}const Xs=34028234663852886e22,Ys=-34028234663852886e22,Zs=4294967295,Qs=2147483647,eo=-2147483648;function mt(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>Qs||n<eo)throw new Error("invalid int 32: "+n)}function Lt(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>Zs||n<0)throw new Error("invalid uint 32: "+n)}function Tn(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>Xs||n<Ys))throw new Error("invalid float 32: "+n)}const Rr={writeUnknownFields:!0,writerFactory:()=>new no};function to(n){return n?Object.assign(Object.assign({},Rr),n):Rr}class no{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Lt(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return mt(e),Sr(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Tn(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Lt(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){mt(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return mt(e),e=(e<<1^e>>31)>>>0,Sr(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=J.from(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),i=re.from(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=J.from(e);return Sn(t.lo,t.hi,this.buf),this}sint64(e){let t=J.from(e),r=t.hi>>31,i=t.lo<<1^r,s=(t.hi<<1|t.lo>>>31)^r;return Sn(i,s,this.buf),this}uint64(e){let t=re.from(e);return Sn(t.lo,t.hi,this.buf),this}}const xr={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},Ur={ignoreUnknownFields:!1};function ro(n){return n?Object.assign(Object.assign({},Ur),n):Ur}function io(n){return n?Object.assign(Object.assign({},xr),n):xr}function so(n,e){var t,r;let i=Object.assign(Object.assign({},n),e);return i.typeRegistry=[...(t=n?.typeRegistry)!==null&&t!==void 0?t:[],...(r=e?.typeRegistry)!==null&&r!==void 0?r:[]],i}const Br=Symbol.for("protobuf-ts/message-type");function On(n){let e=!1;const t=[];for(let r=0;r<n.length;r++){let i=n.charAt(r);i=="_"?e=!0:/\d/.test(i)?(t.push(i),e=!0):e?(t.push(i.toUpperCase()),e=!1):r==0?t.push(i.toLowerCase()):t.push(i)}return t.join("")}var v;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})(v||(v={}));var ke;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING",n[n.NUMBER=2]="NUMBER"})(ke||(ke={}));var Ft;(function(n){n[n.NO=0]="NO",n[n.PACKED=1]="PACKED",n[n.UNPACKED=2]="UNPACKED"})(Ft||(Ft={}));function oo(n){var e,t,r,i;return n.localName=(e=n.localName)!==null&&e!==void 0?e:On(n.name),n.jsonName=(t=n.jsonName)!==null&&t!==void 0?t:On(n.name),n.repeat=(r=n.repeat)!==null&&r!==void 0?r:Ft.NO,n.opt=(i=n.opt)!==null&&i!==void 0?i:n.repeat||n.oneof?!1:n.kind=="message",n}function ao(n){if(typeof n!="object"||n===null||!n.hasOwnProperty("oneofKind"))return!1;switch(typeof n.oneofKind){case"string":return n[n.oneofKind]===void 0?!1:Object.keys(n).length==2;case"undefined":return Object.keys(n).length==1;default:return!1}}class lo{constructor(e){var t;this.fields=(t=e.fields)!==null&&t!==void 0?t:[]}prepare(){if(this.data)return;const e=[],t=[],r=[];for(let i of this.fields)if(i.oneof)r.includes(i.oneof)||(r.push(i.oneof),e.push(i.oneof),t.push(i.oneof));else switch(t.push(i.localName),i.kind){case"scalar":case"enum":(!i.opt||i.repeat)&&e.push(i.localName);break;case"message":i.repeat&&e.push(i.localName);break;case"map":e.push(i.localName);break}this.data={req:e,known:t,oneofs:Object.values(r)}}is(e,t,r=!1){if(t<0)return!0;if(e==null||typeof e!="object")return!1;this.prepare();let i=Object.keys(e),s=this.data;if(i.length<s.req.length||s.req.some(o=>!i.includes(o))||!r&&i.some(o=>!s.known.includes(o)))return!1;if(t<1)return!0;for(const o of s.oneofs){const a=e[o];if(!ao(a))return!1;if(a.oneofKind===void 0)continue;const l=this.fields.find(c=>c.localName===a.oneofKind);if(!l||!this.field(a[a.oneofKind],l,r,t))return!1}for(const o of this.fields)if(o.oneof===void 0&&!this.field(e[o.localName],o,r,t))return!1;return!0}field(e,t,r,i){let s=t.repeat;switch(t.kind){case"scalar":return e===void 0?t.opt:s?this.scalars(e,t.T,i,t.L):this.scalar(e,t.T,t.L);case"enum":return e===void 0?t.opt:s?this.scalars(e,v.INT32,i):this.scalar(e,v.INT32);case"message":return e===void 0?!0:s?this.messages(e,t.T(),r,i):this.message(e,t.T(),r,i);case"map":if(typeof e!="object"||e===null)return!1;if(i<2)return!0;if(!this.mapKeys(e,t.K,i))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,i,t.V.L);case"enum":return this.scalars(Object.values(e),v.INT32,i);case"message":return this.messages(Object.values(e),t.V.T(),r,i)}break}return!0}message(e,t,r,i){return r?t.isAssignable(e,i):t.is(e,i)}messages(e,t,r,i){if(!Array.isArray(e))return!1;if(i<2)return!0;if(r){for(let s=0;s<e.length&&s<i;s++)if(!t.isAssignable(e[s],i-1))return!1}else for(let s=0;s<e.length&&s<i;s++)if(!t.is(e[s],i-1))return!1;return!0}scalar(e,t,r){let i=typeof e;switch(t){case v.UINT64:case v.FIXED64:case v.INT64:case v.SFIXED64:case v.SINT64:switch(r){case ke.BIGINT:return i=="bigint";case ke.NUMBER:return i=="number"&&!isNaN(e);default:return i=="string"}case v.BOOL:return i=="boolean";case v.STRING:return i=="string";case v.BYTES:return e instanceof Uint8Array;case v.DOUBLE:case v.FLOAT:return i=="number"&&!isNaN(e);default:return i=="number"&&Number.isInteger(e)}}scalars(e,t,r,i){if(!Array.isArray(e))return!1;if(r<2)return!0;if(Array.isArray(e)){for(let s=0;s<e.length&&s<r;s++)if(!this.scalar(e[s],t,i))return!1}return!0}mapKeys(e,t,r){let i=Object.keys(e);switch(t){case v.INT32:case v.FIXED32:case v.SFIXED32:case v.SINT32:case v.UINT32:return this.scalars(i.slice(0,r).map(s=>parseInt(s)),t,r);case v.BOOL:return this.scalars(i.slice(0,r).map(s=>s=="true"?!0:s=="false"?!1:s),t,r);default:return this.scalars(i,t,r,ke.STRING)}}}function ue(n,e){switch(e){case ke.BIGINT:return n.toBigInt();case ke.NUMBER:return n.toNumber();default:return n.toString()}}class co{constructor(e){this.info=e}prepare(){var e;if(this.fMap===void 0){this.fMap={};const t=(e=this.info.fields)!==null&&e!==void 0?e:[];for(const r of t)this.fMap[r.name]=r,this.fMap[r.jsonName]=r,this.fMap[r.localName]=r}}assert(e,t,r){if(!e){let i=vn(r);throw(i=="number"||i=="boolean")&&(i=r.toString()),new Error(`Cannot parse JSON ${i} for ${this.info.typeName}#${t}`)}}read(e,t,r){this.prepare();const i=[];for(const[s,o]of Object.entries(e)){const a=this.fMap[s];if(!a){if(!r.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${s}`);continue}const l=a.localName;let c;if(a.oneof){if(o===null&&(a.kind!=="enum"||a.T()[0]!=="google.protobuf.NullValue"))continue;if(i.includes(a.oneof))throw new Error(`Multiple members of the oneof group "${a.oneof}" of ${this.info.typeName} are present in JSON.`);i.push(a.oneof),c=t[a.oneof]={oneofKind:l}}else c=t;if(a.kind=="map"){if(o===null)continue;this.assert(Vs(o),a.name,o);const h=c[l];for(const[w,p]of Object.entries(o)){this.assert(p!==null,a.name+" map value",null);let g;switch(a.V.kind){case"message":g=a.V.T().internalJsonRead(p,r);break;case"enum":if(g=this.enum(a.V.T(),p,a.name,r.ignoreUnknownFields),g===!1)continue;break;case"scalar":g=this.scalar(p,a.V.T,a.V.L,a.name);break}this.assert(g!==void 0,a.name+" map value",p);let f=w;a.K==v.BOOL&&(f=f=="true"?!0:f=="false"?!1:f),f=this.scalar(f,a.K,ke.STRING,a.name).toString(),h[f]=g}}else if(a.repeat){if(o===null)continue;this.assert(Array.isArray(o),a.name,o);const h=c[l];for(const w of o){this.assert(w!==null,a.name,null);let p;switch(a.kind){case"message":p=a.T().internalJsonRead(w,r);break;case"enum":if(p=this.enum(a.T(),w,a.name,r.ignoreUnknownFields),p===!1)continue;break;case"scalar":p=this.scalar(w,a.T,a.L,a.name);break}this.assert(p!==void 0,a.name,o),h.push(p)}}else switch(a.kind){case"message":if(o===null&&a.T().typeName!="google.protobuf.Value"){this.assert(a.oneof===void 0,a.name+" (oneof member)",null);continue}c[l]=a.T().internalJsonRead(o,r,c[l]);break;case"enum":if(o===null)continue;let h=this.enum(a.T(),o,a.name,r.ignoreUnknownFields);if(h===!1)continue;c[l]=h;break;case"scalar":if(o===null)continue;c[l]=this.scalar(o,a.T,a.L,a.name);break}}}enum(e,t,r,i){if(e[0]=="google.protobuf.NullValue"&&C(t===null||t==="NULL_VALUE",`Unable to parse field ${this.info.typeName}#${r}, enum ${e[0]} only accepts null.`),t===null)return 0;switch(typeof t){case"number":return C(Number.isInteger(t),`Unable to parse field ${this.info.typeName}#${r}, enum can only be integral number, got ${t}.`),t;case"string":let s=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(s=t.substring(e[2].length));let o=e[1][s];return typeof o>"u"&&i?!1:(C(typeof o=="number",`Unable to parse field ${this.info.typeName}#${r}, enum ${e[0]} has no value for "${t}".`),o)}C(!1,`Unable to parse field ${this.info.typeName}#${r}, cannot parse enum value from ${typeof t}".`)}scalar(e,t,r,i){let s;try{switch(t){case v.DOUBLE:case v.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""){s="empty string";break}if(typeof e=="string"&&e.trim().length!==e.length){s="extra whitespace";break}if(typeof e!="string"&&typeof e!="number")break;let o=Number(e);if(Number.isNaN(o)){s="not a number";break}if(!Number.isFinite(o)){s="too large or small";break}return t==v.FLOAT&&Tn(o),o;case v.INT32:case v.FIXED32:case v.SFIXED32:case v.SINT32:case v.UINT32:if(e===null)return 0;let a;if(typeof e=="number"?a=e:e===""?s="empty string":typeof e=="string"&&(e.trim().length!==e.length?s="extra whitespace":a=Number(e)),a===void 0)break;return t==v.UINT32?Lt(a):mt(a),a;case v.INT64:case v.SFIXED64:case v.SINT64:if(e===null)return ue(J.ZERO,r);if(typeof e!="number"&&typeof e!="string")break;return ue(J.from(e),r);case v.FIXED64:case v.UINT64:if(e===null)return ue(re.ZERO,r);if(typeof e!="number"&&typeof e!="string")break;return ue(re.from(e),r);case v.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case v.STRING:if(e===null)return"";if(typeof e!="string"){s="extra whitespace";break}try{encodeURIComponent(e)}catch(l){l="invalid UTF8";break}return e;case v.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return Er(e)}}catch(o){s=o.message}this.assert(!1,i+(s?" - "+s:""),e)}}class uo{constructor(e){var t;this.fields=(t=e.fields)!==null&&t!==void 0?t:[]}write(e,t){const r={},i=e;for(const s of this.fields){if(!s.oneof){let c=this.field(s,i[s.localName],t);c!==void 0&&(r[t.useProtoFieldName?s.name:s.jsonName]=c);continue}const o=i[s.oneof];if(o.oneofKind!==s.localName)continue;const a=s.kind=="scalar"||s.kind=="enum"?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t;let l=this.field(s,o[s.localName],a);C(l!==void 0),r[t.useProtoFieldName?s.name:s.jsonName]=l}return r}field(e,t,r){let i;if(e.kind=="map"){C(typeof t=="object"&&t!==null);const s={};switch(e.V.kind){case"scalar":for(const[l,c]of Object.entries(t)){const h=this.scalar(e.V.T,c,e.name,!1,!0);C(h!==void 0),s[l.toString()]=h}break;case"message":const o=e.V.T();for(const[l,c]of Object.entries(t)){const h=this.message(o,c,e.name,r);C(h!==void 0),s[l.toString()]=h}break;case"enum":const a=e.V.T();for(const[l,c]of Object.entries(t)){C(c===void 0||typeof c=="number");const h=this.enum(a,c,e.name,!1,!0,r.enumAsInteger);C(h!==void 0),s[l.toString()]=h}break}(r.emitDefaultValues||Object.keys(s).length>0)&&(i=s)}else if(e.repeat){C(Array.isArray(t));const s=[];switch(e.kind){case"scalar":for(let l=0;l<t.length;l++){const c=this.scalar(e.T,t[l],e.name,e.opt,!0);C(c!==void 0),s.push(c)}break;case"enum":const o=e.T();for(let l=0;l<t.length;l++){C(t[l]===void 0||typeof t[l]=="number");const c=this.enum(o,t[l],e.name,e.opt,!0,r.enumAsInteger);C(c!==void 0),s.push(c)}break;case"message":const a=e.T();for(let l=0;l<t.length;l++){const c=this.message(a,t[l],e.name,r);C(c!==void 0),s.push(c)}break}(r.emitDefaultValues||s.length>0||r.emitDefaultValues)&&(i=s)}else switch(e.kind){case"scalar":i=this.scalar(e.T,t,e.name,e.opt,r.emitDefaultValues);break;case"enum":i=this.enum(e.T(),t,e.name,e.opt,r.emitDefaultValues,r.enumAsInteger);break;case"message":i=this.message(e.T(),t,e.name,r);break}return i}enum(e,t,r,i,s,o){if(e[0]=="google.protobuf.NullValue")return!s&&!i?void 0:null;if(t===void 0){C(i);return}if(!(t===0&&!s&&!i))return C(typeof t=="number"),C(Number.isInteger(t)),o||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}message(e,t,r,i){return t===void 0?i.emitDefaultValues?null:void 0:e.internalJsonWrite(t,i)}scalar(e,t,r,i,s){if(t===void 0){C(i);return}const o=s||i;switch(e){case v.INT32:case v.SFIXED32:case v.SINT32:return t===0?o?0:void 0:(mt(t),t);case v.FIXED32:case v.UINT32:return t===0?o?0:void 0:(Lt(t),t);case v.FLOAT:Tn(t);case v.DOUBLE:return t===0?o?0:void 0:(C(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case v.STRING:return t===""?o?"":void 0:(C(typeof t=="string"),t);case v.BOOL:return t===!1?o?!1:void 0:(C(typeof t=="boolean"),t);case v.UINT64:case v.FIXED64:C(typeof t=="number"||typeof t=="string"||typeof t=="bigint");let a=re.from(t);return a.isZero()&&!o?void 0:a.toString();case v.INT64:case v.SFIXED64:case v.SINT64:C(typeof t=="number"||typeof t=="string"||typeof t=="bigint");let l=J.from(t);return l.isZero()&&!o?void 0:l.toString();case v.BYTES:return C(t instanceof Uint8Array),t.byteLength?_r(t):o?"":void 0}}}function An(n,e=ke.STRING){switch(n){case v.BOOL:return!1;case v.UINT64:case v.FIXED64:return ue(re.ZERO,e);case v.INT64:case v.SFIXED64:case v.SINT64:return ue(J.ZERO,e);case v.DOUBLE:case v.FLOAT:return 0;case v.BYTES:return new Uint8Array(0);case v.STRING:return"";default:return 0}}class fo{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const t=(e=this.info.fields)!==null&&e!==void 0?e:[];this.fieldNoToField=new Map(t.map(r=>[r.no,r]))}}read(e,t,r,i){this.prepare();const s=i===void 0?e.len:e.pos+i;for(;e.pos<s;){const[o,a]=e.tag(),l=this.fieldNoToField.get(o);if(!l){let p=r.readUnknownField;if(p=="throw")throw new Error(`Unknown field ${o} (wire type ${a}) for ${this.info.typeName}`);let g=e.skip(a);p!==!1&&(p===!0?x.onRead:p)(this.info.typeName,t,o,a,g);continue}let c=t,h=l.repeat,w=l.localName;switch(l.oneof&&(c=c[l.oneof],c.oneofKind!==w&&(c=t[l.oneof]={oneofKind:w})),l.kind){case"scalar":case"enum":let p=l.kind=="enum"?v.INT32:l.T,g=l.kind=="scalar"?l.L:void 0;if(h){let S=c[w];if(a==O.LengthDelimited&&p!=v.STRING&&p!=v.BYTES){let M=e.uint32()+e.pos;for(;e.pos<M;)S.push(this.scalar(e,p,g))}else S.push(this.scalar(e,p,g))}else c[w]=this.scalar(e,p,g);break;case"message":if(h){let S=c[w],M=l.T().internalBinaryRead(e,e.uint32(),r);S.push(M)}else c[w]=l.T().internalBinaryRead(e,e.uint32(),r,c[w]);break;case"map":let[f,N]=this.mapEntry(l,e,r);c[w][f]=N;break}}}mapEntry(e,t,r){let i=t.uint32(),s=t.pos+i,o,a;for(;t.pos<s;){let[l,c]=t.tag();switch(l){case 1:e.K==v.BOOL?o=t.bool().toString():o=this.scalar(t,e.K,ke.STRING);break;case 2:switch(e.V.kind){case"scalar":a=this.scalar(t,e.V.T,e.V.L);break;case"enum":a=t.int32();break;case"message":a=e.V.T().internalBinaryRead(t,t.uint32(),r);break}break;default:throw new Error(`Unknown field ${l} (wire type ${c}) in map entry for ${this.info.typeName}#${e.name}`)}}if(o===void 0){let l=An(e.K);o=e.K==v.BOOL?l.toString():l}if(a===void 0)switch(e.V.kind){case"scalar":a=An(e.V.T,e.V.L);break;case"enum":a=0;break;case"message":a=e.V.T().create();break}return[o,a]}scalar(e,t,r){switch(t){case v.INT32:return e.int32();case v.STRING:return e.string();case v.BOOL:return e.bool();case v.DOUBLE:return e.double();case v.FLOAT:return e.float();case v.INT64:return ue(e.int64(),r);case v.UINT64:return ue(e.uint64(),r);case v.FIXED64:return ue(e.fixed64(),r);case v.FIXED32:return e.fixed32();case v.BYTES:return e.bytes();case v.UINT32:return e.uint32();case v.SFIXED32:return e.sfixed32();case v.SFIXED64:return ue(e.sfixed64(),r);case v.SINT32:return e.sint32();case v.SINT64:return ue(e.sint64(),r)}}}class ho{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort((t,r)=>t.no-r.no)}}write(e,t,r){this.prepare();for(const s of this.fields){let o,a,l=s.repeat,c=s.localName;if(s.oneof){const h=e[s.oneof];if(h.oneofKind!==c)continue;o=h[c],a=!0}else o=e[c],a=!1;switch(s.kind){case"scalar":case"enum":let h=s.kind=="enum"?v.INT32:s.T;if(l)if(C(Array.isArray(o)),l==Ft.PACKED)this.packed(t,h,s.no,o);else for(const w of o)this.scalar(t,h,s.no,w,!0);else o===void 0?C(s.opt):this.scalar(t,h,s.no,o,a||s.opt);break;case"message":if(l){C(Array.isArray(o));for(const w of o)this.message(t,r,s.T(),s.no,w)}else this.message(t,r,s.T(),s.no,o);break;case"map":C(typeof o=="object"&&o!==null);for(const[w,p]of Object.entries(o))this.mapEntry(t,r,s,w,p);break}}let i=r.writeUnknownFields;i!==!1&&(i===!0?x.onWrite:i)(this.info.typeName,e,t)}mapEntry(e,t,r,i,s){e.tag(r.no,O.LengthDelimited),e.fork();let o=i;switch(r.K){case v.INT32:case v.FIXED32:case v.UINT32:case v.SFIXED32:case v.SINT32:o=Number.parseInt(i);break;case v.BOOL:C(i=="true"||i=="false"),o=i=="true";break}switch(this.scalar(e,r.K,1,o,!0),r.V.kind){case"scalar":this.scalar(e,r.V.T,2,s,!0);break;case"enum":this.scalar(e,v.INT32,2,s,!0);break;case"message":this.message(e,t,r.V.T(),2,s);break}e.join()}message(e,t,r,i,s){s!==void 0&&(r.internalBinaryWrite(s,e.tag(i,O.LengthDelimited).fork(),t),e.join())}scalar(e,t,r,i,s){let[o,a,l]=this.scalarInfo(t,i);(!l||s)&&(e.tag(r,o),e[a](i))}packed(e,t,r,i){if(!i.length)return;C(t!==v.BYTES&&t!==v.STRING),e.tag(r,O.LengthDelimited),e.fork();let[,s]=this.scalarInfo(t);for(let o=0;o<i.length;o++)e[s](i[o]);e.join()}scalarInfo(e,t){let r=O.Varint,i,s=t===void 0,o=t===0;switch(e){case v.INT32:i="int32";break;case v.STRING:o=s||!t.length,r=O.LengthDelimited,i="string";break;case v.BOOL:o=t===!1,i="bool";break;case v.UINT32:i="uint32";break;case v.DOUBLE:r=O.Bit64,i="double";break;case v.FLOAT:r=O.Bit32,i="float";break;case v.INT64:o=s||J.from(t).isZero(),i="int64";break;case v.UINT64:o=s||re.from(t).isZero(),i="uint64";break;case v.FIXED64:o=s||re.from(t).isZero(),r=O.Bit64,i="fixed64";break;case v.BYTES:o=s||!t.byteLength,r=O.LengthDelimited,i="bytes";break;case v.FIXED32:r=O.Bit32,i="fixed32";break;case v.SFIXED32:r=O.Bit32,i="sfixed32";break;case v.SFIXED64:o=s||J.from(t).isZero(),r=O.Bit64,i="sfixed64";break;case v.SINT32:i="sint32";break;case v.SINT64:o=s||J.from(t).isZero(),i="sint64";break}return[r,i,s||o]}}function po(n){const e=n.messagePrototype?Object.create(n.messagePrototype):Object.defineProperty({},Br,{value:n});for(let t of n.fields){let r=t.localName;if(!t.opt)if(t.oneof)e[t.oneof]={oneofKind:void 0};else if(t.repeat)e[r]=[];else switch(t.kind){case"scalar":e[r]=An(t.T,t.L);break;case"enum":e[r]=0;break;case"map":e[r]={};break}}return e}function W(n,e,t){let r,i=t,s;for(let o of n.fields){let a=o.localName;if(o.oneof){const l=i[o.oneof];if(l?.oneofKind==null)continue;if(r=l[a],s=e[o.oneof],s.oneofKind=l.oneofKind,r==null){delete s[a];continue}}else if(r=i[a],s=e,r==null)continue;switch(o.repeat&&(s[a].length=r.length),o.kind){case"scalar":case"enum":if(o.repeat)for(let c=0;c<r.length;c++)s[a][c]=r[c];else s[a]=r;break;case"message":let l=o.T();if(o.repeat)for(let c=0;c<r.length;c++)s[a][c]=l.create(r[c]);else s[a]===void 0?s[a]=l.create(r):l.mergePartial(s[a],r);break;case"map":switch(o.V.kind){case"scalar":case"enum":Object.assign(s[a],r);break;case"message":let c=o.V.T();for(let h of Object.keys(r))s[a][h]=c.create(r[h]);break}break}}}function mo(n,e,t){if(e===t)return!0;if(!e||!t)return!1;for(let r of n.fields){let i=r.localName,s=r.oneof?e[r.oneof][i]:e[i],o=r.oneof?t[r.oneof][i]:t[i];switch(r.kind){case"enum":case"scalar":let a=r.kind=="enum"?v.INT32:r.T;if(!(r.repeat?Dr(a,s,o):Mr(a,s,o)))return!1;break;case"map":if(!(r.V.kind=="message"?$r(r.V.T(),Ct(s),Ct(o)):Dr(r.V.kind=="enum"?v.INT32:r.V.T,Ct(s),Ct(o))))return!1;break;case"message":let l=r.T();if(!(r.repeat?$r(l,s,o):l.equals(s,o)))return!1;break}}return!0}const Ct=Object.values;function Mr(n,e,t){if(e===t)return!0;if(n!==v.BYTES)return!1;let r=e,i=t;if(r.length!==i.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!=i[s])return!1;return!0}function Dr(n,e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Mr(n,e[r],t[r]))return!1;return!0}function $r(n,e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n.equals(e[r],t[r]))return!1;return!0}const Pr=Object.getOwnPropertyDescriptors(Object.getPrototypeOf({})),go=Pr[Br]={};class q{constructor(e,t,r){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(oo),this.options=r??{},go.value=this,this.messagePrototype=Object.create(null,Pr),this.refTypeCheck=new lo(this),this.refJsonReader=new co(this),this.refJsonWriter=new uo(this),this.refBinReader=new fo(this),this.refBinWriter=new ho(this)}create(e){let t=po(this);return e!==void 0&&W(this,t,e),t}clone(e){let t=this.create();return W(this,t,e),t}equals(e,t){return mo(this,e,t)}is(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!1)}isAssignable(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){W(this,e,t)}fromBinary(e,t){let r=zs(t);return this.internalBinaryRead(r.readerFactory(e),e.byteLength,r)}fromJson(e,t){return this.internalJsonRead(e,ro(t))}fromJsonString(e,t){let r=JSON.parse(e);return this.fromJson(r,t)}toJson(e,t){return this.internalJsonWrite(e,io(t))}toJsonString(e,t){var r;let i=this.toJson(e,t);return JSON.stringify(i,null,(r=t?.prettySpaces)!==null&&r!==void 0?r:0)}toBinary(e,t){let r=to(t);return this.internalBinaryWrite(e,r.writerFactory(),r).finish()}internalJsonRead(e,t,r){if(e!==null&&typeof e=="object"&&!Array.isArray(e)){let i=r??this.create();return this.refJsonReader.read(e,i,t),i}throw new Error(`Unable to parse message ${this.typeName} from JSON ${vn(e)}.`)}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,r){return this.refBinWriter.write(e,t,r),t}internalBinaryRead(e,t,r,i){let s=i??this.create();return this.refBinReader.read(e,s,r,t),s}}function yo(n,e){var t,r,i;let s=n;return s.service=e,s.localName=(t=s.localName)!==null&&t!==void 0?t:On(s.name),s.serverStreaming=!!s.serverStreaming,s.clientStreaming=!!s.clientStreaming,s.options=(r=s.options)!==null&&r!==void 0?r:{},s.idempotency=(i=s.idempotency)!==null&&i!==void 0?i:void 0,s}class bo{constructor(e,t,r){this.typeName=e,this.methods=t.map(i=>yo(i,this)),this.options=r??{}}}class z extends Error{constructor(e,t="UNKNOWN",r){super(e),this.name="RpcError",Object.setPrototypeOf(this,new.target.prototype),this.code=t,this.meta=r??{}}toString(){const e=[this.name+": "+this.message];this.code&&(e.push(""),e.push("Code: "+this.code)),this.serviceName&&this.methodName&&e.push("Method: "+this.serviceName+"/"+this.methodName);let t=Object.entries(this.meta);if(t.length){e.push(""),e.push("Meta:");for(let[r,i]of t)e.push(`  ${r}: ${i}`)}return e.join(`
`)}}function wo(n,e){if(!e)return n;let t={};jt(n,t),jt(e,t);for(let r of Object.keys(e)){let i=e[r];switch(r){case"jsonOptions":t.jsonOptions=so(n.jsonOptions,t.jsonOptions);break;case"binaryOptions":t.binaryOptions=Gs(n.binaryOptions,t.binaryOptions);break;case"meta":t.meta={},jt(n.meta,t.meta),jt(e.meta,t.meta);break;case"interceptors":t.interceptors=n.interceptors?n.interceptors.concat(i):i.concat();break}}return t}function jt(n,e){if(!n)return;let t=e;for(let[r,i]of Object.entries(n))i instanceof Date?t[r]=new Date(i.getTime()):Array.isArray(i)?t[r]=i.concat():t[r]=i}var le;(function(n){n[n.PENDING=0]="PENDING",n[n.REJECTED=1]="REJECTED",n[n.RESOLVED=2]="RESOLVED"})(le||(le={}));class Oe{constructor(e=!0){this._state=le.PENDING,this._promise=new Promise((t,r)=>{this._resolve=t,this._reject=r}),e&&this._promise.catch(t=>{})}get state(){return this._state}get promise(){return this._promise}resolve(e){if(this.state!==le.PENDING)throw new Error(`cannot resolve ${le[this.state].toLowerCase()}`);this._resolve(e),this._state=le.RESOLVED}reject(e){if(this.state!==le.PENDING)throw new Error(`cannot reject ${le[this.state].toLowerCase()}`);this._reject(e),this._state=le.REJECTED}resolvePending(e){this._state===le.PENDING&&this.resolve(e)}rejectPending(e){this._state===le.PENDING&&this.reject(e)}}class ko{constructor(){this._lis={nxt:[],msg:[],err:[],cmp:[]},this._closed=!1,this._itState={q:[]}}onNext(e){return this.addLis(e,this._lis.nxt)}onMessage(e){return this.addLis(e,this._lis.msg)}onError(e){return this.addLis(e,this._lis.err)}onComplete(e){return this.addLis(e,this._lis.cmp)}addLis(e,t){return t.push(e),()=>{let r=t.indexOf(e);r>=0&&t.splice(r,1)}}clearLis(){for(let e of Object.values(this._lis))e.splice(0,e.length)}get closed(){return this._closed!==!1}notifyNext(e,t,r){C((e?1:0)+(t?1:0)+(r?1:0)<=1,"only one emission at a time"),e&&this.notifyMessage(e),t&&this.notifyError(t),r&&this.notifyComplete()}notifyMessage(e){C(!this.closed,"stream is closed"),this.pushIt({value:e,done:!1}),this._lis.msg.forEach(t=>t(e)),this._lis.nxt.forEach(t=>t(e,void 0,!1))}notifyError(e){C(!this.closed,"stream is closed"),this._closed=e,this.pushIt(e),this._lis.err.forEach(t=>t(e)),this._lis.nxt.forEach(t=>t(void 0,e,!1)),this.clearLis()}notifyComplete(){C(!this.closed,"stream is closed"),this._closed=!0,this.pushIt({value:null,done:!0}),this._lis.cmp.forEach(e=>e()),this._lis.nxt.forEach(e=>e(void 0,void 0,!0)),this.clearLis()}[Symbol.asyncIterator](){return this._closed===!0?this.pushIt({value:null,done:!0}):this._closed!==!1&&this.pushIt(this._closed),{next:()=>{let e=this._itState;C(e,"bad state"),C(!e.p,"iterator contract broken");let t=e.q.shift();return t?"value"in t?Promise.resolve(t):Promise.reject(t):(e.p=new Oe,e.p.promise)}}}pushIt(e){let t=this._itState;if(t.p){const r=t.p;C(r.state==le.PENDING,"iterator contract broken"),"value"in e?r.resolve(e):r.reject(e),delete t.p}else t.q.push(e)}}var No=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(r.next(h))}catch(w){o(w)}}function l(h){try{c(r.throw(h))}catch(w){o(w)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class Eo{constructor(e,t,r,i,s,o,a){this.method=e,this.requestHeaders=t,this.request=r,this.headers=i,this.response=s,this.status=o,this.trailers=a}then(e,t){return this.promiseFinished().then(r=>e?Promise.resolve(e(r)):r,r=>t?Promise.resolve(t(r)):Promise.reject(r))}promiseFinished(){return No(this,void 0,void 0,function*(){let[e,t,r,i]=yield Promise.all([this.headers,this.response,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:e,response:t,status:r,trailers:i}})}}var _o=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(r.next(h))}catch(w){o(w)}}function l(h){try{c(r.throw(h))}catch(w){o(w)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class vo{constructor(e,t,r,i,s,o,a){this.method=e,this.requestHeaders=t,this.request=r,this.headers=i,this.responses=s,this.status=o,this.trailers=a}then(e,t){return this.promiseFinished().then(r=>e?Promise.resolve(e(r)):r,r=>t?Promise.resolve(t(r)):Promise.reject(r))}promiseFinished(){return _o(this,void 0,void 0,function*(){let[e,t,r]=yield Promise.all([this.headers,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:e,status:t,trailers:r}})}}function se(n,e,t,r,i){var s;{let o=(a,l,c)=>e.unary(a,l,c);for(const a of((s=r.interceptors)!==null&&s!==void 0?s:[]).filter(l=>l.interceptUnary).reverse()){const l=o;o=(c,h,w)=>a.interceptUnary(l,c,h,w)}return o(t,i,r)}}var R;(function(n){n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS"})(R||(R={}));var So=function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(r.next(h))}catch(w){o(w)}}function l(h){try{c(r.throw(h))}catch(w){o(w)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};function Lr(n,e,t,r,i){if(r)for(let[s,o]of Object.entries(r))if(typeof o=="string")n.append(s,o);else for(let a of o)n.append(s,a);if(n.set("Content-Type",e==="text"?"application/grpc-web-text":"application/grpc-web+proto"),e=="text"&&n.set("Accept","application/grpc-web-text"),n.set("X-Grpc-Web","1"),typeof t=="number"){if(t<=0)throw new z(`timeout ${t} ms exceeded`,R[R.DEADLINE_EXCEEDED]);n.set("grpc-timeout",`${t}m`)}else if(t){const s=t.getTime(),o=Date.now();if(s<=o)throw new z(`deadline ${t} exceeded`,R[R.DEADLINE_EXCEEDED]);n.set("grpc-timeout",`${s-o}m`)}return n}function Fr(n,e){let t=new Uint8Array(5+n.length);t[0]=fe.DATA;for(let r=n.length,i=4;i>0;i--)t[i]=r%256,r>>>=8;return t.set(n,5),e==="binary"?t:_r(t)}function Rn(n,e,t){if(arguments.length===1){let l=n,c;try{c=l.type}catch{}switch(c){case"error":case"opaque":case"opaqueredirect":throw new z(`fetch response type ${l.type}`,R[R.UNKNOWN])}return Rn(Ao(l.headers),l.status,l.statusText)}let r=n,i=e>=200&&e<300,s=Gr(r),[o,a]=Vr(r);return(o===void 0||o===R.OK)&&!i&&(o=Ro(e),a=t),[o,a,s]}function Cr(n){let e=Oo(n),[t,r]=Vr(e),i=Gr(e);return[t??R.OK,r,i]}var fe;(function(n){n[n.DATA=0]="DATA",n[n.TRAILER=128]="TRAILER"})(fe||(fe={}));function jr(n,e,t){return So(this,void 0,void 0,function*(){let r,i="",s=new Uint8Array(0),o=To(e);if(Io(n)){let a=n.getReader();r={next:()=>a.read()}}else r=n[Symbol.asyncIterator]();for(;;){let a=yield r.next();if(a.value!==void 0){if(o==="text"){for(let c=0;c<a.value.length;c++)i+=String.fromCharCode(a.value[c]);let l=i.length-i.length%4;if(l===0)continue;s=Wr(s,Er(i.substring(0,l))),i=i.substring(l)}else s=Wr(s,a.value);for(;s.length>=5&&s[0]===fe.DATA;){let l=0;for(let c=1;c<5;c++)l=(l<<8)+s[c];if(s.length-5>=l)t(fe.DATA,s.subarray(5,5+l)),s=s.subarray(5+l);else break}}if(a.done){if(s.length===0)break;if(s[0]!==fe.TRAILER||s.length<5)throw new z("premature EOF",R[R.DATA_LOSS]);t(fe.TRAILER,s.subarray(5));break}}})}const Io=n=>typeof n.getReader=="function";function Wr(n,e){let t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function To(n){switch(n){case"application/grpc-web-text":case"application/grpc-web-text+proto":return"text";case"application/grpc-web":case"application/grpc-web+proto":return"binary";case void 0:case null:throw new z("missing response content type",R[R.INTERNAL]);default:throw new z("unexpected response content type: "+n,R[R.INTERNAL])}}function Vr(n){let e,t,r=n["grpc-message"];if(r!==void 0){if(Array.isArray(r))return[R.INTERNAL,"invalid grpc-web message"];t=r}let i=n["grpc-status"];if(i!==void 0){if(Array.isArray(i))return[R.INTERNAL,"invalid grpc-web status"];if(e=parseInt(i,10),R[e]===void 0)return[R.INTERNAL,"invalid grpc-web status"]}return[e,t]}function Gr(n){let e={};for(let[t,r]of Object.entries(n))switch(t){case"grpc-message":case"grpc-status":case"content-type":break;default:e[t]=r}return e}function Oo(n){let e={};for(let t of String.fromCharCode.apply(String,n).trim().split(`\r
`)){if(t=="")continue;let[r,...i]=t.split(":");const s=i.join(":").trim();r=r.trim();let o=e[r];typeof o=="string"?e[r]=[o,s]:Array.isArray(o)?o.push(s):e[r]=s}return e}function Ao(n){let e={};return n.forEach((t,r)=>{let i=e[r];typeof i=="string"?e[r]=[i,t]:Array.isArray(i)?i.push(t):e[r]=t}),e}function Ro(n){switch(n){case 200:return R.OK;case 400:return R.INVALID_ARGUMENT;case 401:return R.UNAUTHENTICATED;case 403:return R.PERMISSION_DENIED;case 404:return R.NOT_FOUND;case 409:return R.ABORTED;case 412:return R.FAILED_PRECONDITION;case 429:return R.RESOURCE_EXHAUSTED;case 499:return R.CANCELLED;case 500:return R.UNKNOWN;case 501:return R.UNIMPLEMENTED;case 503:return R.UNAVAILABLE;case 504:return R.DEADLINE_EXCEEDED;default:return R.UNKNOWN}}class xo{constructor(e){this.defaultOptions=e}mergeOptions(e){return wo(this.defaultOptions,e)}makeUrl(e,t){let r=t.baseUrl;return r.endsWith("/")&&(r=r.substring(0,r.length-1)),`${r}/${e.service.typeName}/${e.name}`}clientStreaming(e){const t=new z("Client streaming is not supported by grpc-web",R[R.UNIMPLEMENTED]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}duplex(e){const t=new z("Duplex streaming is not supported by grpc-web",R[R.UNIMPLEMENTED]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}serverStreaming(e,t,r){var i,s,o,a,l;let c=r,h=(i=c.format)!==null&&i!==void 0?i:"text",w=(s=c.fetch)!==null&&s!==void 0?s:globalThis.fetch,p=(o=c.fetchInit)!==null&&o!==void 0?o:{},g=this.makeUrl(e,c),f=e.I.toBinary(t,c.binaryOptions),N=new Oe,S=new ko,M=!0,m,u=new Oe,d,k=new Oe;return w(g,Object.assign(Object.assign({},p),{method:"POST",headers:Lr(new globalThis.Headers,h,c.timeout,c.meta),body:Fr(f,h),signal:(a=r.abort)!==null&&a!==void 0?a:null})).then(E=>{let[_,I,B]=Rn(E);if(N.resolve(B),_!=null&&_!==R.OK)throw new z(I??R[_],R[_],B);return _!=null&&(m={code:R[_],detail:I??R[_]}),E}).then(E=>{if(!E.body)throw new z("missing response body",R[R.INTERNAL]);return jr(E.body,E.headers.get("content-type"),(_,I)=>{switch(_){case fe.DATA:S.notifyMessage(e.O.fromBinary(I,c.binaryOptions)),M=!1;break;case fe.TRAILER:let B,X;[B,X,d]=Cr(I),m={code:R[B],detail:X??R[B]};break}})}).then(()=>{if(!d&&!M)throw new z("missing trailers",R[R.DATA_LOSS]);if(!m)throw new z("missing status",R[R.INTERNAL]);if(m.code!=="OK")throw new z(m.detail,m.code,d);S.notifyComplete(),u.resolve(m),k.resolve(d||{})}).catch(E=>{let _;E instanceof z?_=E:E instanceof Error&&E.name==="AbortError"?_=new z(E.message,R[R.CANCELLED]):_=new z(E instanceof Error?E.message:""+E,R[R.INTERNAL]),_.methodName=e.name,_.serviceName=e.service.typeName,N.rejectPending(_),S.notifyError(_),u.rejectPending(_),k.rejectPending(_)}),new vo(e,(l=c.meta)!==null&&l!==void 0?l:{},t,N.promise,S,u.promise,k.promise)}unary(e,t,r){var i,s,o,a,l;let c=r,h=(i=c.format)!==null&&i!==void 0?i:"text",w=(s=c.fetch)!==null&&s!==void 0?s:globalThis.fetch,p=(o=c.fetchInit)!==null&&o!==void 0?o:{},g=this.makeUrl(e,c),f=e.I.toBinary(t,c.binaryOptions),N=new Oe,S,M=new Oe,m,u=new Oe,d,k=new Oe;return w(g,Object.assign(Object.assign({},p),{method:"POST",headers:Lr(new globalThis.Headers,h,c.timeout,c.meta),body:Fr(f,h),signal:(a=r.abort)!==null&&a!==void 0?a:null})).then(E=>{let[_,I,B]=Rn(E);if(N.resolve(B),_!=null&&_!==R.OK)throw new z(I??R[_],R[_],B);return _!=null&&(m={code:R[_],detail:I??R[_]}),E}).then(E=>{if(!E.body)throw new z("missing response body",R[R.INTERNAL]);return jr(E.body,E.headers.get("content-type"),(_,I)=>{switch(_){case fe.DATA:if(S)throw new z("unary call received 2nd message",R[R.DATA_LOSS]);S=e.O.fromBinary(I,c.binaryOptions);break;case fe.TRAILER:let B,X;[B,X,d]=Cr(I),m={code:R[B],detail:X??R[B]};break}})}).then(()=>{if(!d&&S)throw new z("missing trailers",R[R.DATA_LOSS]);if(!m)throw new z("missing status",R[R.INTERNAL]);if(!S&&m.code==="OK")throw new z("expected error status",R[R.DATA_LOSS]);if(!S)throw new z(m.detail,m.code,d);if(M.resolve(S),m.code!=="OK")throw new z(m.detail,m.code,d);u.resolve(m),k.resolve(d||{})}).catch(E=>{let _;E instanceof z?_=E:E instanceof Error&&E.name==="AbortError"?_=new z(E.message,R[R.CANCELLED]):_=new z(E instanceof Error?E.message:""+E,R[R.INTERNAL]),_.methodName=e.name,_.serviceName=e.service.typeName,N.rejectPending(_),M.rejectPending(_),u.rejectPending(_),k.rejectPending(_)}),new Eo(e,(l=c.meta)!==null&&l!==void 0?l:{},t,N.promise,M.promise,u.promise,k.promise)}}let Uo="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Bo=(n=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(n));for(let r=0;r<n;r++)e+=Uo[63&t[r]];return e};class Mo{domain;expires;maxAge;partitioned;path;sameSite;secure;constructor({domain:e,expires:t,maxAge:r,partitioned:i,path:s,sameSite:o,secure:a}={}){this.domain=e,this.expires=t,this.maxAge=r,this.partitioned=i,this.path=s,this.sameSite=o,this.secure=a}set(e,t,{domain:r=this.domain,expires:i=this.expires,maxAge:s=this.maxAge,partitioned:o=this.partitioned,path:a=this.path,sameSite:l=this.sameSite,secure:c=this.secure}={}){let h=encodeURIComponent(e)+"="+encodeURIComponent(t);r&&(h+="; Domain="+r),i&&(i.constructor===Number&&(i=new Date(i)),h+="; Expires="+(i instanceof Date?i.toUTCString():i)),(s||s===0)&&(h+="; Max-Age="+s),o&&(h+="; Partitioned"),a&&(h+="; Path="+a),l&&(h+="; SameSite="+l),c&&(h+="; Secure"),document.cookie=h}get(e){const t=document.cookie.match(new RegExp("(?:^\\s*|;\\s*)"+encodeURIComponent(e).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"\\s*=\\s*([^;]*)"));return t?decodeURIComponent(t[1]):void 0}remove(e,t={}){t.maxAge=0,this.set(e,"",t)}}var Wt;(n=>{const e=["com","edu","gov","net","org"],t="@moegirl/grpc-web:nanoid",i=new Mo;function s(l=location){const c=l.hostname,h=c.split(".");if(h.length<3)return`.${c}`;const w=e.includes(h[h.length-2]);return`.${h.slice(w?h.length-3:h.length-2).join(".")}`}function o(){const l=i.get(t),c=l&&l.length===21?l:Bo(21);return i.set(t,c,{sameSite:"Lax",domain:s(location),expires:Date.now()+365*24*60*60*1e3,path:"/"}),c}n.getDeviceNanoId=o;function a(l){const c=typeof l=="number"&&l>0?`UID:${l}`:typeof l=="string"&&l.trim().length>0?`User:${encodeURI(l)}`:"__NOUSERNAME__";return`WebApp/gRPC-web ${o()} ${c}`}n.createDeviceId=a})(Wt||(Wt={}));class Do extends xo{setOptions(e){const t=this.mergeOptions(e);return Reflect.set(this,"defaultOptions",t),this}setMetadata(e,t){return this.setOptions({meta:{[e]:t}})}setAppName(e){return this.setMetadata("SP_THINKING_APP_NAME",e)}setUserName(e){return this.setMetadata("MOBILEDEVICEID",Wt.createDeviceId(e))}}function $o(n,e,t){return new Do({baseUrl:n,timeout:1e4,fetchInit:{credentials:"include"},...e,meta:{SP_THINKING_APP_NAME:"moegirl-web",MOBILEDEVICEID:Wt.createDeviceId(),SP_THINKING_BUNDLE_ID:"WebApp",SP_THINKING_OS:navigator.platform||"",SP_THINKING_SYSTEM_LANGUAGE:navigator.language,SP_THINKING_DEVICE_MODEL:"",SP_THINKING_DEVICE_ID:"",SP_THINKING_CARRIER:"",SP_THINKING_MANUFACTURE:"",SP_THINKING_NETWORK_TYPE:navigator?.connection?.type||"",SP_THINKING_OS_VERSION:"",SP_THINKING_ZONE_OFFSET:""+new Date().getTimezoneOffset(),SP_THINKING_APP_VERSION:"",...t}})}class Po extends q{constructor(){super("google.protobuf.Timestamp",[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])}now(){const e=this.create(),t=Date.now();return e.seconds=J.from(Math.floor(t/1e3)).toString(),e.nanos=t%1e3*1e6,e}toDate(e){return new Date(J.from(e.seconds).toNumber()*1e3+Math.ceil(e.nanos/1e6))}fromDate(e){const t=this.create(),r=e.getTime();return t.seconds=J.from(Math.floor(r/1e3)).toString(),t.nanos=(r%1e3+(r<0&&r%1e3!==0?1e3:0))*1e6,t}internalJsonWrite(e,t){let r=J.from(e.seconds).toNumber()*1e3;if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("Unable to encode Timestamp to JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");if(e.nanos<0)throw new Error("Unable to encode invalid Timestamp to JSON. Nanos must not be negative.");let i="Z";if(e.nanos>0){let s=(e.nanos+1e9).toString().substring(1);s.substring(3)==="000000"?i="."+s.substring(0,3)+"Z":s.substring(6)==="000"?i="."+s.substring(0,6)+"Z":i="."+s+"Z"}return new Date(r).toISOString().replace(".000Z",i)}internalJsonRead(e,t,r){if(typeof e!="string")throw new Error("Unable to parse Timestamp from JSON "+vn(e)+".");let i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("Unable to parse Timestamp from JSON. Invalid format.");let s=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(s))throw new Error("Unable to parse Timestamp from JSON. Invalid value.");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new globalThis.Error("Unable to parse Timestamp from JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");return r||(r=this.create()),r.seconds=J.from(s/1e3).toString(),r.nanos=0,i[7]&&(r.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),r}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.seconds="0",t.nanos=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.seconds=e.int64().toString();break;case 2:s.nanos=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.seconds!=="0"&&t.tag(1,O.Varint).int64(e.seconds),e.nanos!==0&&t.tag(2,O.Varint).int32(e.nanos);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Lo=new Po;var xn=(n=>(n[n.DEV=0]="DEV",n[n.DOGFOOD=1]="DOGFOOD",n[n.INNERRING=2]="INNERRING",n[n.OUTERRING=3]="OUTERRING",n[n.PROD=4]="PROD",n))(xn||{}),Un=(n=>(n[n.CHECKIN=0]="CHECKIN",n[n.USAGETIME=1]="USAGETIME",n[n.REVIEW=2]="REVIEW",n[n.SHARE=3]="SHARE",n[n.SPECIAL_CONTRIBUTION=4]="SPECIAL_CONTRIBUTION",n[n.PUNISHMENT=5]="PUNISHMENT",n[n.FIRST_TIME_LOGIN=6]="FIRST_TIME_LOGIN",n[n.FIRST_TIME_SET_MOBILE=7]="FIRST_TIME_SET_MOBILE",n[n.FIRST_TIME_SET_EMAIL=8]="FIRST_TIME_SET_EMAIL",n[n.FIRST_TIME_SET_AVATAR=9]="FIRST_TIME_SET_AVATAR",n))(Un||{}),gt=(n=>(n[n.FREE_MEMBERSHIP=0]="FREE_MEMBERSHIP",n[n.BASIC_MEMBERSHIP=1]="BASIC_MEMBERSHIP",n))(gt||{});class Fo extends q{constructor(){super("moegirl.moepad.type.MoePower",[{no:1,name:"moe_power_value",kind:"scalar",T:5},{no:2,name:"moe_power_record_number",kind:"scalar",T:3},{no:3,name:"moe_power_type",kind:"enum",T:()=>["moegirl.moepad.config_enums.MoePowerType",Un]},{no:4,name:"moe_power_create_time",kind:"message",T:()=>Lo},{no:5,name:"revoked",kind:"scalar",T:8}])}}const Co=new Fo;class jo extends q{constructor(){super("google.type.PhoneNumber",[{no:1,name:"e164_number",kind:"scalar",oneof:"kind",T:9},{no:2,name:"short_code",kind:"message",oneof:"kind",T:()=>Mn},{no:3,name:"extension",kind:"scalar",T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.kind={oneofKind:void 0},t.extension="",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.kind={oneofKind:"e164Number",e164Number:e.string()};break;case 2:s.kind={oneofKind:"shortCode",shortCode:Mn.internalBinaryRead(e,e.uint32(),r,s.kind.shortCode)};break;case 3:s.extension=e.string();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.kind.oneofKind==="e164Number"&&t.tag(1,O.LengthDelimited).string(e.kind.e164Number),e.kind.oneofKind==="shortCode"&&Mn.internalBinaryWrite(e.kind.shortCode,t.tag(2,O.LengthDelimited).fork(),r).join(),e.extension!==""&&t.tag(3,O.LengthDelimited).string(e.extension);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Bn=new jo;class Wo extends q{constructor(){super("google.type.PhoneNumber.ShortCode",[{no:1,name:"region_code",kind:"scalar",T:9},{no:2,name:"number",kind:"scalar",T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.regionCode="",t.number="",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.regionCode=e.string();break;case 2:s.number=e.string();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.regionCode!==""&&t.tag(1,O.LengthDelimited).string(e.regionCode),e.number!==""&&t.tag(2,O.LengthDelimited).string(e.number);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Mn=new Wo;var qr=(n=>(n[n.FIRST_EDIT=0]="FIRST_EDIT",n))(qr||{}),Hr=(n=>(n[n.TEN_YEAR_ANNIVERSARY=0]="TEN_YEAR_ANNIVERSARY",n))(Hr||{}),Dn=(n=>(n[n.MOE_POWER_EXPERIMENT=0]="MOE_POWER_EXPERIMENT",n[n.MOE_COMMUNITY=1]="MOE_COMMUNITY",n[n.MOE_RECOMMEND=2]="MOE_RECOMMEND",n[n.MOE_SEARCH_RECOMMEND=3]="MOE_SEARCH_RECOMMEND",n[n.GACHA=4]="GACHA",n[n.CHAT=5]="CHAT",n[n.ART_WORK=6]="ART_WORK",n[n.FLIGHT_INVITE_MOE_POWER_LIMIT=7]="FLIGHT_INVITE_MOE_POWER_LIMIT",n[n.SHORT_REVIEW_SWITCH=8]="SHORT_REVIEW_SWITCH",n[n.LONG_REVIEW_SWITCH=9]="LONG_REVIEW_SWITCH",n[n.COMMUNITY_SWITCH=10]="COMMUNITY_SWITCH",n[n.SHOW_POST_DEPTH=11]="SHOW_POST_DEPTH",n[n.MEMBER_SWITCH=12]="MEMBER_SWITCH",n[n.MEMBER_PAYMENT_SWITCH=13]="MEMBER_PAYMENT_SWITCH",n[n.YUNJING_SWITCH=14]="YUNJING_SWITCH",n[n.TEMP_APPLE_LOGOUT=16]="TEMP_APPLE_LOGOUT",n[n.TEMP_HUAWEI_HEALTHY=17]="TEMP_HUAWEI_HEALTHY",n[n.MOEBAO_INPUT_MAX_LENGTH=18]="MOEBAO_INPUT_MAX_LENGTH",n[n.MOEBAO_AD_FREQUENCY=19]="MOEBAO_AD_FREQUENCY",n[n.MOEBAO_DAILY_SHARE_LIMIT=20]="MOEBAO_DAILY_SHARE_LIMIT",n[n.MOEBAO_HISTORY_NUMBER=21]="MOEBAO_HISTORY_NUMBER",n[n.TEMP_XIAOMI_HEALTHY=22]="TEMP_XIAOMI_HEALTHY",n[n.APPLE_NOLOGIN_PURCHASE=23]="APPLE_NOLOGIN_PURCHASE",n))(Dn||{}),Kr=(n=>(n[n.EDITOR=0]="EDITOR",n))(Kr||{});class Vo extends q{constructor(){super("moegirl.moepad.GetUserinfoResponse",[{no:1,name:"user_id",kind:"scalar",T:3},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"groups",kind:"scalar",repeat:2,T:9},{no:4,name:"avatar",kind:"scalar",T:9},{no:5,name:"phone_number",kind:"message",T:()=>Bn},{no:6,name:"email",kind:"scalar",T:9},{no:7,name:"qq_name",kind:"scalar",T:9},{no:8,name:"wechat_name",kind:"scalar",T:9},{no:9,name:"weibo_name",kind:"scalar",T:9},{no:10,name:"create_time",kind:"scalar",T:9},{no:11,name:"edit_count",kind:"scalar",T:5},{no:12,name:"contribution_count",kind:"scalar",T:5},{no:13,name:"apple_name",kind:"scalar",T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId="0",t.username="",t.groups=[],t.avatar="",t.email="",t.qqName="",t.wechatName="",t.weiboName="",t.createTime="",t.editCount=0,t.contributionCount=0,t.appleName="",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int64().toString();break;case 2:s.username=e.string();break;case 3:s.groups.push(e.string());break;case 4:s.avatar=e.string();break;case 5:s.phoneNumber=Bn.internalBinaryRead(e,e.uint32(),r,s.phoneNumber);break;case 6:s.email=e.string();break;case 7:s.qqName=e.string();break;case 8:s.wechatName=e.string();break;case 9:s.weiboName=e.string();break;case 10:s.createTime=e.string();break;case 11:s.editCount=e.int32();break;case 12:s.contributionCount=e.int32();break;case 13:s.appleName=e.string();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!=="0"&&t.tag(1,O.Varint).int64(e.userId),e.username!==""&&t.tag(2,O.LengthDelimited).string(e.username);for(let s=0;s<e.groups.length;s++)t.tag(3,O.LengthDelimited).string(e.groups[s]);e.avatar!==""&&t.tag(4,O.LengthDelimited).string(e.avatar),e.phoneNumber&&Bn.internalBinaryWrite(e.phoneNumber,t.tag(5,O.LengthDelimited).fork(),r).join(),e.email!==""&&t.tag(6,O.LengthDelimited).string(e.email),e.qqName!==""&&t.tag(7,O.LengthDelimited).string(e.qqName),e.wechatName!==""&&t.tag(8,O.LengthDelimited).string(e.wechatName),e.weiboName!==""&&t.tag(9,O.LengthDelimited).string(e.weiboName),e.createTime!==""&&t.tag(10,O.LengthDelimited).string(e.createTime),e.editCount!==0&&t.tag(11,O.Varint).int32(e.editCount),e.contributionCount!==0&&t.tag(12,O.Varint).int32(e.contributionCount),e.appleName!==""&&t.tag(13,O.LengthDelimited).string(e.appleName);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const $n=new Vo;class Go extends q{constructor(){super("moegirl.moepad.GetUserChannelResponse",[{no:1,name:"channel",kind:"enum",T:()=>["moegirl.moepad.config_enums.Channel",xn]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.channel=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.channel=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.channel!==0&&t.tag(1,O.Varint).int32(e.channel);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Pn=new Go;class qo extends q{constructor(){super("moegirl.moepad.ExperimentMapEntry",[{no:1,name:"experiment",kind:"enum",T:()=>["moegirl.moepad.config_enums.UserExperiment",Dn]},{no:2,name:"value",kind:"scalar",T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.experiment=0,t.value="",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.experiment=e.int32();break;case 2:s.value=e.string();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.experiment!==0&&t.tag(1,O.Varint).int32(e.experiment),e.value!==""&&t.tag(2,O.LengthDelimited).string(e.value);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Ln=new qo;class Ho extends q{constructor(){super("moegirl.moepad.GetUserExperimentResponse",[{no:1,name:"experiments",kind:"enum",repeat:1,T:()=>["moegirl.moepad.config_enums.UserExperiment",Dn]},{no:2,name:"experiments_map",kind:"message",repeat:2,T:()=>Ln}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.experiments=[],t.experimentsMap=[],e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:if(l===O.LengthDelimited)for(let w=e.int32()+e.pos;e.pos<w;)s.experiments.push(e.int32());else s.experiments.push(e.int32());break;case 2:s.experimentsMap.push(Ln.internalBinaryRead(e,e.uint32(),r));break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){if(e.experiments.length){t.tag(1,O.LengthDelimited).fork();for(let s=0;s<e.experiments.length;s++)t.int32(e.experiments[s]);t.join()}for(let s=0;s<e.experimentsMap.length;s++)Ln.internalBinaryWrite(e.experimentsMap[s],t.tag(2,O.LengthDelimited).fork(),r).join();let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Fn=new Ho;class Ko extends q{constructor(){super("moegirl.moepad.type.UserExtraMoePower",[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"moe_power_record",kind:"message",repeat:2,T:()=>Co},{no:3,name:"total_moe_power",kind:"scalar",T:3},{no:4,name:"total_moe_power_record_number",kind:"scalar",T:3},{no:5,name:"check_in_times_today",kind:"scalar",T:5},{no:6,name:"usage_times_today",kind:"scalar",T:5},{no:7,name:"review_times_today",kind:"scalar",T:5},{no:8,name:"share_times_today",kind:"scalar",T:5}])}}const yt=new Ko;class zo extends q{constructor(){super("moegirl.moepad.IsUserLoggedInRequest",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Jo=new zo;class Xo extends q{constructor(){super("moegirl.moepad.IsUserLoggedInResponse",[{no:1,name:"is_logged_in",kind:"scalar",T:8}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.isLoggedIn=!1,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.isLoggedIn=e.bool();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.isLoggedIn!==!1&&t.tag(1,O.Varint).bool(e.isLoggedIn);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Yo=new Xo;class Zo extends q{constructor(){super("moegirl.moepad.GetUserMetadataRequest",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Qo=new Zo;class ea extends q{constructor(){super("moegirl.moepad.GetUserMetadataResponse",[{no:1,name:"get_user_info_response",kind:"message",T:()=>$n},{no:2,name:"get_user_membership_response",kind:"message",T:()=>Vt},{no:3,name:"get_user_experiment_response",kind:"message",T:()=>Fn},{no:4,name:"get_user_moe_power_metadata_response",kind:"message",T:()=>Gt},{no:5,name:"get_user_channel_response",kind:"message",T:()=>Pn}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.getUserInfoResponse=$n.internalBinaryRead(e,e.uint32(),r,s.getUserInfoResponse);break;case 2:s.getUserMembershipResponse=Vt.internalBinaryRead(e,e.uint32(),r,s.getUserMembershipResponse);break;case 3:s.getUserExperimentResponse=Fn.internalBinaryRead(e,e.uint32(),r,s.getUserExperimentResponse);break;case 4:s.getUserMoePowerMetadataResponse=Gt.internalBinaryRead(e,e.uint32(),r,s.getUserMoePowerMetadataResponse);break;case 5:s.getUserChannelResponse=Pn.internalBinaryRead(e,e.uint32(),r,s.getUserChannelResponse);break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.getUserInfoResponse&&$n.internalBinaryWrite(e.getUserInfoResponse,t.tag(1,O.LengthDelimited).fork(),r).join(),e.getUserMembershipResponse&&Vt.internalBinaryWrite(e.getUserMembershipResponse,t.tag(2,O.LengthDelimited).fork(),r).join(),e.getUserExperimentResponse&&Fn.internalBinaryWrite(e.getUserExperimentResponse,t.tag(3,O.LengthDelimited).fork(),r).join(),e.getUserMoePowerMetadataResponse&&Gt.internalBinaryWrite(e.getUserMoePowerMetadataResponse,t.tag(4,O.LengthDelimited).fork(),r).join(),e.getUserChannelResponse&&Pn.internalBinaryWrite(e.getUserChannelResponse,t.tag(5,O.LengthDelimited).fork(),r).join();let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ta=new ea;class na extends q{constructor(){super("moegirl.moepad.SetUserMembershipRequest",[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"user_membership",kind:"enum",T:()=>["moegirl.moepad.config_enums.UserMembership",gt]},{no:3,name:"expiry_in_seconds",kind:"scalar",T:3}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId=0,t.userMembership=0,t.expiryInSeconds="0",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int32();break;case 2:s.userMembership=e.int32();break;case 3:s.expiryInSeconds=e.int64().toString();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!==0&&t.tag(1,O.Varint).int32(e.userId),e.userMembership!==0&&t.tag(2,O.Varint).int32(e.userMembership),e.expiryInSeconds!=="0"&&t.tag(3,O.Varint).int64(e.expiryInSeconds);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ra=new na;class ia extends q{constructor(){super("moegirl.moepad.SetUserMembershipResponse",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const sa=new ia;class oa extends q{constructor(){super("moegirl.moepad.GetUserMembershipRequest",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const aa=new oa;class la extends q{constructor(){super("moegirl.moepad.GetUserMembershipResponse",[{no:1,name:"user_membership",kind:"enum",T:()=>["moegirl.moepad.config_enums.UserMembership",gt]},{no:2,name:"expiry_in_seconds",kind:"scalar",T:3},{no:3,name:"user_id",kind:"scalar",T:5},{no:4,name:"username",kind:"scalar",T:9},{no:5,name:"original_member_start_in_seconds",kind:"scalar",T:3}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userMembership=0,t.expiryInSeconds="0",t.userId=0,t.username="",t.originalMemberStartInSeconds="0",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userMembership=e.int32();break;case 2:s.expiryInSeconds=e.int64().toString();break;case 3:s.userId=e.int32();break;case 4:s.username=e.string();break;case 5:s.originalMemberStartInSeconds=e.int64().toString();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userMembership!==0&&t.tag(1,O.Varint).int32(e.userMembership),e.expiryInSeconds!=="0"&&t.tag(2,O.Varint).int64(e.expiryInSeconds),e.userId!==0&&t.tag(3,O.Varint).int32(e.userId),e.username!==""&&t.tag(4,O.LengthDelimited).string(e.username),e.originalMemberStartInSeconds!=="0"&&t.tag(5,O.Varint).int64(e.originalMemberStartInSeconds);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Vt=new la;class ca extends q{constructor(){super("moegirl.moepad.AddMoePowerRequest",[{no:1,name:"moe_power_type",kind:"enum",T:()=>["moegirl.moepad.config_enums.MoePowerType",Un]},{no:2,name:"user_id",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.moePowerType=0,t.userId=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.moePowerType=e.int32();break;case 2:s.userId=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.moePowerType!==0&&t.tag(1,O.Varint).int32(e.moePowerType),e.userId!==0&&t.tag(2,O.Varint).int32(e.userId);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ua=new ca;class fa extends q{constructor(){super("moegirl.moepad.AddMoePowerResponse",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ha=new fa;class da extends q{constructor(){super("moegirl.moepad.GetUserExtraMoePowerAllRecordRequest",[{no:1,name:"user_id",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!==0&&t.tag(1,O.Varint).int32(e.userId);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const pa=new da;class ma extends q{constructor(){super("moegirl.moepad.GetUserExtraMoePowerPageRequest",[{no:1,name:"user_id",kind:"scalar",T:5},{no:2,name:"page_number",kind:"scalar",T:5},{no:3,name:"page_size",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId=0,t.pageNumber=0,t.pageSize=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int32();break;case 2:s.pageNumber=e.int32();break;case 3:s.pageSize=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!==0&&t.tag(1,O.Varint).int32(e.userId),e.pageNumber!==0&&t.tag(2,O.Varint).int32(e.pageNumber),e.pageSize!==0&&t.tag(3,O.Varint).int32(e.pageSize);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ga=new ma;class ya extends q{constructor(){super("moegirl.moepad.GetUserMoePowerRankRequest",[{no:1,name:"user_id",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!==0&&t.tag(1,O.Varint).int32(e.userId);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ba=new ya;class wa extends q{constructor(){super("moegirl.moepad.GetUserMoePowerRankResponse",[{no:1,name:"rank",kind:"scalar",T:3}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.rank="0",e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.rank=e.int64().toString();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.rank!=="0"&&t.tag(1,O.Varint).int64(e.rank);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ka=new wa;class Na extends q{constructor(){super("moegirl.moepad.GetUserMoePowerMetadataRequest",[{no:1,name:"user_id",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!==0&&t.tag(1,O.Varint).int32(e.userId);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Ea=new Na;class _a extends q{constructor(){super("moegirl.moepad.GetUserMoePowerMetadataResponse",[{no:1,name:"user_extra_moe_power",kind:"message",T:()=>yt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userExtraMoePower=yt.internalBinaryRead(e,e.uint32(),r,s.userExtraMoePower);break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userExtraMoePower&&yt.internalBinaryWrite(e.userExtraMoePower,t.tag(1,O.LengthDelimited).fork(),r).join();let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Gt=new _a;class va extends q{constructor(){super("moegirl.moepad.AddUserGroupToUserRequest",[{no:1,name:"user_group",kind:"enum",repeat:1,T:()=>["moegirl.moepad.config_enums.UserGroup",Kr]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userGroup=[],e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:if(l===O.LengthDelimited)for(let w=e.int32()+e.pos;e.pos<w;)s.userGroup.push(e.int32());else s.userGroup.push(e.int32());break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){if(e.userGroup.length){t.tag(1,O.LengthDelimited).fork();for(let s=0;s<e.userGroup.length;s++)t.int32(e.userGroup[s]);t.join()}let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Sa=new va;class Ia extends q{constructor(){super("moegirl.moepad.AddUserGroupToUserResponse",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Ta=new Ia;class Oa extends q{constructor(){super("moegirl.moepad.AddAchievementToUserRequest",[{no:1,name:"user_achievement",kind:"enum",repeat:1,T:()=>["moegirl.moepad.config_enums.UserAchievement",qr]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userAchievement=[],e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:if(l===O.LengthDelimited)for(let w=e.int32()+e.pos;e.pos<w;)s.userAchievement.push(e.int32());else s.userAchievement.push(e.int32());break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){if(e.userAchievement.length){t.tag(1,O.LengthDelimited).fork();for(let s=0;s<e.userAchievement.length;s++)t.int32(e.userAchievement[s]);t.join()}let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Aa=new Oa;class Ra extends q{constructor(){super("moegirl.moepad.AddAchievementToUserResponse",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const xa=new Ra;class Ua extends q{constructor(){super("moegirl.moepad.AddBadgeToUserRequest",[{no:1,name:"user_badge",kind:"enum",repeat:1,T:()=>["moegirl.moepad.config_enums.UserBadge",Hr]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userBadge=[],e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:if(l===O.LengthDelimited)for(let w=e.int32()+e.pos;e.pos<w;)s.userBadge.push(e.int32());else s.userBadge.push(e.int32());break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){if(e.userBadge.length){t.tag(1,O.LengthDelimited).fork();for(let s=0;s<e.userBadge.length;s++)t.int32(e.userBadge[s]);t.join()}let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Ba=new Ua;class Ma extends q{constructor(){super("moegirl.moepad.AddBadgeToUserResponse",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Da=new Ma;class $a extends q{constructor(){super("moegirl.moepad.GetUserIdScoreRequest",[{no:1,name:"user_id",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.userId=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.userId=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.userId!==0&&t.tag(1,O.Varint).int32(e.userId);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Pa=new $a;class La extends q{constructor(){super("moegirl.moepad.GetUserIdScoreResponse",[{no:1,name:"like_number",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.likeNumber=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.likeNumber=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.likeNumber!==0&&t.tag(1,O.Varint).int32(e.likeNumber);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Fa=new La;class Ca extends q{constructor(){super("moegirl.moepad.GetUserMembershipGeneralChatRemainingCountRequest",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const ja=new Ca;class Wa extends q{constructor(){super("moegirl.moepad.GetUserMembershipGeneralChatRemainingCountResponse",[{no:1,name:"general_remaining_count",kind:"scalar",T:5}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.generalRemainingCount=0,e!==void 0&&W(this,t,e),t}internalBinaryRead(e,t,r,i){let s=i??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:s.generalRemainingCount=e.int32();break;default:let c=r.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let h=e.skip(l);c!==!1&&(c===!0?x.onRead:c)(this.typeName,s,a,l,h)}}return s}internalBinaryWrite(e,t,r){e.generalRemainingCount!==0&&t.tag(1,O.Varint).int32(e.generalRemainingCount);let i=r.writeUnknownFields;return i!==!1&&(i==!0?x.onWrite:i)(this.typeName,e,t),t}}const Va=new Wa,Cn=new bo("moegirl.moepad.MoepadUserService",[{name:"AddMoePowerToUser",options:{},I:ua,O:ha},{name:"GetUserExtraMoePowerAllRecord",options:{},I:pa,O:yt},{name:"GetUserExtraMoePowerPaged",options:{},I:ga,O:yt},{name:"GetUserMoePowerRank",options:{},I:ba,O:ka},{name:"GetUserMoePowerMetadata",options:{},I:Ea,O:Gt},{name:"AddUserGroupToUser",options:{},I:Sa,O:Ta},{name:"AddAchievementToUser",options:{},I:Aa,O:xa},{name:"AddBadgeToUser",options:{},I:Ba,O:Da},{name:"GetUserIdScore",options:{},I:Pa,O:Fa},{name:"SetUserMemberShip",options:{},I:ra,O:sa},{name:"GetUserMemberShip",options:{},I:aa,O:Vt},{name:"GetUserMetadata",options:{},I:Qo,O:ta},{name:"IsUserLoggedIn",options:{},I:Jo,O:Yo},{name:"GetUserMembershipGeneralChatRemainingCount",options:{},I:ja,O:Va}]);class Ga{constructor(e){this._transport=e}typeName=Cn.typeName;methods=Cn.methods;options=Cn.options;addMoePowerToUser(e,t){const r=this.methods[0],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserExtraMoePowerAllRecord(e,t){const r=this.methods[1],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserExtraMoePowerPaged(e,t){const r=this.methods[2],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserMoePowerRank(e,t){const r=this.methods[3],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserMoePowerMetadata(e,t){const r=this.methods[4],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}addUserGroupToUser(e,t){const r=this.methods[5],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}addAchievementToUser(e,t){const r=this.methods[6],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}addBadgeToUser(e,t){const r=this.methods[7],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserIdScore(e,t){const r=this.methods[8],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}setUserMemberShip(e,t){const r=this.methods[9],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserMemberShip(e,t){const r=this.methods[10],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserMetadata(e,t){const r=this.methods[11],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}isUserLoggedIn(e,t){const r=this.methods[12],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}getUserMembershipGeneralChatRemainingCount(e,t){const r=this.methods[13],i=this._transport.mergeOptions(t);return se("unary",this._transport,r,i,e)}}class qa extends Bt{constructor(e){super(e,"grpc"),this.ctx=e}transport=$o("https://api.moegirl.org.cn",{},{});userService=new Ga(this.transport)}var zr;(n=>{async function e(w){return new Promise((p,g)=>{const f=new FileReader;f.onload=()=>{f.result?p(f.result):g(new Error("Failed to read file"))},f.onerror=()=>{g(new Error("Failed to read file"))},f.readAsDataURL(w)})}n.fileToDataURL=e;async function t(w){return(await e(w)).split(",")[1]||""}n.fileToBase64=t;async function r(w){return new Promise((p,g)=>{const f=new FileReader;f.onload=()=>{f.result?p(new Uint8Array(f.result)):g(new Error("Failed to read file"))},f.onerror=()=>{g(new Error("Failed to read file"))},f.readAsArrayBuffer(w)})}n.fileToBytes=r;async function i(w){const p=await w.arrayBuffer(),g=await crypto.subtle.digest("SHA-256",p);return Array.from(new Uint8Array(g)).map(S=>("0"+S.toString(16)).slice(-2)).join("")}n.getFileSHA256=i;function s(w){const p=w.name,g=p.lastIndexOf(".");if(g>=0)return p.substring(g+1);{const N=w.type.split("/").pop();if(N&&!["*","octet-stream"].includes(N)&&!N.includes("+"))return N}return""}n.getFileExtension=s;const o="https://storage.moegirl.org.cn";async function a(w,p,g,f=!1){const N=await i(p);if(l.has(N)&&!f)return l.get(N);if(!s(p))throw new Error("Invalid file type");const{uploadUrl:M,signature:m,expirationTime:u,downloadUrl:d}=await c(w,p),k=new URL(M),E=k.pathname.split("/").slice(2).join("/");k.pathname;const _=d||new URL(E,o).href,I=await fetch(M,{method:"PUT",body:p,headers:{Authorization:m,"X-Date":new Date().toUTCString(),"X-Upyun-Expire":u,...g}}),B=await I.text();if(!I.ok||I.status!==200)throw new Error("Upload failed",{cause:{response:I,body:B}});return l.set(N,_),_}n.uploadFileV2=a;const l=new Map;async function c(w,p){const g=await i(p),f=h.get(g);if(f){if(Date.now()<new Date(parseInt(f.expirationTime||"0")*1e3).getTime())return f;h.delete(g)}if(!s(p))throw new Error("Invalid file type");const{response:{uploadUrl:S,signature:M,expirationTime:m,downloadUrl:u}}=await w.generateUpyunUploadSignature({fileExtension:s(p)});return h.set(g,{uploadUrl:S,signature:M,expirationTime:m,downloadUrl:u}),{uploadUrl:S,signature:M,expirationTime:m,downloadUrl:u}}const h=new Map;n.BLANK_PNG_BASE64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR42mMAAQAABQABoIJXOQAAAABJRU5ErkJggg=="})(zr||(zr={}));var qt;(n=>{function e(s,o){if(typeof s=="string")return{kind:{oneofKind:"e164Number",e164Number:i(`${s}${o}`)},extension:""};if("areaCode"in s)return{kind:{oneofKind:"e164Number",e164Number:i(`${s.areaCode}${s.phoneNumber}`)},extension:""};if("kind"in s&&s.kind.oneofKind==="e164Number")return s.kind.e164Number=i(s.kind.e164Number),s;throw new Error("Invalid input")}n.toGooglePhoneNumber=e;function t(s){return typeof s=="string"?i(s):s?.kind?.oneofKind==="e164Number"?i(s.kind.e164Number):""}n.toPhoneString=t;const r=/[0-9\+\*]/;function i(s){if(typeof s!="string")return"";const o=s.toLowerCase();if(o==="null"||o==="undefined")return"";let a=0,l=-1,c=!0;const h=[];for(const p of s)r.test(p)&&(h.push(p),p==="+"?(a++,l===-1&&(l=h.length-1),c=!1):p==="*"?c&&=!0:c=!1);const w=h.join("");return c||a>0&&(l!==0||a>1)?"":w}})(qt||(qt={}));var Jr;(n=>{function e({mostSignificantBits:r,leastSignificantBits:i}){const s=BigInt(r),o=BigInt(i),a=s.toString(16).padStart(16,"0"),l=o.toString(16).padStart(16,"0"),c=s<0?(BigInt(2)**BigInt(64)+s).toString(16):a,h=o<0?(BigInt(2)**BigInt(64)+o).toString(16):l;return`${c.substring(0,8)}-${c.substring(8,12)}-${c.substring(12,16)}-${h.substring(0,4)}-${h.substring(4,16)}`}n.toStandardUUID=e;function t(r){const i=r.replace(/-/g,""),s=i.substring(0,16),o=i.substring(16),a=BigInt(`0x${s}`),l=BigInt(`0x${o}`),c=a>BigInt(2)**BigInt(63)-BigInt(1)?(a-BigInt(2)**BigInt(64)).toString():a.toString(),h=l>BigInt(2)**BigInt(63)-BigInt(1)?(l-BigInt(2)**BigInt(64)).toString():l.toString();return{mostSignificantBits:c,leastSignificantBits:h}}n.fromStandardUUID=t})(Jr||(Jr={}));var Xr;(n=>{async function e(s,o){const a=qt.toGooglePhoneNumber(o);return s.getPhoneNumber({phoneNumber:a}).then(()=>!1).catch(l=>decodeURI(l.code)==="CANCELLED")}n.isPhoneBoundAccount=e;const t=/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/,r=/^\d{6,}$/;function i(s,o){return s.split("|")[0]==="+86"?t.test(o):r.test(o)}n.validatePhoneNumber=i})(Xr||(Xr={}));const Ha=n=>new Promise(e=>setTimeout(e,n)),Ka=async(n,e)=>Promise.race([n,Ha(e).then(()=>{throw new Error("timeout",{cause:n})})]);class ve{_raw;info;membership;channel;moepower;static createDefault(){return new ve({getUserInfoResponse:void 0,getUserMembershipResponse:void 0,getUserChannelResponse:void 0,getUserMoePowerMetadataResponse:void 0})}constructor(e){this._raw=e,this.info=ve.normalizeBasicInfo(e),this.membership=ve.normalizeMembership(e),this.channel=ve.normalizeUserChannel(e),this.moepower=ve.normalizeMoePowerInfo(e)}get raw(){return this._raw}get isLoggedIn(){return!!this.info.userId}get isGood(){return this._raw.getUserInfoResponse.userId?.toString()===this._raw.getUserMembershipResponse.userId?.toString()}static normalizeBasicInfo(e){const t=e.getUserInfoResponse;return{userName:t?.username||"",userId:+(t?.userId||"0"),userAvatar:t?.avatar||"",userGroups:t?.groups||[],phoneNumber:qt.toPhoneString(t?.phoneNumber)}}static normalizeMembership(e){return{type:e.getUserMembershipResponse?.userMembership||gt.FREE_MEMBERSHIP,expiryInSeconds:e.getUserMembershipResponse?.expiryInSeconds||"0",originalMemberStartInSeconds:e.getUserMembershipResponse?.originalMemberStartInSeconds||"0"}}static normalizeUserChannel(e){return e.getUserChannelResponse?.channel||xn.PROD}static normalizeMoePowerInfo(e){return{total:e.getUserMoePowerMetadataResponse?.userExtraMoePower?.totalMoePower||"0",records:e.getUserMoePowerMetadataResponse?.userExtraMoePower?.moePowerRecord||[]}}}const Ht=Symbol.for("__MOEPAD_USER_DATA__");function Yr(n,e=!1,t=3){return(!window[Ht]||e)&&(window[Ht]=Ka(n.getUserMetadata({}).response,5*1e3).then(r=>new ve(r)).catch(r=>{if(r?.code===R.UNAUTHENTICATED||r?.code==="UNAUTHENTICATED")return ve.createDefault();if(window[Ht]=void 0,t>0)return Yr(n,e,t-1);throw r})),window[Ht]}class za extends Bt{constructor(e){super(e,"user",!1),this.ctx=e,this.client=this.ctx.grpc.userService}static inject=["grpc"];userData;client;async start(){this.userData=await this.init()}async init(){return Yr(this.client,!1,0).then(e=>e).catch(e=>ve.createDefault())}isVIP(){return!!(this?.userData&&this.userData.isLoggedIn&&this.userData.membership.type===gt.BASIC_MEMBERSHIP&&Date.now()<=+this.userData.membership.expiryInSeconds*1e3)}}function V(n,e,t){const r=document.createElement(n);if((e instanceof Element||typeof e=="string")&&(e=[e]),Array.isArray(e))r.append(...e);else if(e){const i=e;Object.keys(i).forEach(s=>{typeof s<"u"&&r.setAttribute(s,""+i[s])})}return(t instanceof Element||typeof t=="string")&&(t=[t]),Array.isArray(t)&&r.append(...t),r}function Ja(n,e){const t=Date.now();(n===null||typeof n>"u")&&(n=0),(e===null||typeof e>"u")&&(e=t+1e3*60*60*24);let r=new Date(n).getTime(),i=new Date(e).getTime();return[r,i].includes(NaN)?!0:(r>i&&([r,i]=[i,r]),t>r&&t<i)}function Zr(n=""){const e=ei(n),t=Date.now(),r=localStorage.getItem(e)||"";let i=0;try{i=Ya(r).getTime()}catch{return!1}return!(isNaN(i)||i-t<0||i-t>24*60*60*1e3)}function Qr(n="",e=0){const t=ei(n),r=Date.now(),i=new Date(r+e);return localStorage.setItem(t,Xa(i)),i}const Kt=n=>n.split("").reverse().join(""),ei=(n="")=>btoa(`MoegirlInsight-dissmiss-${n}`),Xa=n=>Kt(btoa(Kt(n.toISOString()))),Ya=n=>new Date(Kt(atob(Kt(n))));class zt extends En{constructor(e,t){super(),this.config=e,this.options=t}apply(e){return V("div")}}class Jt extends zt{constructor(e){super(e),this.config=e,window.adsbygoogle=window.adsbygoogle||[];const t=new URL(e.links_to).searchParams.get("adClient");t&&!document.querySelector(`script[insight-slot="adsense"][client="${t}"]`)&&document.body.append(V("script",{src:`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?${new URLSearchParams({client:t})}`,async:!0,crossOrigin:"anonymous",client:t,"insight-slot":"adsense"}))}apply(e){const t=Jt.createNode(this.config),r=V("span",{style:"font-family:monospace;line-height:0;word-break:break-all"},"0".repeat(document.documentElement.clientWidth));if(!t.style.width){e.append(r);const o=r.offsetWidth;t.dataset.availableWidth=""+o,t.style.width=`${o}px`,r.style.display="none"}e.append(t),setTimeout(()=>{adsbygoogle.push({})});const i=setTimeout(()=>{this.emit("unfilled")},this.config.slot_options?.timeout||7e3);return new MutationObserver(()=>{const o=t.dataset.adStatus;typeof o>"u"||(["done","unfilled"].includes(o)?(clearTimeout(i),t.remove(),this.bail("unfilled")):(clearTimeout(i),this.bail("filled")))}).observe(t,{attributes:!0,childList:!1}),t}static createNode(e){const t=V("ins",{class:"adsbygoogle",style:`display:inline-block;${e.slot_options?.style||""}`}),r=Object.fromEntries(new URL(e.links_to).searchParams);for(const i in r)t.dataset[i]=r[i];return t}}class ti extends zt{constructor(e,t={delay:3e3}){document.querySelector('script[insight-slot="baidu-union"]')||document.body.append(V("script",{src:"https://cpro.baidustatic.com/cpro/ui/cm.js",async:!0,"insight-slot":"baidu-union"})),super(e,t),this.config=e,this.options=t,this._params=Object.fromEntries(new URL(this.config.links_to).searchParams.entries())}_params;_className;_sid;_tuid;apply(e){if(!e)throw new Error("Missing parent");const t=this.createNode();return e.appendChild(t),this.listenMessage(t),(window.slotbydup=window.slotbydup||[]).push({id:this._params.id,container:this._className,async:!0}),t}createNode(){const e=this._className=Math.random().toString(32).substring(2),t=V("div");return t.classList.add(e),this._sid=t.dataset.sid=this._params.id,this._tuid=t.dataset.tuid=this._sid+"_"+document.querySelectorAll(`[data-sid="${this._params.id}"]`).length,t}listenMessage(e){const t=setTimeout(()=>{this.emit("unfilled")},this.options.delay);window.addEventListener("message",r=>{if(r.origin!=="https://pos.baidu.com"||!r.data)return;const i=JSON.parse(r.data);i.tuid===this._tuid&&i.dspid&&(clearTimeout(t),i.dspid==="0"||i.noadx==="1"?this.emit("unfilled"):this.emit("filled"))})}}function Za(n,e){const t={};return n.forEach(r=>{const i=e(r);t[i]=t[i]!=null?[...t[i],r]:[r]}),t}async function Qa(n,e=0){if(e=Math.max(0,Math.min(1,e)),!n)return Promise.reject(new Error("Missing selector"));const t=typeof n=="string"?document.querySelector(n):n;return t?new Promise(r=>{const i=new IntersectionObserver(s=>{const{isIntersecting:o,intersectionRatio:a}=s[0];o&&a>=e&&(i.disconnect(),r(t))},{threshold:[0,1,e]});i.observe(t)}):Promise.reject(new Error("Missing parent node"))}async function ni(n,e,t=5e3){return n?n.querySelector(e)||new Promise(r=>{const i=setTimeout(()=>{s.disconnect(),r(null)},t),s=new MutationObserver(()=>{const o=n.querySelector(e);o&&(s.disconnect(),clearTimeout(i),r(o))});s.observe(n,{childList:!0,subtree:!0})}):null}const el=["Googlebot","Googlebot-Image","Googlebot-Video","Googlebot-Mobile","Mediapartners-Google","AdsBot-Google","Bingbot","BingPreview","msnbot","Slurp","Baiduspider","BaiduImageSpider","BaiduVideoSpider","Yandex","YandexBot","YandexImages","YandexMobileBot","YandexVideo","DuckDuckBot","Sogou","Sogou web spider","Sogou spider","Sogou Orion spider","360Spider"];function tl(n=navigator.userAgent){return el.some(e=>n.includes(e))}class Ae{constructor(e,t,r=!0){this.ctx=e,this.name=t,e.root.render[t]=this,r&&this.autoApplyInOrder()}static inject=["device","region","user"];autoApplyInOrder(){return this.relatedConfigs.length&&Object.values(this.relatedConfigsByGroup).forEach(e=>this.apply(e)),this}apply(e){}get relatedConfigs(){const e=this.ctx.configs.filter(t=>t.render===this.name&&Ja(t.enable_from,t.enable_to)).filter(t=>t.disabled?!1:this.checkDeviceType(t)?this.ctx.region.checkRegion(t)?!0:(this.traceEvent(t,"skipped/region-mismatch"),!1):(this.traceEvent(t,"skipped/device-mismatch"),!1));return Object.defineProperty(this,"relatedConfigs",{value:e}),e}get relatedConfigsByGroup(){const e=Za(this.relatedConfigs,t=>t.group_by??"__default__");return Object.defineProperty(this,"relatedConfigsByGroup",{value:e}),e}get pageCategories(){const e=document.querySelectorAll("#catlinks li > a[href]"),t=Array.from(e).map(r=>decodeURI(r.href.split("Category:")?.[1])||r.textContent||"").filter(Boolean).map(r=>new mw.Title(r,14).getMain());return Object.defineProperty(this,"pageCategories",{value:t}),t}get pageName(){return mw.config.get("wgPageName")}get pageTitle(){return new mw.Title(this.pageName)}async isEnvAndUserMatched(e){const t=`false-${new Date().toISOString().split("T")[0]}`,r=localStorage.getItem("moegirl-insight/force-show");if(r!==null&&["true",t].includes(r))return r==="true";const i=window.mediaWiki||window.mw;if(!i||!i.config)return!0;if(this.isSearchEngine)return this.traceEvent(e,"skipped/search-engine-bot"),!1;if(!this.checkIsArticle())return this.traceEvent(e,"skipped/not-article"),!1;if(await this.checkDismissUserGroups(e))return this.traceEvent(e,"skipped/no-ad-user-groups"),!1;if(this.ctx.user.isVIP())return this.traceEvent(e,"skipped/vip-membership"),!1;const a=this.checkPageNamesFilter(e);if(a!==null)return a;const l=this.checkPageCategoriesFilter(e);return l!==null?l:(typeof e.rarity!="number"&&(e.rarity=1),Math.random()>e.rarity?(this.traceEvent(e,"skipped/rarity-mismatch"),!1):!0)}checkIsArticle(){return mw.config.get("wgIsArticle")}checkDeviceType(e){return[null,void 0,"","*","all"].includes(e.device)||this.ctx.device.matchDevice(e)}async checkDismissUserGroups(e){const t=e.filter_dismiss_user_groups||e.no_ad_user_groups||[];if(!t.length)return!1;const r=await mw.user.getGroups();return!!t.some(s=>r.includes(s))}checkPageNamesFilter(e){return Array.isArray(e.filter_page_names)&&e.filter_page_names.length?e.filter_page_names.map(t=>new mw.Title(t).getPrefixedDb()).some(t=>t===this.pageName):null}checkPageCategoriesFilter(e){return Array.isArray(e.filter_page_categories)&&e.filter_page_categories.length?e.filter_page_categories.map(t=>new mw.Title(t,14).getMain()).some(t=>this.pageCategories.includes(t)):null}checkDismiss(e){return Zr(`${this.name}/${e.group_by||"default"}`)}setDismiss(e){return e.cooldown>10*60*1e3&&(e.cooldown=10*60*1e3),e.links_to.startsWith("adsense://")&&(e.cooldown=0),Qr(`${this.name}/${e.group_by||"default"}`,e.cooldown||0),this}get isSearchEngine(){const e=tl();return Object.defineProperty(this,"isSearchEngine",{value:e}),e}getSlotRender(e,t){return e.links_to.startsWith("adsense://")?Jt:e.links_to.startsWith("baidu-union://")?ti:(e.links_to.startsWith("http")||e.links_to.startsWith("//"))&&t||null}getSlotDismissText(e){return e instanceof Jt?"":e instanceof ti?"":""}async handleApplySlot(e){return new Promise(t=>{const{slot:r,config:i,container:s}=e;r.once("filled",()=>{this.handleShown(o,i),t({slotFilled:!0,slotElement:o})}),r.once("unfilled",a=>{this.handleUnfilled(o,i,i.force_show?`force-show${a?`/${a}`:""}`:a),t({slotFilled:!!i.force_show,slotElement:o})});const o=r.apply(s)})}handleShown(e,t){e.addEventListener("click",r=>{r.stopPropagation(),this.traceEvent(t,"clicked")}),this.getElementUntilIntoView(e,.1).then(()=>{this.traceEvent(t,"shown")})}handleUnfilled(e,t,r){this.traceEvent(t,r?`error/${r}`:"error/slot-unfilled")}getElementUntilIntoView=Qa.bind(this);traceEvent(e,t){const r=[t,{event_category:`moegirl-insight-${this.ctx.device.isMobile?"mobile":"desktop"}`,event_label:`${e.render_preset||this.name}:${e.links_to}`,event_origin:location.origin,insight_uuid:e.uuid}];window.gtag&&window.gtag("event",...r)}}const $e={root:"LKiWAjzNmD_lxjtg3",hidden:"sMucBzwNly_lxjtg3",container:"B3PE627t18_lxjtg3",customAsset:"Qywd9h41yZ_lxjtg3",closeBtn:"PNd4yOeDM7_lxjtg3"},jn={anchor:"xUkJeF1d7d_lxjtg3",error:"X7tHwc6gRp_lxjtg3",assets:"RPb6qQr-eq_lxjtg3"};class Pe extends zt{constructor(e){super(e),this.config=e}apply(e){const t=this.config,r=this.createAnchor(t),i=this.createAsset(t);return r.appendChild(i),this.on("unfilled",()=>{i.style.display="none",i.after(V("i",`${t.slot_options.alt||""}`)),r.classList.add(jn.error)}),e.appendChild(r),r}emitted=!1;createAnchor(e){const t=V(["script","iframe-standalone"].includes(e.slot_options.type)?"div":"a",{class:jn.anchor,href:e.links_to,target:"_blank",rel:"noopener noreferrer"});return t.addEventListener("click",r=>{r.stopPropagation()}),t}createAsset(e){let t;switch(e.slot_options.type){case"image":default:t="img";break;case"video":case"iframe":case"iframe-standalone":t="iframe";break;case"video-embed":t="video";break;case"script":t="script";break}const r=V(t,{src:e.slot_options.src,alt:e.slot_options.alt||"",class:jn.assets,style:e.slot_options.style||"",loading:"lazy",...e.slot_options.attributes});if(r.addEventListener("load",()=>{this.emitted||(this.emitted=!0,this.emit("filled"))}),r.addEventListener("error",()=>{this.emitted||(this.emitted=!0,this.emit("unfilled","assets-loading-error",!0))}),e.slot_options.aspect_ratio){const[i,s]=e.slot_options.aspect_ratio.split(/\/|\*|x||\s+/).map(o=>Number(o));!isNaN(i+s)&&i>0&&s>0&&new ResizeObserver(([o])=>{r.style.height=`${r.clientWidth/i*s}px`}).observe(r)}return r}}class nl extends Ae{constructor(e){super(e,"BackgroundRender"),this.ctx=e}async apply(e){const t=e[0];if(!t||!t.render_target||!t.render_position||!await this.isEnvAndUserMatched(t))return;if(this.checkDismiss(t))return this.traceEvent(t,"skipped/user-dismiss");const s=this.createNode(t),o=document.querySelector(t.render_target);if(!o)return this.traceEvent(t,"error/missing-target-element");if(t.links_to.includes("stgowan.com")){const a=s.root.querySelector(`.${$e.container}`),l=V("div",{class:`${$e.container} ${t.slot_options?.class||""}`}),c=new Pe(t);a.insertAdjacentElement("afterend",l),a.remove(),this.handleApplySlot({slot:c,config:t,container:l});const h=new MutationObserver(([w])=>{const[p]=w.addedNodes;p.nodeName==="DIV"&&p.childNodes.length===1&&p.firstChild?.nodeName==="A"&&(h.disconnect(),l.querySelector(`[href="${t.links_to}"]`)?.appendChild(p))});h.observe(o,{attributes:!1,childList:!0}),h.observe(document.body,{attributes:!1,childList:!0})}else this.traceEvent(t,"shown");o.insertAdjacentElement(t.render_position||"beforeend",s.root)}createNode(e){const t=V("div",{class:`${$e.root} ${e.render_options?.class||""}`,style:`${e.slot_options?.style||""}`});t.addEventListener("transitionend",s=>{(s.propertyName==="opacity"||getComputedStyle(t).opacity==="0")&&t.remove()});let r;e.slot_options?.type?(r=new Pe(e).apply(t),r.className=`${$e.customAsset} ${e.slot_options?.class||""}`):r=V("a",{class:`${$e.container} ${e.slot_options?.class||""}`,href:e.links_to,target:e.links_to&&e.links_to.startsWith("#")?"_blank":void 0,style:`--background-url: url(${e.slot_options?.src});${e.slot_options?.style||""}`}),r.addEventListener("click",()=>{this.traceEvent(e,"clicked")});const i=V("a",{class:$e.closeBtn},"");return i.addEventListener("click",()=>{this.close(t,e)}),t.append(r,i),{root:t,asset:r,close:i}}close(e,t){e.classList.add($e.hidden),this.setDismiss(t),this.traceEvent(t,"dismiss")}}const Xe={root:"X-2JFOXOR1_lxjtg3",hidden:"fSlmkxM5cg_lxjtg3",capsule:"_4JuHzMsWcH_lxjtg3",close:"GwGomSd0p9_lxjtg3",region:"_5lkkF7XtM1_lxjtg3"};class ae extends Ae{constructor(e){super(e,"MoeskinCardRender"),this.ctx=e,e.render[this.name]=this}async apply(e){let t;if(this.checkDismiss(e[0]))return this.traceEvent(e[0],"skipped/user-dismiss");let r=!1;for(t of e){if(r){r&&this.traceEvent(t,"skipped/sibling-filled");continue}const{root:i,close:s,region:o}=ae.createNode(t);if(s.addEventListener("click",()=>{ae.removeNode(i),r&&(this.setDismiss(t),this.traceEvent(t,"dismiss"))}),!t.render_target)continue;const a=document.querySelector(t.render_target),l=this.getSlotRender(t,Pe);if(!a||!l||!await this.isEnvAndUserMatched(t))continue;const c=new l(t);t.region==="oversea"&&(o.style.display="block"),a.insertAdjacentElement(t.render_position||"beforeend",i),await this.getElementUntilIntoView(i),r=(await this.handleApplySlot({slot:c,container:i,config:t})).slotFilled,r?s.innerText=this.getSlotDismissText(c):ae.removeNode(i)}}static createNode(e){const t=V("div",{class:`moe-card ${Xe.root} ${e.render_options?.class||""}`,style:e.render_options?.style||""}),r=V("a",{class:`${Xe.close} ${Xe.capsule}`},""),i=V("div",{class:`${Xe.region} ${Xe.capsule}`},`${e.region} AD`);return t.append(i,r),{root:t,close:r,region:i}}static removeNode(e){return new Promise(t=>{e.addEventListener("transitionend",r=>{(r.propertyName==="opacity"||getComputedStyle(e).opacity==="0")&&(e.remove(),t(!0))}),e.style.height=`${e.clientHeight}px`,setTimeout(()=>{e.classList.add(Xe.hidden)})})}}const rl={duilian:"ixCcjlKdoi_lxjtg3"};class il extends Ae{constructor(e){super(e,"DuilianRender"),this.ctx=e}async apply(e){let t=!1,r;if(this.checkDismiss(e[0]))return this.traceEvent(e[0],"skipped/user-dismiss");for(r of e){const i=ae.createNode(r);i.root.classList.add(rl.duilian),i.close.addEventListener("click",()=>{ae.removeNode(i.root),t&&(this.setDismiss(r),this.traceEvent(r,"dismiss"))});const s=this.getSlotRender(r,Pe);if(t||!s){t&&this.traceEvent(r,"skipped/sibling-filled");continue}if(!await this.isEnvAndUserMatched(r))continue;document.body.append(i.root);const o=new s(r),{slotFilled:a,slotElement:l}=await this.handleApplySlot({slot:o,container:i.root,config:r});t=a,t?(i.root.style.height="",i.close.innerText=this.getSlotDismissText(o)):ae.removeNode(i.root)}}}const ri={root:"_4tteFmBjZh_lxjtg3",disclosure:"s0RFEftNrI_lxjtg3"};class sl extends Ae{constructor(e){super(e,"InContentRender"),this.ctx=e,e.render[this.name]=this}async apply(e){if(this.checkDismiss(e[0]))return this.traceEvent(e[0],"skipped/user-dismiss");let t,r=!1;for(const i of e){if(t=i,r){r&&this.traceEvent(t,"skipped/sibling-filled");continue}const{root:s,close:o,region:a}=ae.createNode(t);s.classList.add(ri.root);const l=V("div",{class:ri.disclosure},t.disclosure||"");if(o.addEventListener("click",()=>{ae.removeNode(s),r&&(this.setDismiss(t),this.traceEvent(t,"dismiss"))}),!t.render_target)continue;const c=document.querySelectorAll(t.render_target);let h=Number(t.render_options.nth);isNaN(h)&&(h=1);const w=c[h-1],p=this.getSlotRender(t,Pe);if(!w||!p||!await this.isEnvAndUserMatched(t))continue;const g=new p(t);t.region==="oversea"&&(a.style.display="block"),w.insertAdjacentElement(t.render_position||"beforeend",s),await this.getElementUntilIntoView(s);const f=this.getAvailableWidth(w);s.style.maxWidth=`${f}px`,t.render_options=t.render_options||{},t.render_options.style+=`;max-width:${f}px`,r=(await this.handleApplySlot({slot:g,container:s,config:t})).slotFilled,r?((typeof t.disclosure>"u"||t.disclosure)&&s.appendChild(l),o.innerText=this.getSlotDismissText(g)):ae.removeNode(s)}}getAvailableWidth(e){const t=document.createElement("span");t.style.cssText="display:inline!important;font-family:monospace!important;font-size:10px!important;word-break:break-all!important",e.before(t),t.innerText="0".repeat(20);let r=0;const i=t.offsetHeight;let s=0;const o=100;for(;t.offsetHeight===i&&s<o;)s++,t.innerText+="0".repeat(20);return r=t.offsetWidth,t.remove(),r}}class ol extends zt{constructor(e){super(e),this.config=e}apply(e){const t=this.createNode(this.config);return e.append(t),t}emitted=!1;createNode(e){const t=V("img");new ResizeObserver(i=>{const s=i[0].target.clientWidth;let o;if(s<=600?o=e.slot_options.small:s<=1080?o=e.slot_options.medium:o=e.slot_options.large,o)t.getAttribute("src")!==o&&(t.src=o);else{if(this.emitted)return;this.emitted=!0,this.emit("unfilled")}}).observe(document.documentElement),t.addEventListener("load",()=>{this.emitted||(this.emitted=!0,this.emit("filled"))}),t.addEventListener("error",()=>{this.emitted||(this.emitted=!0,this.emit("unfilled","assets-loading-error"))});const r=V("a",{class:e?.slot_options?.class||"",style:e?.slot_options?.style||"",href:e.links_to,target:"_blank",rel:"noopener noreferrer"});return r.append(t),r}}const Ye={root:"stevrhgmNo_lxjtg3",hidden:"go5PM7a3Ep_lxjtg3",container:"-WH4kRaZFv_lxjtg3",closeBtn:"_2fOApB7OSI_lxjtg3"};class Wn extends Ae{constructor(e){super(e,"MobileBottomAnchorRender"),this.ctx=e}async apply(e){let t=!1,r;if(this.checkDismiss(e[0]))return this.traceEvent(e[0],"skipped/user-dismiss");const i=Wn.createNode(e[0]);document.body.append(i.root),i.container.style.height="90px",i.close.addEventListener("click",()=>{i.root.classList.add(Ye.hidden),t&&(this.setDismiss(r),this.traceEvent(r,"dismiss"))});for(r of e){const s=this.getSlotRender(r,ol);if(t||!s){t&&this.traceEvent(r,"skipped/sibling-filled");continue}if(!await this.isEnvAndUserMatched(r))continue;const o=new s(r),{slotFilled:a,slotElement:l}=await this.handleApplySlot({slot:o,container:i.container,config:r});t=a,t?(i.container.style.height="",i.close.innerText=this.getSlotDismissText(o)):l.remove()}!t&&r&&i.root.classList.add(Ye.hidden)}static createNode(e){const t=V("div",{class:`${Ye.root} ${e?.render_options?.class}`,style:`${Ye.root} ${e?.render_options?.style}`}),r=V("div",{class:Ye.container}),i=V("a",{class:Ye.closeBtn},"");return t.append(r,i),t.addEventListener("transitionend",s=>{(s.propertyName==="opacity"||getComputedStyle(t).opacity==="0")&&t.remove()}),{root:t,container:r,close:i}}}const al=async n=>{let e=!1;return new Promise((t,r)=>{const i=window.mw.hook;i?i(n).add(s=>{e||(e=!0,t(s))}):r(new Error("mw.hook is not available"))})},Vn={sectionRoot:"XDQg8COnlS_lxjtg3"};class ll extends Ae{constructor(e){super(e,"MoeHomelandRender"),this.ctx=e}async apply(e){if(this.checkDismiss(e[0]))return this.traceEvent(e[0],"skipped/user-dismiss");let t,r=!1;for(const i of e){if(t=i,r){r&&this.traceEvent(t,"skipped/sibling-filled");continue}await this.isEnvAndUserMatched(t)&&(r=(await this.applySlotAutomatic(t)).slotFilled)}}get homelandRoot(){const e=document.querySelector("#moe-homeland-app");return e?(Object.defineProperty(this,"homelandRoot",{value:e}),e):null}applySlotAutomatic(e){switch(e.render_preset){case"homeland_banner":case"homeland_slider":case"homeland_gallery":return this.applyBannerGallerySlot(e);case"homeland_section":return this.applySectionCardSlot(e);default:return this.handleUnfilled(null,e,"Missing or unknown render_preset"),Promise.resolve({slotFilled:!1,slotElement:null})}}async applyBannerGallerySlot(e){const t="insight-"+Math.random().toString(36).slice(2);let r=parseInt(e?.render_target||"1");return r=isNaN(r)?1:r,r=Math.max(1,r),al("moe-homeland:section/banner-slider").then(async({data:i})=>{if(!i?.value?.index?.[0]?.pages)return{slotFilled:!1,slotElement:null};i?.value?.index?.[0]?.pages?.splice(r-1,0,{id:t,imageSrc:e.slot_options?.src,title:e.slot_options?.alt,externalUrl:e.links_to,description:e.slot_options?.alt,isAdvertisement:!0});const o=await ni(this.homelandRoot,`[id="${t}"]`);return o?(o.classList.add(Vn.banner),e.slot_options?.style&&(o.style.cssText=e.slot_options?.style),this.handleShown(o,e),{slotFilled:!0,slotElement:o}):(this.handleUnfilled(null,e,"Failed to find target"),{slotFilled:!1,slotElement:null})})}async applySectionCardSlot(e){const t=ae.createNode(e),r=new Pe(e),i=V("div",{class:Vn.sectionContainer});t.root.classList.add(Vn.sectionRoot),t.close.innerText=this.getSlotDismissText(r),t.root.appendChild(i);const s=await ni(this.homelandRoot,e.render_target);return s?(s.insertAdjacentElement("beforebegin",t.root),t.close.addEventListener("click",()=>{ae.removeNode(t.root),this.setDismiss(e),this.traceEvent(e,"dismiss")}),this.handleApplySlot({slot:r,config:e,container:t.root})):{slotFilled:!1,slotElement:null}}}const ce={root:"_01T-L5Cj4R_lxjtg3",backdrop:"OWbzDhk-op_lxjtg3",modal:"mwpD7lKcPY_lxjtg3",header:"_3XcHj6yNSi_lxjtg3",close:"TAkM8pe4pR_lxjtg3",content:"DLFFgcPL0p_lxjtg3",asset:"_9KiwroTMT2_lxjtg3",footer:"b5w9Ex4KFo_lxjtg3",footerButton:"zeYQ0JE-Um_lxjtg3",okButton:"FBSWGsM3f1_lxjtg3",cancelButton:"_-9HyfRZird_lxjtg3"};class cl extends Ae{constructor(e){super(e,"PopoverRender"),this.ctx=e}async apply(e){let t=null,r=null,i=!1,s=!1;for(const o of e){if(r=document.querySelector(o.render_target||"body"),!r){this.traceEvent(o,"error/missing-target-element");continue}if(await this.isEnvAndUserMatched(o)){if(s=this.checkDismiss(o),s){this.traceEvent(o,"skipped/user-dismiss");continue}t=o;break}}!t||!r||(r.addEventListener("click",o=>{let a=o.target;for(;a&&a.tagName!=="A"&&a!==r;)a=a.parentElement;if(a?.tagName!=="A")return;const l=a,c=l.href,h=l.getAttribute("href");if(!h||h.startsWith("#")||h.startsWith("javascript:")||h.startsWith("vbscript:")||l.target==="_blank"||new URL(c).origin!==location.origin)return;o.preventDefault();const{root:w,closeButton:p,cancelButton:g,asset:f,okButton:N}=this.createNode(t);document.body.appendChild(w),document.body.style.overflow="hidden",[p,g,f,N].forEach(S=>{S.addEventListener("click",M=>{M.preventDefault(),S.getAttribute("action")==="dismiss"?this.traceEvent(t,"dismiss"):(this.traceEvent(t,"clicked"),window.open(t.links_to)),document.body.style.overflow="",w.remove(),this.setDismiss(t),location.href=c})}),this.getElementUntilIntoView(w).then(()=>{i=!0,this.traceEvent(t,"shown")})}),window.addEventListener("beforeunload",()=>{!s&&!i&&this.traceEvent(t,"skipped/unload-before-triggered")}))}createNode(e){const t=V("div",{class:`${ce.root} ${e.render_options?.class}`,style:e.render_options?.style}),r=V("div",{class:ce.backdrop}),i=V("div",{class:`${ce.modal}`}),s=V("div",{class:ce.header}),o=V("a",{class:ce.close,action:"dismiss"},"");s.append(V("h5",""),V("div",{style:"flex:1"}),o);const a=V("section",{class:ce.content}),c=new Pe(e).apply(a);c.classList.add(ce.asset);const h=V("div",{class:ce.footer}),w=V("a",{class:`${ce.footerButton} ${ce.cancelButton}`,action:"dismiss"},""),p=V("a",{class:`${ce.footerButton} ${ce.okButton}`,action:"clicked"},"");return h.append(w,p),i.append(s,a,h),t.append(r,i),{root:t,asset:c,cancelButton:w,okButton:p,closeButton:o}}checkDismiss(e){return Zr(e.uuid)}setDismiss(e){return Qr(e.uuid,e.cooldown||0),this}}class ul extends Ae{constructor(e){super(e,"SingleLineScriptRender"),this.ctx=e,e.render[this.name]=this}async apply(e){for(const t of e){const r=t;if(!await this.isEnvAndUserMatched(r))continue;const i={src:r.links_to,"insight-render":r.render,...r.slot_options?.attributes},s=document.querySelector(r.render_target||"body");if(!s)throw new Error("Missing parent node");const o=V("script",i);if(s.insertAdjacentElement(r.render_position||"beforeend",o),r.slot_options.injectScripts){const a=new Blob([r.slot_options.injectScripts],{type:"text/javascript"}),l=URL.createObjectURL(a);document.body.appendChild(V("script",{src:l})),window.addEventListener("unload",()=>{URL.revokeObjectURL(l)})}if(r.slot_options.injectStyles){const a=new CSSStyleSheet;a.replaceSync(r.slot_options.injectStyles),document.adoptedStyleSheets=[a]}}}}async function ii(n){return fetch(n||"https://app.moegirl.org.cn/insight/ads.config.yml.json",{cache:"no-cache"}).then(e=>e.json()).then(e=>Array.isArray(e?.configs)?e.configs:Array.isArray(e)?e:[])}class Le extends En{constructor(e=[]){super(),this.configs=e}app=this;render={};static fetchConfigs=ii;static async startWithAllPlugins(e){const t=new Le(e);return t.plugin(Cs),t.plugin(Ws),t.plugin(qa),t.plugin(za),t.plugin(nl),t.plugin(il),t.plugin(sl),t.plugin(Wn),t.plugin(ll),t.plugin(ae),t.plugin(cl),t.plugin(ul),await t.start(),Math.random()<.1&&t.cleanupOldStorage(),t}async init(e){if(!navigator.userAgent.toLowerCase().includes("moegirl-mobile"))return this.configs.length?Le.startWithAllPlugins(this.configs):ii(e).then(Le.startWithAllPlugins)}async cleanupOldStorage(){const e=this.configs.map(t=>t.uuid);for(const t of Object.keys(localStorage))if(t.startsWith("TW9lZ2lybEluc2lnaHQtZGlzc21pc3Mt")){const r=atob(t).slice(24);e.includes(r)||localStorage.removeItem(t)}}setStatusCode(){return this}}globalThis.process={...globalThis.process,cwd:()=>"",env:{...globalThis?.process?.env,NODE_ENV:"production"}},Se.ErrorPagesBackground=Le,Se.MoegirlInsight=Le,Se.MoeskinBackground=Le,Object.defineProperty(Se,Symbol.toStringTag,{value:"Module"})});

;(function () {
function injectCSS(payload) {
  const style = document.createElement("style");
  style.dataset.vitePackage = payload.packageName;
  style.dataset.viteFile = payload.fileName;
  style.innerHTML = payload.source;
  document.head.appendChild(style);
}
const cssEntries = [{"fileName":"insight.css","name":"insight.css","names":["insight.css"],"needsCodeReference":false,"originalFileName":"style.css","originalFileNames":["style.css"],"source":"@charset \"UTF-8\";.LKiWAjzNmD_lxjtg3{font-size:14px;display:block!important;position:absolute!important;z-index:-1!important;opacity:1!important;overflow:hidden;width:100%!important;height:100%!important;top:0!important;left:0!important;line-height:0;transition:all .48s ease-out}.LKiWAjzNmD_lxjtg3.sMucBzwNly_lxjtg3{opacity:0!important;pointer-events:none!important;user-select:none!important}.LKiWAjzNmD_lxjtg3.sMucBzwNly_lxjtg3 .B3PE627t18_lxjtg3:before,.LKiWAjzNmD_lxjtg3.sMucBzwNly_lxjtg3 .B3PE627t18_lxjtg3:after{transform:scale(1.2)}@media (max-width: 765px){.LKiWAjzNmD_lxjtg3{display:none!important}}.B3PE627t18_lxjtg3{position:absolute;top:0;left:0;width:100%;height:100%;transition:all .24s ease}.B3PE627t18_lxjtg3:before,.B3PE627t18_lxjtg3:after{content:\"\";position:fixed;top:0;display:block;width:52%;height:100%;background-size:auto 100%;transition:all .48s ease-out}.B3PE627t18_lxjtg3:before{left:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 250px,var(--theme-background-color) 80%),var(--background-url);background-position:center left}.B3PE627t18_lxjtg3:after{right:0;width:50%;background-image:linear-gradient(to left,rgba(255,255,255,0) 250px,var(--theme-background-color) 80%),var(--background-url);background-position:center right}.Qywd9h41yZ_lxjtg3{position:fixed!important;top:0;left:0;width:100vw;height:100vh}.PNd4yOeDM7_lxjtg3{position:fixed;top:calc(50px + .5em);right:.5em;cursor:pointer;padding:.5em .8em;border-radius:99em;--color: #d03050;color:var(--color);border:1px solid var(--color);background-color:#ffffff59;backdrop-filter:blur(2px);line-height:1;transition:all .24s ease;z-index:999999!important}.PNd4yOeDM7_lxjtg3:after{content:\"\";padding-left:4px}.xUkJeF1d7d_lxjtg3{line-height:0;z-index:1;position:relative}.xUkJeF1d7d_lxjtg3.X7tHwc6gRp_lxjtg3{line-height:1.5}.RPb6qQr-eq_lxjtg3{width:100%;height:auto;display:block;line-height:0;pointer-events:none;user-select:none}iframe.RPb6qQr-eq_lxjtg3{height:100%}.X-2JFOXOR1_lxjtg3{font-size:14px;border-radius:.5em;overflow:hidden;padding:0;position:relative;transition:all .12s ease-out;user-select:none;text-align:center}.X-2JFOXOR1_lxjtg3.fSlmkxM5cg_lxjtg3{height:0!important;opacity:0!important}._4JuHzMsWcH_lxjtg3{position:absolute;top:.2rem;--color: #2080f0;color:var(--color);border:1px solid var(--color);background-color:#ffffff59;border-radius:99em;padding:.1rem .5rem;line-height:1.5;backdrop-filter:blur(2px)}.GwGomSd0p9_lxjtg3{--color: #d03050;right:.2rem;z-index:10;cursor:pointer}.GwGomSd0p9_lxjtg3:after{content:\"\";padding-left:4px}._5lkkF7XtM1_lxjtg3{display:none;left:.2rem;font-size:10px;pointer-events:none;z-index:10}.ixCcjlKdoi_lxjtg3{--width: 160px;position:fixed;width:var(--width);max-height:600px;top:50%;transform:translateY(-50%);z-index:25;--width-to-edge: 1.5rem}@media (max-width: 900px){.ixCcjlKdoi_lxjtg3{display:none}}@media (max-height: 700px){.ixCcjlKdoi_lxjtg3{display:none}}.ixCcjlKdoi_lxjtg3 img,.ixCcjlKdoi_lxjtg3 video,.ixCcjlKdoi_lxjtg3 iframe{width:100%;height:100%}._4tteFmBjZh_lxjtg3{position:relative;margin-top:1em;margin-bottom:1em}.s0RFEftNrI_lxjtg3{display:block;margin:.4em 0;text-align:center;font-size:.7em;color:#00000080;user-select:none}.stevrhgmNo_lxjtg3{position:fixed;bottom:0;left:0;width:100%;z-index:21;transition:all .48s ease-out}.stevrhgmNo_lxjtg3.go5PM7a3Ep_lxjtg3{opacity:0;bottom:-100px;user-select:none!important;pointer-events:none!important}.-WH4kRaZFv_lxjtg3{position:relative;z-index:1;line-height:0;transition:all .24s ease;background-color:#fffc}.-WH4kRaZFv_lxjtg3 img{width:100%;height:auto}._2fOApB7OSI_lxjtg3{position:absolute;right:.5em;top:.5em;padding:.2em .5em;--color: #d03050;color:var(--color);border:1px solid var(--color);background-color:#ffffff59;backdrop-filter:blur(2px);border-radius:99em;cursor:pointer;z-index:2}._2fOApB7OSI_lxjtg3:after{content:\"\";padding-left:4px}.XDQg8COnlS_lxjtg3{overflow:hidden}.XDQg8COnlS_lxjtg3 img,.XDQg8COnlS_lxjtg3 iframe{width:100%}.XDQg8COnlS_lxjtg3 iframe{height:150px}._01T-L5Cj4R_lxjtg3{position:fixed;top:0;left:0;width:100%;height:100%;z-index:10000}._01T-L5Cj4R_lxjtg3 .OWbzDhk-op_lxjtg3{position:absolute;left:0;top:0;width:100%;height:100%;background-color:#fffffff5;z-index:1}._01T-L5Cj4R_lxjtg3 .mwpD7lKcPY_lxjtg3{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:600px;max-width:84vw;background-color:#fafafa;border-radius:.5rem;box-shadow:0 0 2rem #00000026;z-index:2}._01T-L5Cj4R_lxjtg3 ._3XcHj6yNSi_lxjtg3{display:flex;padding:1rem;padding-bottom:0}._01T-L5Cj4R_lxjtg3 ._3XcHj6yNSi_lxjtg3 h5{font-size:1.4rem;font-weight:700;margin:0}._01T-L5Cj4R_lxjtg3 ._3XcHj6yNSi_lxjtg3 .TAkM8pe4pR_lxjtg3{display:block;width:1.8rem;height:1.8rem;line-height:1.8;text-align:center;font-size:1rem;border-radius:50%;background:#d0305029;color:#d03050}._01T-L5Cj4R_lxjtg3 .DLFFgcPL0p_lxjtg3{text-align:center;padding:1rem}._01T-L5Cj4R_lxjtg3 ._9KiwroTMT2_lxjtg3{display:inline-block;line-height:1;cursor:pointer}._01T-L5Cj4R_lxjtg3 ._9KiwroTMT2_lxjtg3 iframe{border:none}._01T-L5Cj4R_lxjtg3 ._9KiwroTMT2_lxjtg3 img,._01T-L5Cj4R_lxjtg3 ._9KiwroTMT2_lxjtg3 iframe{max-width:calc(84vw - 2rem);max-height:70vh;width:calc(600px - 2rem);height:auto;object-fit:cover;border-radius:.5rem}._01T-L5Cj4R_lxjtg3 .b5w9Ex4KFo_lxjtg3{padding:1rem;padding-top:0;display:flex;gap:1rem}._01T-L5Cj4R_lxjtg3 .b5w9Ex4KFo_lxjtg3 .zeYQ0JE-Um_lxjtg3{display:block;flex:1;text-align:center;padding:.8rem;border-radius:.2rem;cursor:pointer}._01T-L5Cj4R_lxjtg3 .b5w9Ex4KFo_lxjtg3 .FBSWGsM3f1_lxjtg3{background-color:#18a05829;color:#18a058}._01T-L5Cj4R_lxjtg3 .b5w9Ex4KFo_lxjtg3 ._-9HyfRZird_lxjtg3{background-color:#2e33380d;color:#767c82}\n","type":"asset","packageName":"MoegirlInsight"}];
cssEntries.forEach(injectCSS);
})()
